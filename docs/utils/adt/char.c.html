<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>utils/adt/char.c - pgsql17devel-backend</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="../../index.html">Top Level</a></span>
 </p>

  <h1>utils/adt/char.c - pgsql17devel-backend</h1>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L228">char_text</a></li>
<li><a href="#L127">chareq</a></li>
<li><a href="#L172">charge</a></li>
<li><a href="#L163">chargt</a></li>
<li><a href="#L41">charin</a></li>
<li><a href="#L154">charle</a></li>
<li><a href="#L145">charlt</a></li>
<li><a href="#L136">charne</a></li>
<li><a href="#L64">charout</a></li>
<li><a href="#L94">charrecv</a></li>
<li><a href="#L105">charsend</a></li>
<li><a href="#L182">chartoi4</a></li>
<li><a href="#L190">i4tochar</a></li>
<li><a href="#L204">text_char</a></li>
</ul>
 <h2>Macros defined</h2>
 <ul class="toc">
<li><a href="#L26">FROMOCTAL</a></li>
<li><a href="#L24">ISOCTAL</a></li>
<li><a href="#L25">TOOCTAL</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">/*-------------------------------------------------------------------------<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * char.c<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; Functions for the built-in type &quot;char&quot; (not to be confused with<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; <a href="varchar.c.html#L271" title="utils/adt/varchar.c:271">bpchar</a>, which is the SQL CHAR(n) type).<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Portions Copyright (c) 1996-2024, PostgreSQL Global Development Group<br/></li>
<li></span><span class="Comment"> * Portions Copyright (c) 1994, Regents of the University of California<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * IDENTIFICATION<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; src/backend/utils/adt/char.c<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *-------------------------------------------------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;postgres.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;limits.h&gt;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;libpq/pqformat.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/fmgrprotos.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;varatt.h&quot;<br/></li>
<li></span><br/></li>
<li><a id="L24">&#x200c;</a><span class="PreProc">#define <span class="linkable">ISOCTAL</span>(c)&nbsp;&nbsp; (((c) &gt;= </span><span class="Constant">'0'</span><span class="PreProc">) &amp;&amp; ((c) &lt;= </span><span class="Constant">'7'</span><span class="PreProc">))<br/></li>
<li><a id="L25">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">TOOCTAL</span>(c)&nbsp;&nbsp; ((c) + </span><span class="Constant">'0'</span><span class="PreProc">)<br/></li>
<li><a id="L26">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">FROMOCTAL</span>(c) ((</span><span class="Type">unsigned</span><span class="PreProc"> </span><span class="Type">char</span><span class="PreProc">) (c) - </span><span class="Constant">'0'</span><span class="PreProc">)<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/*****************************************************************************<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp;&nbsp; USER I/O ROUTINES&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *<br/></li>
<li></span><span class="Comment"> *****************************************************************************/<br/></li>
<li></span><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L41" title="utils/adt/char.c:41">charin</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - converts &quot;x&quot; to 'x'<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This accepts the formats <a href="#L64" title="utils/adt/char.c:64">charout</a> produces.&nbsp; If we have multibyte input<br/></li>
<li></span><span class="Comment"> * that is not in the form '\ooo', then we take its first byte as the value<br/></li>
<li></span><span class="Comment"> * and silently discard the rest; this is a backwards-compatibility provision.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>Datum<br/></li>
<li><a id="L41">&#x200c;</a><span class="linkable">charin</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *ch = PG_GETARG_CSTRING(<span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (strlen(ch) == <span class="Constant">4</span> &amp;&amp; ch[<span class="Constant">0</span>] == <span class="Special">'\\'</span> &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../../commands/copyfromparse.c.html#L79" title="commands/copyfromparse.c:79">ISOCTAL</a>(ch[<span class="Constant">1</span>]) &amp;&amp; <a href="../../commands/copyfromparse.c.html#L79" title="commands/copyfromparse.c:79">ISOCTAL</a>(ch[<span class="Constant">2</span>]) &amp;&amp; <a href="../../commands/copyfromparse.c.html#L79" title="commands/copyfromparse.c:79">ISOCTAL</a>(ch[<span class="Constant">3</span>]))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; PG_RETURN_CHAR((<a href="#L26" title="utils/adt/char.c:26">FROMOCTAL</a>(ch[<span class="Constant">1</span>]) &lt;&lt; <span class="Constant">6</span>) +<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<a href="#L26" title="utils/adt/char.c:26">FROMOCTAL</a>(ch[<span class="Constant">2</span>]) &lt;&lt; <span class="Constant">3</span>) +<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="#L26" title="utils/adt/char.c:26">FROMOCTAL</a>(ch[<span class="Constant">3</span>]));<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* This will do the right thing for a zero-length input string */<br/></li>
<li></span>&nbsp; &nbsp; PG_RETURN_CHAR(ch[<span class="Constant">0</span>]);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L64" title="utils/adt/char.c:64">charout</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - converts 'x' to &quot;x&quot;<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The possible output formats are:<br/></li>
<li></span><span class="Comment"> * 1. 0x00 is represented as an empty string.<br/></li>
<li></span><span class="Comment"> * 2. 0x01..0x7F are represented as a single ASCII byte.<br/></li>
<li></span><span class="Comment"> * 3. 0x80..0xFF are represented as \ooo (backslash and 3 octal digits).<br/></li>
<li></span><span class="Comment"> * Case 3 is meant to match the traditional &quot;escape&quot; format of bytea.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>Datum<br/></li>
<li><a id="L64">&#x200c;</a><span class="linkable">charout</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; ch = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *result = (<span class="Type">char</span> *) <a href="../mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>(<span class="Constant">5</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (IS_HIGHBIT_SET(ch))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result[<span class="Constant">0</span>] = <span class="Special">'\\'</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result[<span class="Constant">1</span>] = <a href="#L25" title="utils/adt/char.c:25">TOOCTAL</a>(((<span class="Type">unsigned</span> <span class="Type">char</span>) ch) &gt;&gt; <span class="Constant">6</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result[<span class="Constant">2</span>] = <a href="#L25" title="utils/adt/char.c:25">TOOCTAL</a>((((<span class="Type">unsigned</span> <span class="Type">char</span>) ch) &gt;&gt; <span class="Constant">3</span>) &amp; <span class="PreProc">0</span><span class="Constant">7</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result[<span class="Constant">3</span>] = <a href="#L25" title="utils/adt/char.c:25">TOOCTAL</a>(((<span class="Type">unsigned</span> <span class="Type">char</span>) ch) &amp; <span class="PreProc">0</span><span class="Constant">7</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result[<span class="Constant">4</span>] = <span class="Special">'\0'</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* This produces acceptable results for 0x00 as well */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; result[<span class="Constant">0</span>] = ch;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result[<span class="Constant">1</span>] = <span class="Special">'\0'</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; PG_RETURN_CSTRING(result);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L94" title="utils/adt/char.c:94">charrecv</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - converts external binary format to char<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The external representation is one byte, with no character set<br/></li>
<li></span><span class="Comment"> * conversion.&nbsp; This is somewhat dubious, perhaps, but in many<br/></li>
<li></span><span class="Comment"> * cases people use char for a 1-byte binary type.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>Datum<br/></li>
<li><a id="L94">&#x200c;</a><span class="linkable">charrecv</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; StringInfo&nbsp; &nbsp; buf = (StringInfo) PG_GETARG_POINTER(<span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_CHAR(<a href="../../libpq/pqformat.c.html#L399" title="libpq/pqformat.c:399">pq_getmsgbyte</a>(buf));<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L105" title="utils/adt/char.c:105">charsend</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - converts char to binary format<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>Datum<br/></li>
<li><a id="L105">&#x200c;</a><span class="linkable">charsend</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; StringInfoData buf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../../libpq/pqformat.c.html#L326" title="libpq/pqformat.c:326">pq_begintypsend</a>(&amp;buf);<br/></li>
<li>&nbsp; &nbsp; pq_sendbyte(&amp;buf, arg1);<br/></li>
<li>&nbsp; &nbsp; PG_RETURN_BYTEA_P(<a href="../../libpq/pqformat.c.html#L346" title="libpq/pqformat.c:346">pq_endtypsend</a>(&amp;buf));<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*****************************************************************************<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp;&nbsp; PUBLIC ROUTINES&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *<br/></li>
<li></span><span class="Comment"> *****************************************************************************/<br/></li>
<li></span><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="../../regex/regcomp.c.html#L324" title="regex/regcomp.c:324">NOTE</a>: comparisons are done as though char is unsigned (uint8).<br/></li>
<li></span><span class="Comment"> * Conversions to and from integer are done as though char is signed (int8).<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * You wanted consistency?<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><br/></li>
<li>Datum<br/></li>
<li><a id="L127">&#x200c;</a><span class="linkable">chareq</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg2 = PG_GETARG_CHAR(<span class="Constant">1</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_BOOL(arg1 == arg2);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L136">&#x200c;</a><span class="linkable">charne</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg2 = PG_GETARG_CHAR(<span class="Constant">1</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_BOOL(arg1 != arg2);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L145">&#x200c;</a><span class="linkable">charlt</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg2 = PG_GETARG_CHAR(<span class="Constant">1</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_BOOL((uint8) arg1 &lt; (uint8) arg2);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L154">&#x200c;</a><span class="linkable">charle</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg2 = PG_GETARG_CHAR(<span class="Constant">1</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_BOOL((uint8) arg1 &lt;= (uint8) arg2);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L163">&#x200c;</a><span class="linkable">chargt</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg2 = PG_GETARG_CHAR(<span class="Constant">1</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_BOOL((uint8) arg1 &gt; (uint8) arg2);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L172">&#x200c;</a><span class="linkable">charge</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg2 = PG_GETARG_CHAR(<span class="Constant">1</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_BOOL((uint8) arg1 &gt;= (uint8) arg2);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L182">&#x200c;</a><span class="linkable">chartoi4</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_INT32((int32) ((int8) arg1));<br/></li>
<li>}<br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L190">&#x200c;</a><span class="linkable">i4tochar</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; int32&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_INT32(<span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (arg1 &lt; <span class="Constant">SCHAR_MIN</span> || arg1 &gt; <span class="Constant">SCHAR_MAX</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;</span><span class="Special">\&quot;</span><span class="Constant">char</span><span class="Special">\&quot;</span><span class="Constant"> out of <a href="../../regex/regc_locale.c.html#L412" title="regex/regc_locale.c:412">range</a>&quot;</span>)));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_CHAR((int8) arg1);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L204">&#x200c;</a><span class="linkable">text_char</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; text&nbsp; &nbsp; &nbsp;&nbsp; *arg1 = PG_GETARG_TEXT_PP(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *ch = VARDATA_ANY(arg1);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; result;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Conversion rules are the same as in <a href="#L41" title="utils/adt/char.c:41">charin</a>(), but here we need to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * handle the empty-string case honestly.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (VARSIZE_ANY_EXHDR(arg1) == <span class="Constant">4</span> &amp;&amp; ch[<span class="Constant">0</span>] == <span class="Special">'\\'</span> &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../../commands/copyfromparse.c.html#L79" title="commands/copyfromparse.c:79">ISOCTAL</a>(ch[<span class="Constant">1</span>]) &amp;&amp; <a href="../../commands/copyfromparse.c.html#L79" title="commands/copyfromparse.c:79">ISOCTAL</a>(ch[<span class="Constant">2</span>]) &amp;&amp; <a href="../../commands/copyfromparse.c.html#L79" title="commands/copyfromparse.c:79">ISOCTAL</a>(ch[<span class="Constant">3</span>]))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result = (<a href="#L26" title="utils/adt/char.c:26">FROMOCTAL</a>(ch[<span class="Constant">1</span>]) &lt;&lt; <span class="Constant">6</span>) +<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="#L26" title="utils/adt/char.c:26">FROMOCTAL</a>(ch[<span class="Constant">2</span>]) &lt;&lt; <span class="Constant">3</span>) +<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L26" title="utils/adt/char.c:26">FROMOCTAL</a>(ch[<span class="Constant">3</span>]);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (VARSIZE_ANY_EXHDR(arg1) &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result = ch[<span class="Constant">0</span>];<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; result = <span class="Special">'\0'</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_CHAR(result);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li>Datum<br/></li>
<li><a id="L228">&#x200c;</a><span class="linkable">char_text</span>(PG_FUNCTION_ARGS)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; arg1 = PG_GETARG_CHAR(<span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; text&nbsp; &nbsp; &nbsp;&nbsp; *result = <a href="../mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>(VARHDRSZ + <span class="Constant">4</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Conversion rules are the same as in <a href="#L64" title="utils/adt/char.c:64">charout</a>(), but here we need to be<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * honest about converting 0x00 to an empty string.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (IS_HIGHBIT_SET(arg1))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; SET_VARSIZE(result, VARHDRSZ + <span class="Constant">4</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (VARDATA(result))[<span class="Constant">0</span>] = <span class="Special">'\\'</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (VARDATA(result))[<span class="Constant">1</span>] = <a href="#L25" title="utils/adt/char.c:25">TOOCTAL</a>(((<span class="Type">unsigned</span> <span class="Type">char</span>) arg1) &gt;&gt; <span class="Constant">6</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (VARDATA(result))[<span class="Constant">2</span>] = <a href="#L25" title="utils/adt/char.c:25">TOOCTAL</a>((((<span class="Type">unsigned</span> <span class="Type">char</span>) arg1) &gt;&gt; <span class="Constant">3</span>) &amp; <span class="PreProc">0</span><span class="Constant">7</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (VARDATA(result))[<span class="Constant">3</span>] = <a href="#L25" title="utils/adt/char.c:25">TOOCTAL</a>(((<span class="Type">unsigned</span> <span class="Type">char</span>) arg1) &amp; <span class="PreProc">0</span><span class="Constant">7</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (arg1 != <span class="Special">'\0'</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; SET_VARSIZE(result, VARHDRSZ + <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *(VARDATA(result)) = arg1;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; SET_VARSIZE(result, VARHDRSZ);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; PG_RETURN_TEXT_P(result);<br/></li>
<li>}<br/></li>
</ol></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="../../index.html">Top Level</a></span>
 </p>

 </body>
</html>
