<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>libpq/pqformat.c - pgsql17devel-backend</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="../index.html">Top Level</a></span>
 </p>

  <h1>libpq/pqformat.c - pgsql17devel-backend</h1>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L88">pq_beginmessage</a></li>
<li><a href="#L109">pq_beginmessage_reuse</a></li>
<li><a href="#L326">pq_begintypsend</a></li>
<li><a href="#L528">pq_copymsgbytes</a></li>
<li><a href="#L296">pq_endmessage</a></li>
<li><a href="#L314">pq_endmessage_reuse</a></li>
<li><a href="#L346">pq_endtypsend</a></li>
<li><a href="#L399">pq_getmsgbyte</a></li>
<li><a href="#L508">pq_getmsgbytes</a></li>
<li><a href="#L635">pq_getmsgend</a></li>
<li><a href="#L469">pq_getmsgfloat4</a></li>
<li><a href="#L488">pq_getmsgfloat8</a></li>
<li><a href="#L415">pq_getmsgint</a></li>
<li><a href="#L453">pq_getmsgint64</a></li>
<li><a href="#L608">pq_getmsgrawstring</a></li>
<li><a href="#L579">pq_getmsgstring</a></li>
<li><a href="#L546">pq_getmsgtext</a></li>
<li><a href="#L388">pq_putemptymessage</a></li>
<li><a href="#L367">pq_puttextmessage</a></li>
<li><a href="#L227">pq_send_ascii_string</a></li>
<li><a href="#L126">pq_sendbytes</a></li>
<li><a href="#L142">pq_sendcountedtext</a></li>
<li><a href="#L252">pq_sendfloat4</a></li>
<li><a href="#L276">pq_sendfloat8</a></li>
<li><a href="#L195">pq_sendstring</a></li>
<li><a href="#L172">pq_sendtext</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">/*-------------------------------------------------------------------------<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * pqformat.c<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; Routines for formatting and parsing frontend/backend messages<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Outgoing messages are built up in a StringInfo buffer (which is expansible)<br/></li>
<li></span><span class="Comment"> * and then sent in a single call to pq_putmessage.&nbsp; This module provides data<br/></li>
<li></span><span class="Comment"> * formatting/conversion routines that are needed to produce valid messages.<br/></li>
<li></span><span class="Comment"> * Note in particular the distinction between &quot;raw data&quot; and &quot;text&quot;; raw data<br/></li>
<li></span><span class="Comment"> * is message protocol characters and binary <a href="../bootstrap/bootstrap.c.html#L152" title="bootstrap/bootstrap.c:152">values</a> that are not subject to<br/></li>
<li></span><span class="Comment"> * character set conversion, while text is converted by character encoding<br/></li>
<li></span><span class="Comment"> * rules.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Incoming messages are similarly read into a StringInfo buffer, via<br/></li>
<li></span><span class="Comment"> * <a href="pqcomm.c.html#L1202" title="libpq/pqcomm.c:1202">pq_getmessage</a>, and then parsed and converted from that using the routines<br/></li>
<li></span><span class="Comment"> * in this module.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * These same routines support reading and writing of external binary formats<br/></li>
<li></span><span class="Comment"> * (typsend/typreceive routines).&nbsp; The conversion routines for individual<br/></li>
<li></span><span class="Comment"> * data types are exactly the same, only initialization and completion<br/></li>
<li></span><span class="Comment"> * are different.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Portions Copyright (c) 1996-2024, PostgreSQL Global Development Group<br/></li>
<li></span><span class="Comment"> * Portions Copyright (c) 1994, Regents of the University of California<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; src/backend/libpq/pqformat.c<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *-------------------------------------------------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * INTERFACE ROUTINES<br/></li>
<li></span><span class="Comment"> * Message assembly and output:<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L88" title="libpq/pqformat.c:88">pq_beginmessage</a> - <a href="../regex/rege_dfa.c.html#L731" title="regex/rege_dfa.c:731">initialize</a> StringInfo buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; pq_sendbyte&nbsp; &nbsp; &nbsp; &nbsp; - append a raw byte to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; pq_sendint&nbsp; &nbsp; &nbsp; &nbsp; - append a binary integer to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; pq_sendint64&nbsp; &nbsp; - append a binary 8-byte int to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L252" title="libpq/pqformat.c:252">pq_sendfloat4</a>&nbsp; &nbsp; - append a float4 to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L276" title="libpq/pqformat.c:276">pq_sendfloat8</a>&nbsp; &nbsp; - append a float8 to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L126" title="libpq/pqformat.c:126">pq_sendbytes</a>&nbsp; &nbsp; - append raw data to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L142" title="libpq/pqformat.c:142">pq_sendcountedtext</a> - append a counted text string (with character set conversion)<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L172" title="libpq/pqformat.c:172">pq_sendtext</a>&nbsp; &nbsp; &nbsp; &nbsp; - append a text string (with conversion)<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L195" title="libpq/pqformat.c:195">pq_sendstring</a>&nbsp; &nbsp; - append a null-terminated text string (with conversion)<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L227" title="libpq/pqformat.c:227">pq_send_ascii_string</a> - append a null-terminated text string (without conversion)<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L296" title="libpq/pqformat.c:296">pq_endmessage</a>&nbsp; &nbsp; - <a href="../port/win32/socket.c.html#L38" title="port/win32/socket.c:38">send</a> the completed message to the frontend<br/></li>
<li></span><span class="Comment"> * Note: it is also possible to append data to the StringInfo buffer using<br/></li>
<li></span><span class="Comment"> * the regular StringInfo routines, but this is discouraged since required<br/></li>
<li></span><span class="Comment"> * character set conversion may not occur.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * typsend support (construct a bytea value containing external binary data):<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L326" title="libpq/pqformat.c:326">pq_begintypsend</a> - <a href="../regex/rege_dfa.c.html#L731" title="regex/rege_dfa.c:731">initialize</a> StringInfo buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L346" title="libpq/pqformat.c:346">pq_endtypsend</a>&nbsp; &nbsp; - return the completed string as a &quot;bytea*&quot;<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Special-case message output:<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L367" title="libpq/pqformat.c:367">pq_puttextmessage</a> - generate a character set-converted message in one step<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L388" title="libpq/pqformat.c:388">pq_putemptymessage</a> - convenience routine for message with empty body<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Message parsing after input:<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L399" title="libpq/pqformat.c:399">pq_getmsgbyte</a>&nbsp; &nbsp; - get a raw byte from a message buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L415" title="libpq/pqformat.c:415">pq_getmsgint</a>&nbsp; &nbsp; - get a binary integer from a message buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L453" title="libpq/pqformat.c:453">pq_getmsgint64</a>&nbsp; &nbsp; - get a binary 8-byte int from a message buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L469" title="libpq/pqformat.c:469">pq_getmsgfloat4</a> - get a float4 from a message buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L488" title="libpq/pqformat.c:488">pq_getmsgfloat8</a> - get a float8 from a message buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L508" title="libpq/pqformat.c:508">pq_getmsgbytes</a>&nbsp; &nbsp; - get raw data from a message buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L528" title="libpq/pqformat.c:528">pq_copymsgbytes</a> - copy raw data from a message buffer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L546" title="libpq/pqformat.c:546">pq_getmsgtext</a>&nbsp; &nbsp; - get a counted text string (with conversion)<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L579" title="libpq/pqformat.c:579">pq_getmsgstring</a> - get a null-terminated text string (with conversion)<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L608" title="libpq/pqformat.c:608">pq_getmsgrawstring</a> - get a null-terminated text string - NO conversion<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L635" title="libpq/pqformat.c:635">pq_getmsgend</a>&nbsp; &nbsp; - verify message fully consumed<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;postgres.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&lt;sys/param.h&gt;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;libpq/libpq.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;libpq/pqformat.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;mb/pg_wchar.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;port/pg_bswap.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;varatt.h&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L88" title="libpq/pqformat.c:88">pq_beginmessage</a>&nbsp; &nbsp; &nbsp; &nbsp; - <a href="../regex/rege_dfa.c.html#L731" title="regex/rege_dfa.c:731">initialize</a> for sending a message<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L88">&#x200c;</a></span><span class="linkable">pq_beginmessage</span>(StringInfo buf, <span class="Type">char</span> msgtype)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; initStringInfo(buf);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * We stash the message type into the buffer's cursor field, expecting<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * that the pq_sendXXX routines won't touch it.&nbsp; We could alternatively<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * make it the first byte of the buffer contents, but this seems easier.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; buf-&gt;cursor = msgtype;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><br/></li>
<li><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L109" title="libpq/pqformat.c:109">pq_beginmessage_reuse</a> - <a href="../regex/rege_dfa.c.html#L731" title="regex/rege_dfa.c:731">initialize</a> for sending a message, reuse buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This requires the buffer to be allocated in a sufficiently long-lived<br/></li>
<li></span><span class="Comment"> * memory context.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L109">&#x200c;</a></span><span class="linkable">pq_beginmessage_reuse</span>(StringInfo buf, <span class="Type">char</span> msgtype)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; resetStringInfo(buf);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * We stash the message type into the buffer's cursor field, expecting<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * that the pq_sendXXX routines won't touch it.&nbsp; We could alternatively<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * make it the first byte of the buffer contents, but this seems easier.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; buf-&gt;cursor = msgtype;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L126" title="libpq/pqformat.c:126">pq_sendbytes</a>&nbsp; &nbsp; - append raw data to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L126">&#x200c;</a></span><span class="linkable">pq_sendbytes</span>(StringInfo buf, <span class="Type">const</span> <span class="Type">void</span> *data, <span class="Type">int</span> datalen)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* use variant that maintains a trailing null-byte, out of caution */<br/></li>
<li></span>&nbsp; &nbsp; appendBinaryStringInfo(buf, data, datalen);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L142" title="libpq/pqformat.c:142">pq_sendcountedtext</a> - append a counted text string (with character set conversion)<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The data sent to the frontend by this routine is a 4-byte count field<br/></li>
<li></span><span class="Comment"> * followed by the string.&nbsp; The count does not include itself, as required by<br/></li>
<li></span><span class="Comment"> * protocol version 3.0.&nbsp; The passed text string need not be null-terminated,<br/></li>
<li></span><span class="Comment"> * and the data sent to the frontend isn't either.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L142">&#x200c;</a></span><span class="linkable">pq_sendcountedtext</span>(StringInfo buf, <span class="Type">const</span> <span class="Type">char</span> *str, <span class="Type">int</span> slen)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = <a href="../utils/mb/mbutils.c.html#L738" title="utils/mb/mbutils.c:738">pg_server_to_client</a>(str, slen);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (p != str)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* actual conversion has been done? */<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; slen = strlen(p);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; pq_sendint32(buf, slen);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendBinaryStringInfoNT(buf, p, slen);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(p);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; pq_sendint32(buf, slen);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendBinaryStringInfoNT(buf, str, slen);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L172" title="libpq/pqformat.c:172">pq_sendtext</a>&nbsp; &nbsp; &nbsp; &nbsp; - append a text string (with conversion)<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The passed text string need not be null-terminated, and the data sent<br/></li>
<li></span><span class="Comment"> * to the frontend isn't either.&nbsp; Note that this is not actually useful<br/></li>
<li></span><span class="Comment"> * for direct frontend transmissions, since there'd be no way for the<br/></li>
<li></span><span class="Comment"> * frontend to determine the string length.&nbsp; But it is useful for binary<br/></li>
<li></span><span class="Comment"> * format conversions.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L172">&#x200c;</a></span><span class="linkable">pq_sendtext</span>(StringInfo buf, <span class="Type">const</span> <span class="Type">char</span> *str, <span class="Type">int</span> slen)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = <a href="../utils/mb/mbutils.c.html#L738" title="utils/mb/mbutils.c:738">pg_server_to_client</a>(str, slen);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (p != str)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* actual conversion has been done? */<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; slen = strlen(p);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendBinaryStringInfo(buf, p, slen);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(p);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; appendBinaryStringInfo(buf, str, slen);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L195" title="libpq/pqformat.c:195">pq_sendstring</a>&nbsp; &nbsp; - append a null-terminated text string (with conversion)<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * NB: passed text string must be null-terminated, and so is the data<br/></li>
<li></span><span class="Comment"> * sent to the frontend.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L195">&#x200c;</a></span><span class="linkable">pq_sendstring</span>(StringInfo buf, <span class="Type">const</span> <span class="Type">char</span> *str)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slen = strlen(str);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = <a href="../utils/mb/mbutils.c.html#L738" title="utils/mb/mbutils.c:738">pg_server_to_client</a>(str, slen);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (p != str)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* actual conversion has been done? */<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; slen = strlen(p);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendBinaryStringInfoNT(buf, p, slen + <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(p);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; appendBinaryStringInfoNT(buf, str, slen + <span class="Constant">1</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L227" title="libpq/pqformat.c:227">pq_send_ascii_string</a>&nbsp; &nbsp; - append a null-terminated text string (without conversion)<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This function intentionally bypasses encoding conversion, instead just<br/></li>
<li></span><span class="Comment"> * silently replacing <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> non-7-<a href="../utils/adt/varbit.c.html#L391" title="utils/adt/varbit.c:391">bit</a>-ASCII characters with question marks.<br/></li>
<li></span><span class="Comment"> * It is used only when we are having trouble sending an error message to<br/></li>
<li></span><span class="Comment"> * the client with normal localization and encoding conversion.&nbsp; The caller<br/></li>
<li></span><span class="Comment"> * should already have taken measures to ensure the string is just ASCII;<br/></li>
<li></span><span class="Comment"> * the extra work here is just to make certain we don't <a href="../port/win32/socket.c.html#L38" title="port/win32/socket.c:38">send</a> a badly encoded<br/></li>
<li></span><span class="Comment"> * string to the client (which might or might not be robust about that).<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * NB: passed text string must be null-terminated, and so is the data<br/></li>
<li></span><span class="Comment"> * sent to the frontend.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L227">&#x200c;</a></span><span class="linkable">pq_send_ascii_string</span>(StringInfo buf, <span class="Type">const</span> <span class="Type">char</span> *str)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">while</span> (*str)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; ch = *str++;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (IS_HIGHBIT_SET(ch))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ch = <span class="Constant">'?'</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoCharMacro(buf, ch);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; appendStringInfoChar(buf, <span class="Special">'\0'</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L252" title="libpq/pqformat.c:252">pq_sendfloat4</a>&nbsp; &nbsp; - append a float4 to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The point of this routine is to localize knowledge of the external binary<br/></li>
<li></span><span class="Comment"> * representation of float4, which is a component of several datatypes.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * We currently assume that float4 should be byte-swapped in the same way<br/></li>
<li></span><span class="Comment"> * as int4.&nbsp; This rule is not perfect but it gives us portability across<br/></li>
<li></span><span class="Comment"> * most IEEE-float-using architectures.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L252">&#x200c;</a></span><span class="linkable">pq_sendfloat4</span>(StringInfo buf, float4 f)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">union<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; float4&nbsp; &nbsp; &nbsp; &nbsp; f;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; uint32&nbsp; &nbsp; &nbsp; &nbsp; i;<br/></li>
<li>&nbsp; &nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; swap;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; swap.f = f;<br/></li>
<li>&nbsp; &nbsp; pq_sendint32(buf, swap.i);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L276" title="libpq/pqformat.c:276">pq_sendfloat8</a>&nbsp; &nbsp; - append a float8 to a StringInfo buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The point of this routine is to localize knowledge of the external binary<br/></li>
<li></span><span class="Comment"> * representation of float8, which is a component of several datatypes.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * We currently assume that float8 should be byte-swapped in the same way<br/></li>
<li></span><span class="Comment"> * as int8.&nbsp; This rule is not perfect but it gives us portability across<br/></li>
<li></span><span class="Comment"> * most IEEE-float-using architectures.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L276">&#x200c;</a></span><span class="linkable">pq_sendfloat8</span>(StringInfo buf, float8 f)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">union<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; float8&nbsp; &nbsp; &nbsp; &nbsp; f;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; i;<br/></li>
<li>&nbsp; &nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; swap;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; swap.f = f;<br/></li>
<li>&nbsp; &nbsp; pq_sendint64(buf, swap.i);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L296" title="libpq/pqformat.c:296">pq_endmessage</a>&nbsp; &nbsp; - <a href="../port/win32/socket.c.html#L38" title="port/win32/socket.c:38">send</a> the completed message to the frontend<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The data buffer is <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>()d, but if the StringInfo was allocated with<br/></li>
<li></span><span class="Comment"> * makeStringInfo then the caller must still <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a> it.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L296">&#x200c;</a></span><span class="linkable">pq_endmessage</span>(StringInfo buf)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* msgtype was saved in cursor field */<br/></li>
<li></span>&nbsp; &nbsp; (<span class="Type">void</span>) pq_putmessage(buf-&gt;cursor, buf-&gt;data, buf-&gt;len);<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* no need to complain about <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> failure, since pqcomm.c already did */<br/></li>
<li></span>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(buf-&gt;data);<br/></li>
<li>&nbsp; &nbsp; buf-&gt;data = <span class="Constant">NULL</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L314" title="libpq/pqformat.c:314">pq_endmessage_reuse</a>&nbsp; &nbsp; - <a href="../port/win32/socket.c.html#L38" title="port/win32/socket.c:38">send</a> the completed message to the frontend<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The data buffer is *not* freed, allowing to reuse the buffer with<br/></li>
<li></span><span class="Comment"> * <a href="#L109" title="libpq/pqformat.c:109">pq_beginmessage_reuse</a>.<br/></li>
<li></span><span class="Comment"> --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><br/></li>
<li><span class="Type">void<br/></li>
<li><a id="L314">&#x200c;</a></span><span class="linkable">pq_endmessage_reuse</span>(StringInfo buf)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* msgtype was saved in cursor field */<br/></li>
<li></span>&nbsp; &nbsp; (<span class="Type">void</span>) pq_putmessage(buf-&gt;cursor, buf-&gt;data, buf-&gt;len);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L326" title="libpq/pqformat.c:326">pq_begintypsend</a>&nbsp; &nbsp; &nbsp; &nbsp; - <a href="../regex/rege_dfa.c.html#L731" title="regex/rege_dfa.c:731">initialize</a> for constructing a bytea result<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L326">&#x200c;</a></span><span class="linkable">pq_begintypsend</span>(StringInfo buf)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; initStringInfo(buf);<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Reserve four bytes for the bytea length <a href="../regex/regcomp.c.html#L1474" title="regex/regcomp.c:1474">word</a> */<br/></li>
<li></span>&nbsp; &nbsp; appendStringInfoCharMacro(buf, <span class="Special">'\0'</span>);<br/></li>
<li>&nbsp; &nbsp; appendStringInfoCharMacro(buf, <span class="Special">'\0'</span>);<br/></li>
<li>&nbsp; &nbsp; appendStringInfoCharMacro(buf, <span class="Special">'\0'</span>);<br/></li>
<li>&nbsp; &nbsp; appendStringInfoCharMacro(buf, <span class="Special">'\0'</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L346" title="libpq/pqformat.c:346">pq_endtypsend</a>&nbsp; &nbsp; - finish constructing a bytea result<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The data buffer is returned as the <a href="../utils/mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>'d bytea value.&nbsp; (We expect<br/></li>
<li></span><span class="Comment"> * that it will be suitably aligned for this because it has been <a href="../utils/mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>'d.)<br/></li>
<li></span><span class="Comment"> * We assume the StringInfoData is just a local variable in the caller and<br/></li>
<li></span><span class="Comment"> * need not be <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>'d.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>bytea *<br/></li>
<li><a id="L346">&#x200c;</a><span class="linkable">pq_endtypsend</span>(StringInfo buf)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; bytea&nbsp; &nbsp; &nbsp;&nbsp; *result = (bytea *) buf-&gt;data;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* <a href="../storage/file/fd.c.html#L1313" title="storage/file/fd.c:1313">Insert</a> correct length into bytea length <a href="../regex/regcomp.c.html#L1474" title="regex/regcomp.c:1474">word</a> */<br/></li>
<li></span>&nbsp; &nbsp; Assert(buf-&gt;len &gt;= VARHDRSZ);<br/></li>
<li>&nbsp; &nbsp; SET_VARSIZE(result, buf-&gt;len);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> result;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L367" title="libpq/pqformat.c:367">pq_puttextmessage</a> - generate a character set-converted message in one step<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; This is the same as the pqcomm.c routine pq_putmessage, except that<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; the message body is a null-terminated string to which encoding<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; conversion applies.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L367">&#x200c;</a></span><span class="linkable">pq_puttextmessage</span>(<span class="Type">char</span> msgtype, <span class="Type">const</span> <span class="Type">char</span> *str)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slen = strlen(str);<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = <a href="../utils/mb/mbutils.c.html#L738" title="utils/mb/mbutils.c:738">pg_server_to_client</a>(str, slen);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (p != str)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* actual conversion has been done? */<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (<span class="Type">void</span>) pq_putmessage(msgtype, p, strlen(p) + <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(p);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; (<span class="Type">void</span>) pq_putmessage(msgtype, str, slen + <span class="Constant">1</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L388" title="libpq/pqformat.c:388">pq_putemptymessage</a> - convenience routine for message with empty body<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L388">&#x200c;</a></span><span class="linkable">pq_putemptymessage</span>(<span class="Type">char</span> msgtype)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; (<span class="Type">void</span>) pq_putmessage(msgtype, <span class="Constant">NULL</span>, <span class="Constant">0</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L399" title="libpq/pqformat.c:399">pq_getmsgbyte</a>&nbsp; &nbsp; - get a raw byte from a message buffer<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">int<br/></li>
<li><a id="L399">&#x200c;</a></span><span class="linkable">pq_getmsgbyte</span>(StringInfo msg)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (msg-&gt;cursor &gt;= msg-&gt;len)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_PROTOCOL_VIOLATION),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;no data left in message&quot;</span>)));<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> (<span class="Type">unsigned</span> <span class="Type">char</span>) msg-&gt;data[msg-&gt;cursor++];<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L415" title="libpq/pqformat.c:415">pq_getmsgint</a>&nbsp; &nbsp; - get a binary integer from a message buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; Values are treated as unsigned.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">unsigned</span> <span class="Type">int<br/></li>
<li><a id="L415">&#x200c;</a></span><span class="linkable">pq_getmsgint</span>(StringInfo msg, <span class="Type">int</span> b)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">unsigned</span> <span class="Type">int</span> result;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">unsigned</span> <span class="Type">char</span> n8;<br/></li>
<li>&nbsp; &nbsp; uint16&nbsp; &nbsp; &nbsp; &nbsp; n16;<br/></li>
<li>&nbsp; &nbsp; uint32&nbsp; &nbsp; &nbsp; &nbsp; n32;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (b)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">1</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L528" title="libpq/pqformat.c:528">pq_copymsgbytes</a>(msg, (<span class="Type">char</span> *) &amp;n8, <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result = n8;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">2</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L528" title="libpq/pqformat.c:528">pq_copymsgbytes</a>(msg, (<span class="Type">char</span> *) &amp;n16, <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result = pg_ntoh16(n16);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> <span class="Constant">4</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L528" title="libpq/pqformat.c:528">pq_copymsgbytes</a>(msg, (<span class="Type">char</span> *) &amp;n32, <span class="Constant">4</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result = pg_ntoh32(n32);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elog(ERROR, <span class="Constant">&quot;unsupported integer size </span><span class="Special">%d</span><span class="Constant">&quot;</span>, b);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result = <span class="Constant">0</span>;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* keep compiler quiet */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> result;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L453" title="libpq/pqformat.c:453">pq_getmsgint64</a>&nbsp; &nbsp; - get a binary 8-byte int from a message buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * It is tempting to <a href="../lib/pairingheap.c.html#L79" title="lib/pairingheap.c:79">merge</a> this with <a href="#L415" title="libpq/pqformat.c:415">pq_getmsgint</a>, but we'd have to make the<br/></li>
<li></span><span class="Comment"> * result int64 for all data widths --- that could be a big performance<br/></li>
<li></span><span class="Comment"> * hit on machines where int64 isn't efficient.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>int64<br/></li>
<li><a id="L453">&#x200c;</a><span class="linkable">pq_getmsgint64</span>(StringInfo msg)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; uint64&nbsp; &nbsp; &nbsp; &nbsp; n64;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L528" title="libpq/pqformat.c:528">pq_copymsgbytes</a>(msg, (<span class="Type">char</span> *) &amp;n64, <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(n64));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> pg_ntoh64(n64);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L469" title="libpq/pqformat.c:469">pq_getmsgfloat4</a> - get a float4 from a message buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * See notes for <a href="#L252" title="libpq/pqformat.c:252">pq_sendfloat4</a>.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>float4<br/></li>
<li><a id="L469">&#x200c;</a><span class="linkable">pq_getmsgfloat4</span>(StringInfo msg)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">union<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; float4&nbsp; &nbsp; &nbsp; &nbsp; f;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; uint32&nbsp; &nbsp; &nbsp; &nbsp; i;<br/></li>
<li>&nbsp; &nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; swap;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; swap.i = <a href="#L415" title="libpq/pqformat.c:415">pq_getmsgint</a>(msg, <span class="Constant">4</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> swap.f;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L488" title="libpq/pqformat.c:488">pq_getmsgfloat8</a> - get a float8 from a message buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * See notes for <a href="#L276" title="libpq/pqformat.c:276">pq_sendfloat8</a>.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>float8<br/></li>
<li><a id="L488">&#x200c;</a><span class="linkable">pq_getmsgfloat8</span>(StringInfo msg)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">union<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; float8&nbsp; &nbsp; &nbsp; &nbsp; f;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; i;<br/></li>
<li>&nbsp; &nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; swap;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; swap.i = <a href="#L453" title="libpq/pqformat.c:453">pq_getmsgint64</a>(msg);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> swap.f;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L508" title="libpq/pqformat.c:508">pq_getmsgbytes</a>&nbsp; &nbsp; - get raw data from a message buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; Returns a pointer directly into the message buffer; note this<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; may not have <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> particular alignment.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">const</span> <span class="Type">char</span> *<br/></li>
<li><a id="L508">&#x200c;</a><span class="linkable">pq_getmsgbytes</span>(StringInfo msg, <span class="Type">int</span> datalen)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *result;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (datalen &lt; <span class="Constant">0</span> || datalen &gt; (msg-&gt;len - msg-&gt;cursor))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_PROTOCOL_VIOLATION),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;insufficient data left in message&quot;</span>)));<br/></li>
<li>&nbsp; &nbsp; result = &amp;msg-&gt;data[msg-&gt;cursor];<br/></li>
<li>&nbsp; &nbsp; msg-&gt;cursor += datalen;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> result;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L528" title="libpq/pqformat.c:528">pq_copymsgbytes</a> - copy raw data from a message buffer<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; Same as above, except data is copied to caller's buffer.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L528">&#x200c;</a></span><span class="linkable">pq_copymsgbytes</span>(StringInfo msg, <span class="Type">char</span> *buf, <span class="Type">int</span> datalen)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (datalen &lt; <span class="Constant">0</span> || datalen &gt; (msg-&gt;len - msg-&gt;cursor))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_PROTOCOL_VIOLATION),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;insufficient data left in message&quot;</span>)));<br/></li>
<li>&nbsp; &nbsp; memcpy(buf, &amp;msg-&gt;data[msg-&gt;cursor], datalen);<br/></li>
<li>&nbsp; &nbsp; msg-&gt;cursor += datalen;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L546" title="libpq/pqformat.c:546">pq_getmsgtext</a>&nbsp; &nbsp; - get a counted text string (with conversion)<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; Always returns a pointer to a freshly <a href="../utils/mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>'d result.<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; The result has a trailing null, *and* we return its strlen in *nbytes.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">char</span> *<br/></li>
<li><a id="L546">&#x200c;</a><span class="linkable">pq_getmsgtext</span>(StringInfo msg, <span class="Type">int</span> rawbytes, <span class="Type">int</span> *nbytes)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *str;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *p;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (rawbytes &lt; <span class="Constant">0</span> || rawbytes &gt; (msg-&gt;len - msg-&gt;cursor))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_PROTOCOL_VIOLATION),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;insufficient data left in message&quot;</span>)));<br/></li>
<li>&nbsp; &nbsp; str = &amp;msg-&gt;data[msg-&gt;cursor];<br/></li>
<li>&nbsp; &nbsp; msg-&gt;cursor += rawbytes;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; p = <a href="../utils/mb/mbutils.c.html#L660" title="utils/mb/mbutils.c:660">pg_client_to_server</a>(str, rawbytes);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (p != str)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* actual conversion has been done? */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; *nbytes = strlen(p);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p = (<span class="Type">char</span> *) <a href="../utils/mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>(rawbytes + <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; memcpy(p, str, rawbytes);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; p[rawbytes] = <span class="Special">'\0'</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; *nbytes = rawbytes;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> p;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L579" title="libpq/pqformat.c:579">pq_getmsgstring</a> - get a null-terminated text string (with conversion)<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; May return a pointer directly into the message buffer, or a pointer<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; to a <a href="../utils/mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>'d conversion result.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">const</span> <span class="Type">char</span> *<br/></li>
<li><a id="L579">&#x200c;</a><span class="linkable">pq_getmsgstring</span>(StringInfo msg)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *str;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slen;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; str = &amp;msg-&gt;data[msg-&gt;cursor];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * It's safe to use strlen() here because a StringInfo is guaranteed to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * have a trailing null byte.&nbsp; But check we found a null inside the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * message.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; slen = strlen(str);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (msg-&gt;cursor + slen &gt;= msg-&gt;len)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_PROTOCOL_VIOLATION),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;invalid string in message&quot;</span>)));<br/></li>
<li>&nbsp; &nbsp; msg-&gt;cursor += slen + <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <a href="../utils/mb/mbutils.c.html#L660" title="utils/mb/mbutils.c:660">pg_client_to_server</a>(str, slen);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L608" title="libpq/pqformat.c:608">pq_getmsgrawstring</a> - get a null-terminated text string - NO conversion<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; Returns a pointer directly into the message buffer.<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">const</span> <span class="Type">char</span> *<br/></li>
<li><a id="L608">&#x200c;</a><span class="linkable">pq_getmsgrawstring</span>(StringInfo msg)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *str;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slen;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; str = &amp;msg-&gt;data[msg-&gt;cursor];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * It's safe to use strlen() here because a StringInfo is guaranteed to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * have a trailing null byte.&nbsp; But check we found a null inside the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * message.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; slen = strlen(str);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (msg-&gt;cursor + slen &gt;= msg-&gt;len)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_PROTOCOL_VIOLATION),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;invalid string in message&quot;</span>)));<br/></li>
<li>&nbsp; &nbsp; msg-&gt;cursor += slen + <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> str;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* --------------------------------<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L635" title="libpq/pqformat.c:635">pq_getmsgend</a>&nbsp; &nbsp; - verify message fully consumed<br/></li>
<li></span><span class="Comment"> * --------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L635">&#x200c;</a></span><span class="linkable">pq_getmsgend</span>(StringInfo msg)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (msg-&gt;cursor != msg-&gt;len)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_PROTOCOL_VIOLATION),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;invalid message format&quot;</span>)));<br/></li>
<li>}<br/></li>
</ol></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="../index.html">Top Level</a></span>
 </p>

 </body>
</html>
