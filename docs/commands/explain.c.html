<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>commands/explain.c - pgsql17devel-backend</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

.nav-bar {
    font-size: 120%;
    margin-top: 5px;
    margin-bottom: 5px;
}

.nav-link {
    padding-left: 5em;
    padding-right: 5em;
}

ul.toc {
    line-height: 200%;
    font-size: 150%;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}

span.Constant {
    color: DarkGreen;
}

span.Special {
    color: #c06000;
}

span.Comment {
    color: DarkRed;
    font-style: italic;
}

span.Identifier {
    color: DarkCyan;
}

span.PreProc {
    color: DarkMagenta;
}

span.Statement, span.Type, span.Keyword, span.Repeat, span.Conditional,
    span.Operator, span.Exception
{
    color: DarkBlue;
}

span.Todo {
    color: DarkRed;
    background-color: Gold;
    font-style: italic;
}

span.Underlined {
    text-decoration: underline;
}

span.linkable {
    font-weight: bold;
}

code ol {
    counter-reset: item;
    list-style-type: none;
    margin-left: 0;
    padding-left: 0;
    list-style-position: inside;
}

code li {
    display: block;
}

code li:before {
    content: counter(item) "  ";
    counter-increment: item;
    color: #999;
    padding-right: 0.5em;
    padding-left: 0.4em;
    list-style-position: inside;
    text-align: right
}

  </style>
 </head>
 <body>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="../index.html">Top Level</a></span>
 </p>

  <h1>commands/explain.c - pgsql17devel-backend</h1>
 <h2>Global variables defined</h2>
 <ul class="toc">
<li><a href="#L45">ExplainOneQuery_hook</a></li>
<li><a href="#L48">explain_get_index_name_hook</a></li>
</ul>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L5307">SerializeDestReceiver</a></li>
<li><a href="#L5318">SerializeDestReceiver</a></li>
<li><a href="#L52">SerializeMetrics</a></li>
<li><a href="#L57">SerializeMetrics</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L5549">CreateExplainSerializeDestReceiver</a></li>
<li><a href="#L5116">ExplainBeginOutput</a></li>
<li><a href="#L4923">ExplainCloseGroup</a></li>
<li><a href="#L4553">ExplainCloseWorker</a></li>
<li><a href="#L4474">ExplainCreateWorkersState</a></li>
<li><a href="#L4452">ExplainCustomChildren</a></li>
<li><a href="#L5070">ExplainDummyGroup</a></li>
<li><a href="#L5147">ExplainEndOutput</a></li>
<li><a href="#L4589">ExplainFlushWorkersState</a></li>
<li><a href="#L5232">ExplainIndentText</a></li>
<li><a href="#L3969">ExplainIndexScanDetails</a></li>
<li><a href="#L5247">ExplainJSONLineEnding</a></li>
<li><a href="#L4377">ExplainMemberNodes</a></li>
<li><a href="#L4395">ExplainMissingMembers</a></li>
<li><a href="#L4018">ExplainModifyTarget</a></li>
<li><a href="#L1360">ExplainNode</a></li>
<li><a href="#L610">ExplainOnePlan</a></li>
<li><a href="#L421">ExplainOneQuery</a></li>
<li><a href="#L520">ExplainOneUtility</a></li>
<li><a href="#L4860">ExplainOpenGroup</a></li>
<li><a href="#L4970">ExplainOpenSetAsideGroup</a></li>
<li><a href="#L4491">ExplainOpenWorker</a></li>
<li><a href="#L1285">ExplainPreScanNode</a></li>
<li><a href="#L1004">ExplainPrintJIT</a></li>
<li><a href="#L978">ExplainPrintJITSummary</a></li>
<li><a href="#L870">ExplainPrintPlan</a></li>
<li><a href="#L1102">ExplainPrintSerialize</a></li>
<li><a href="#L800">ExplainPrintSettings</a></li>
<li><a href="#L935">ExplainPrintTriggers</a></li>
<li><a href="#L4742">ExplainProperty</a></li>
<li><a href="#L4845">ExplainPropertyBool</a></li>
<li><a href="#L4831">ExplainPropertyFloat</a></li>
<li><a href="#L4804">ExplainPropertyInteger</a></li>
<li><a href="#L4619">ExplainPropertyList</a></li>
<li><a href="#L4689">ExplainPropertyListNested</a></li>
<li><a href="#L4795">ExplainPropertyText</a></li>
<li><a href="#L4817">ExplainPropertyUInteger</a></li>
<li><a href="#L176">ExplainQuery</a></li>
<li><a href="#L1177">ExplainQueryParameters</a></li>
<li><a href="#L1162">ExplainQueryText</a></li>
<li><a href="#L5039">ExplainRestoreGroup</a></li>
<li><a href="#L382">ExplainResultDesc</a></li>
<li><a href="#L5009">ExplainSaveGroup</a></li>
<li><a href="#L4005">ExplainScanTarget</a></li>
<li><a href="#L5176">ExplainSeparatePlans</a></li>
<li><a href="#L4409">ExplainSubPlans</a></li>
<li><a href="#L4027">ExplainTargetRel</a></li>
<li><a href="#L5205">ExplainXMLTag</a></li>
<li><a href="#L5267">ExplainYAMLLineStarting</a></li>
<li><a href="#L5574">GetSerializationMetrics</a></li>
<li><a href="#L365">NewExplainState</a></li>
<li><a href="#L1266">elapsed_time</a></li>
<li><a href="#L5292">escape_yaml</a></li>
<li><a href="#L3672">explain_get_index_name</a></li>
<li><a href="#L3696">peek_buffer_usage</a></li>
<li><a href="#L1195">report_triggers</a></li>
<li><a href="#L5540">serializeAnalyzeDestroy</a></li>
<li><a href="#L5380">serializeAnalyzeReceive</a></li>
<li><a href="#L5519">serializeAnalyzeShutdown</a></li>
<li><a href="#L5483">serializeAnalyzeStartup</a></li>
<li><a href="#L5327">serialize_prepare_info</a></li>
<li><a href="#L2600">show_agg_keys</a></li>
<li><a href="#L3736">show_buffer_usage</a></li>
<li><a href="#L2480">show_expression</a></li>
<li><a href="#L3644">show_foreignscan_info</a></li>
<li><a href="#L2732">show_group_keys</a></li>
<li><a href="#L2654">show_grouping_set_keys</a></li>
<li><a href="#L2623">show_grouping_sets</a></li>
<li><a href="#L3229">show_hash_info</a></li>
<li><a href="#L3464">show_hashagg_info</a></li>
<li><a href="#L3029">show_incremental_sort_group_info</a></li>
<li><a href="#L3143">show_incremental_sort_info</a></li>
<li><a href="#L2567">show_incremental_sort_keys</a></li>
<li><a href="#L3615">show_instrumentation_count</a></li>
<li><a href="#L3320">show_memoize_info</a></li>
<li><a href="#L3943">show_memory_counters</a></li>
<li><a href="#L2584">show_merge_append_keys</a></li>
<li><a href="#L4165">show_modifytable_info</a></li>
<li><a href="#L2422">show_plan_tlist</a></li>
<li><a href="#L2503">show_qual</a></li>
<li><a href="#L2524">show_scan_qual</a></li>
<li><a href="#L2752">show_sort_group_keys</a></li>
<li><a href="#L2938">show_sort_info</a></li>
<li><a href="#L2552">show_sort_keys</a></li>
<li><a href="#L2814">show_sortorder_options</a></li>
<li><a href="#L2872">show_tablesample</a></li>
<li><a href="#L3585">show_tidbitmap_info</a></li>
<li><a href="#L2538">show_upper_qual</a></li>
<li><a href="#L3905">show_wal_usage</a></li>
<li><a href="#L448">standard_ExplainOneQuery</a></li>
</ul>
 <h2>Macros defined</h2>
 <ul class="toc">
<li><a href="#L62">X_CLOSE_IMMEDIATE</a></li>
<li><a href="#L61">X_CLOSING</a></li>
<li><a href="#L63">X_NOWHITESPACE</a></li>
<li><a href="#L60">X_OPENING</a></li>
</ul>
 <h2>Source code</h2>

  <code><ol><li><span class="Comment">/*-------------------------------------------------------------------------<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * explain.c<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; Explain query execution plans<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Portions Copyright (c) 1996-2024, PostgreSQL Global Development Group<br/></li>
<li></span><span class="Comment"> * Portions Copyright (c) 1994-5, Regents of the University of California<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * IDENTIFICATION<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; src/backend/commands/explain.c<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> *-------------------------------------------------------------------------<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;postgres.h&quot;<br/></li>
<li></span><br/></li>
<li><span class="PreProc">#include </span><span class="Constant">&quot;access/xact.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;catalog/pg_type.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;commands/createas.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;commands/defrem.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;commands/prepare.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;foreign/fdwapi.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;jit/jit.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;libpq/pqformat.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;nodes/extensible.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;nodes/makefuncs.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;nodes/nodeFuncs.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;parser/<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;parser/parsetree.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;rewrite/rewriteHandler.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;storage/bufmgr.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;tcop/tcopprot.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/builtins.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/guc_tables.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/json.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/lsyscache.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/rel.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/ruleutils.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/snapmgr.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/tuplesort.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/typcache.h&quot;<br/></li>
<li></span><span class="PreProc">#include </span><span class="Constant">&quot;utils/xml.h&quot;<br/></li>
<li></span><br/></li>
<li><br/></li>
<li><span class="Comment">/* Hook for plugins to get control in <a href="#L421" title="commands/explain.c:421">ExplainOneQuery</a>() */<br/></li>
<li><a id="L45">&#x200c;</a></span>ExplainOneQuery_hook_type <span class="linkable">ExplainOneQuery_hook</span> = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* Hook for plugins to get control in <a href="#L3672" title="commands/explain.c:3672">explain_get_index_name</a>() */<br/></li>
<li><a id="L48">&#x200c;</a></span>explain_get_index_name_hook_type <span class="linkable">explain_get_index_name_hook</span> = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/* Instrumentation data for SERIALIZE option */<br/></li>
<li><a id="L52">&#x200c;</a></span><span class="Type">typedef</span> <span class="Type">struct</span> <span class="linkable">SerializeMetrics</span><br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; uint64&nbsp; &nbsp; &nbsp; &nbsp; bytesSent;&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* # of bytes serialized */<br/></li>
<li></span>&nbsp; &nbsp; instr_time&nbsp; &nbsp; timeSpent;&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* time spent serializing */<br/></li>
<li></span>&nbsp; &nbsp; BufferUsage bufferUsage;&nbsp; &nbsp; <span class="Comment">/* buffers accessed during serialization */<br/></li>
<li><a id="L57">&#x200c;</a></span>} <span class="linkable">SerializeMetrics</span>;<br/></li>
<li><br/></li>
<li><span class="Comment">/* OR-able flags for <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>() */<br/></li>
<li><a id="L60">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">X_OPENING</span> </span><span class="Constant">0<br/></li>
<li><a id="L61">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">X_CLOSING</span> </span><span class="Constant">1<br/></li>
<li><a id="L62">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">X_CLOSE_IMMEDIATE</span> </span><span class="Constant">2<br/></li>
<li><a id="L63">&#x200c;</a></span><span class="PreProc">#define <span class="linkable">X_NOWHITESPACE</span> </span><span class="Constant">4<br/></li>
<li></span><br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L421" title="commands/explain.c:421">ExplainOneQuery</a>(Query *query, <span class="Type">int</span> cursorOptions,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IntoClause *into, ExplainState *es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *queryString, ParamListInfo params,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/misc/queryenvironment.c.html#L32" title="utils/misc/queryenvironment.c:32">QueryEnvironment</a> *queryEnv);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L1004" title="commands/explain.c:1004">ExplainPrintJIT</a>(ExplainState *es, <span class="Type">int</span> jit_flags,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JitInstrumentation *ji);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L1102" title="commands/explain.c:1102">ExplainPrintSerialize</a>(ExplainState *es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L52" title="commands/explain.c:52">SerializeMetrics</a> *metrics);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L1195" title="commands/explain.c:1195">report_triggers</a>(ResultRelInfo *rInfo, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> show_relname,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">double</span> <a href="#L1266" title="commands/explain.c:1266">elapsed_time</a>(instr_time *starttime);<br/></li>
<li><span class="Type">static</span> <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> <a href="#L1285" title="commands/explain.c:1285">ExplainPreScanNode</a>(PlanState *planstate, Bitmapset **rels_used);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a>(PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *relationship, <span class="Type">const</span> <span class="Type">char</span> *plan_name,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2422" title="commands/explain.c:2422">show_plan_tlist</a>(PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2480" title="commands/explain.c:2480">show_expression</a>(Node *node, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> useprefix, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2503" title="commands/explain.c:2503">show_qual</a>(List *qual, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> useprefix, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(List *qual, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(List *qual, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2552" title="commands/explain.c:2552">show_sort_keys</a>(SortState *sortstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2567" title="commands/explain.c:2567">show_incremental_sort_keys</a>(IncrementalSortState *incrsortstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2584" title="commands/explain.c:2584">show_merge_append_keys</a>(MergeAppendState *mstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2600" title="commands/explain.c:2600">show_agg_keys</a>(AggState *astate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2623" title="commands/explain.c:2623">show_grouping_sets</a>(PlanState *planstate, Agg *agg,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2654" title="commands/explain.c:2654">show_grouping_set_keys</a>(PlanState *planstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Agg *aggnode, Sort *sortnode,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *context, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> useprefix,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2732" title="commands/explain.c:2732">show_group_keys</a>(GroupState *gstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2752" title="commands/explain.c:2752">show_sort_group_keys</a>(PlanState *planstate, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">int</span> nkeys, <span class="Type">int</span> nPresortedKeys, AttrNumber *keycols,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Oid *sortOperators, Oid *collations, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> *nullsFirst,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2814" title="commands/explain.c:2814">show_sortorder_options</a>(StringInfo buf, Node *sortexpr,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Oid sortOperator, Oid collation, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> nullsFirst);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2872" title="commands/explain.c:2872">show_tablesample</a>(TableSampleClause *tsc, PlanState *planstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L2938" title="commands/explain.c:2938">show_sort_info</a>(SortState *sortstate, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3143" title="commands/explain.c:3143">show_incremental_sort_info</a>(IncrementalSortState *incrsortstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3229" title="commands/explain.c:3229">show_hash_info</a>(HashState *hashstate, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3320" title="commands/explain.c:3320">show_memoize_info</a>(MemoizeState *mstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3464" title="commands/explain.c:3464">show_hashagg_info</a>(AggState *aggstate, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3585" title="commands/explain.c:3585">show_tidbitmap_info</a>(BitmapHeapScanState *planstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type">int</span> which,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; PlanState *planstate, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3644" title="commands/explain.c:3644">show_foreignscan_info</a>(ForeignScanState *fsstate, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">const</span> <span class="Type">char</span> *<a href="#L3672" title="commands/explain.c:3672">explain_get_index_name</a>(Oid indexId);<br/></li>
<li><span class="Type">static</span> <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> <a href="#L3696" title="commands/explain.c:3696">peek_buffer_usage</a>(ExplainState *es, <span class="Type">const</span> BufferUsage *usage);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3736" title="commands/explain.c:3736">show_buffer_usage</a>(ExplainState *es, <span class="Type">const</span> BufferUsage *usage);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3905" title="commands/explain.c:3905">show_wal_usage</a>(ExplainState *es, <span class="Type">const</span> WalUsage *usage);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3943" title="commands/explain.c:3943">show_memory_counters</a>(ExplainState *es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">const</span> MemoryContextCounters *mem_counters);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L3969" title="commands/explain.c:3969">ExplainIndexScanDetails</a>(Oid indexid, ScanDirection indexorderdir,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4005" title="commands/explain.c:4005">ExplainScanTarget</a>(Scan *plan, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4018" title="commands/explain.c:4018">ExplainModifyTarget</a>(ModifyTable *plan, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4027" title="commands/explain.c:4027">ExplainTargetRel</a>(Plan *plan, Index rti, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4165" title="commands/explain.c:4165">show_modifytable_info</a>(ModifyTableState *mtstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4377" title="commands/explain.c:4377">ExplainMemberNodes</a>(PlanState **planstates, <span class="Type">int</span> nplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4395" title="commands/explain.c:4395">ExplainMissingMembers</a>(<span class="Type">int</span> nplans, <span class="Type">int</span> nchildren, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4409" title="commands/explain.c:4409">ExplainSubPlans</a>(List *plans, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *relationship, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4452" title="commands/explain.c:4452">ExplainCustomChildren</a>(CustomScanState *css,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List *ancestors, ExplainState *es);<br/></li>
<li><span class="Type">static</span> ExplainWorkersState *<a href="#L4474" title="commands/explain.c:4474">ExplainCreateWorkersState</a>(<span class="Type">int</span> num_workers);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(<span class="Type">int</span> n, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>(<span class="Type">int</span> n, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4589" title="commands/explain.c:4589">ExplainFlushWorkersState</a>(ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4742" title="commands/explain.c:4742">ExplainProperty</a>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type">const</span> <span class="Type">char</span> *unit,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *value, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> <a href="../utils/adt/numeric.c.html#L1237" title="utils/adt/numeric.c:1237">numeric</a>, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L4970" title="commands/explain.c:4970">ExplainOpenSetAsideGroup</a>(<span class="Type">const</span> <span class="Type">char</span> *objtype, <span class="Type">const</span> <span class="Type">char</span> *labelname,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> labeled, <span class="Type">int</span> depth, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L5009" title="commands/explain.c:5009">ExplainSaveGroup</a>(ExplainState *es, <span class="Type">int</span> depth, <span class="Type">int</span> *state_save);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L5039" title="commands/explain.c:5039">ExplainRestoreGroup</a>(ExplainState *es, <span class="Type">int</span> depth, <span class="Type">int</span> *state_save);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L5070" title="commands/explain.c:5070">ExplainDummyGroup</a>(<span class="Type">const</span> <span class="Type">char</span> *objtype, <span class="Type">const</span> <span class="Type">char</span> *labelname,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>(<span class="Type">const</span> <span class="Type">char</span> *tagname, <span class="Type">int</span> flags, ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L5247" title="commands/explain.c:5247">ExplainJSONLineEnding</a>(ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L5267" title="commands/explain.c:5267">ExplainYAMLLineStarting</a>(ExplainState *es);<br/></li>
<li><span class="Type">static</span> <span class="Type">void</span> <a href="#L5292" title="commands/explain.c:5292">escape_yaml</a>(StringInfo buf, <span class="Type">const</span> <span class="Type">char</span> *str);<br/></li>
<li><span class="Type">static</span> <a href="#L52" title="commands/explain.c:52">SerializeMetrics</a> <a href="#L5574" title="commands/explain.c:5574">GetSerializationMetrics</a>(DestReceiver *dest);<br/></li>
<li><br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L176" title="commands/explain.c:176">ExplainQuery</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; execute an EXPLAIN command<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L176">&#x200c;</a></span><span class="linkable">ExplainQuery</span>(ParseState *pstate, ExplainStmt *stmt,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ParamListInfo params, DestReceiver *dest)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ExplainState *es = <a href="#L365" title="commands/explain.c:365">NewExplainState</a>();<br/></li>
<li>&nbsp; &nbsp; TupOutputState *tstate;<br/></li>
<li>&nbsp; &nbsp; JumbleState *jstate = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; Query&nbsp; &nbsp; &nbsp;&nbsp; *query;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *rewritten;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; timing_set = <span class="Constant">false</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; summary_set = <span class="Constant">false</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Parse options list. */<br/></li>
<li></span>&nbsp; &nbsp; foreach(lc, stmt-&gt;options)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; DefElem&nbsp; &nbsp; *opt = (DefElem *) lfirst(lc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;verbose&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;verbose = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;costs&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;costs = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;buffers&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;buffers = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;wal&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;wal = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;settings&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;settings = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;generic_plan&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;generic = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;timing&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; timing_set = <span class="Constant">true</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;timing = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;summary&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summary_set = <span class="Constant">true</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;summary = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;memory&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;memory = <a href="define.c.html#L107" title="commands/define.c:107">defGetBoolean</a>(opt);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;serialize&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (opt-&gt;arg)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *p = <a href="define.c.html#L48" title="commands/define.c:48">defGetString</a>(opt);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;off&quot;</span>) == <span class="Constant">0</span> || strcmp(p, <span class="Constant">&quot;<a href="../optimizer/util/predtest.c.html#L1670" title="optimizer/util/predtest.c:1670">none</a>&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;serialize = EXPLAIN_SERIALIZE_NONE;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;text&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;serialize = EXPLAIN_SERIALIZE_TEXT;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;binary&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;serialize = EXPLAIN_SERIALIZE_BINARY;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_INVALID_PARAMETER_VALUE),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;unrecognized value for EXPLAIN option </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">: </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; opt-&gt;defname, p),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../parser/parse_node.c.html#L106" title="parser/parse_node.c:106">parser_errposition</a>(pstate, opt-&gt;location)));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* SERIALIZE without an argument is taken as 'text' */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;serialize = EXPLAIN_SERIALIZE_TEXT;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;format&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *p = <a href="define.c.html#L48" title="commands/define.c:48">defGetString</a>(opt);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;text&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;format = EXPLAIN_FORMAT_TEXT;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;xml&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;format = EXPLAIN_FORMAT_XML;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;json&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;format = EXPLAIN_FORMAT_JSON;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;yaml&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;format = EXPLAIN_FORMAT_YAML;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_INVALID_PARAMETER_VALUE),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;unrecognized value for EXPLAIN option </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">: </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; opt-&gt;defname, p),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../parser/parse_node.c.html#L106" title="parser/parse_node.c:106">parser_errposition</a>(pstate, opt-&gt;location)));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_SYNTAX_ERROR),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;unrecognized EXPLAIN option </span><span class="Special">\&quot;%s\&quot;</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; opt-&gt;defname),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../parser/parse_node.c.html#L106" title="parser/parse_node.c:106">parser_errposition</a>(pstate, opt-&gt;location)));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* check that WAL is used with EXPLAIN ANALYZE */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;wal &amp;&amp; !es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_INVALID_PARAMETER_VALUE),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;EXPLAIN option WAL requires ANALYZE&quot;</span>)));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* if the timing was not set explicitly, set default value */<br/></li>
<li></span>&nbsp; &nbsp; es-&gt;timing = (timing_set) ? es-&gt;timing : es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* check that timing is used with EXPLAIN ANALYZE */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing &amp;&amp; !es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_INVALID_PARAMETER_VALUE),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;EXPLAIN option TIMING requires ANALYZE&quot;</span>)));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* check that serialize is used with EXPLAIN ANALYZE */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;serialize != EXPLAIN_SERIALIZE_NONE &amp;&amp; !es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_INVALID_PARAMETER_VALUE),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;EXPLAIN option SERIALIZE requires ANALYZE&quot;</span>)));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* check that GENERIC_PLAN is not used with EXPLAIN ANALYZE */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;generic &amp;&amp; es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_INVALID_PARAMETER_VALUE),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;EXPLAIN options ANALYZE and GENERIC_PLAN cannot be used together&quot;</span>)));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* if the summary was not set explicitly, set default value */<br/></li>
<li></span>&nbsp; &nbsp; es-&gt;summary = (summary_set) ? es-&gt;summary : es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; query = castNode(Query, stmt-&gt;query);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (IsQueryIdEnabled())<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; jstate = <a href="../nodes/queryjumblefuncs.c.html#L106" title="nodes/queryjumblefuncs.c:106">JumbleQuery</a>(query);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="../parser/analyze.c.html#L58" title="parser/analyze.c:58">post_parse_analyze_hook</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (*<a href="../parser/analyze.c.html#L58" title="parser/analyze.c:58">post_parse_analyze_hook</a>) (pstate, query, jstate);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Parse analysis was done already, but we still have to run the rule<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * rewriter.&nbsp; We do not do <a href="../rewrite/rewriteHandler.c.html#L140" title="rewrite/rewriteHandler.c:140">AcquireRewriteLocks</a>: we assume the query either<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * came straight from the parser, or suitable locks were acquired by<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * plancache.c.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; rewritten = <a href="../rewrite/rewriteHandler.c.html#L4371" title="rewrite/rewriteHandler.c:4371">QueryRewrite</a>(castNode(Query, stmt-&gt;query));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* emit opening boilerplate */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L5116" title="commands/explain.c:5116">ExplainBeginOutput</a>(es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (rewritten == NIL)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * In the case of an INSTEAD NOTHING, tell at least that.&nbsp; But in<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * non-text format, the output is delimited, so this isn't necessary.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;Query rewrites to nothing</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ListCell&nbsp;&nbsp; *l;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Explain every plan */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; foreach(l, rewritten)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L421" title="commands/explain.c:421">ExplainOneQuery</a>(lfirst_node(Query, l),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CURSOR_OPT_PARALLEL_OK, <span class="Constant">NULL</span>, es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pstate-&gt;p_sourcetext, params, pstate-&gt;p_queryEnv);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Separate plans with an appropriate separator */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (lnext(rewritten, l) != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5176" title="commands/explain.c:5176">ExplainSeparatePlans</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* emit closing boilerplate */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L5147" title="commands/explain.c:5147">ExplainEndOutput</a>(es);<br/></li>
<li>&nbsp; &nbsp; Assert(es-&gt;indent == <span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* output tuples */<br/></li>
<li></span>&nbsp; &nbsp; tstate = <a href="../executor/execTuples.c.html#L2342" title="executor/execTuples.c:2342">begin_tup_output_tupdesc</a>(dest, <a href="#L382" title="commands/explain.c:382">ExplainResultDesc</a>(stmt),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;<a href="../executor/execTuples.c.html#L84" title="executor/execTuples.c:84">TTSOpsVirtual</a>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/execTuples.c.html#L2390" title="executor/execTuples.c:2390">do_text_output_multiline</a>(tstate, es-&gt;str-&gt;data);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; do_text_output_oneline(tstate, es-&gt;str-&gt;data);<br/></li>
<li>&nbsp; &nbsp; <a href="../executor/execTuples.c.html#L2420" title="executor/execTuples.c:2420">end_tup_output</a>(tstate);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(es-&gt;str-&gt;data);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Create a new ExplainState struct initialized with default options.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>ExplainState *<br/></li>
<li><a id="L365">&#x200c;</a><span class="linkable">NewExplainState</span>(<span class="Type">void</span>)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ExplainState *es = (ExplainState *) <a href="../utils/mmgr/mcxt.c.html#L1346" title="utils/mmgr/mcxt.c:1346">palloc0</a>(<span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(ExplainState));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set default options (most fields can be left as zeroes). */<br/></li>
<li></span>&nbsp; &nbsp; es-&gt;costs = <span class="Constant">true</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Prepare output buffer. */<br/></li>
<li></span>&nbsp; &nbsp; es-&gt;str = makeStringInfo();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> es;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L382" title="commands/explain.c:382">ExplainResultDesc</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; construct the result tupledesc for an EXPLAIN<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>TupleDesc<br/></li>
<li><a id="L382">&#x200c;</a><span class="linkable">ExplainResultDesc</span>(ExplainStmt *stmt)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; TupleDesc&nbsp; &nbsp; tupdesc;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li>&nbsp; &nbsp; Oid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result_type = TEXTOID;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Check for XML format option */<br/></li>
<li></span>&nbsp; &nbsp; foreach(lc, stmt-&gt;options)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; DefElem&nbsp; &nbsp; *opt = (DefElem *) lfirst(lc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (strcmp(opt-&gt;defname, <span class="Constant">&quot;format&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *p = <a href="define.c.html#L48" title="commands/define.c:48">defGetString</a>(opt);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;xml&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result_type = XMLOID;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (strcmp(p, <span class="Constant">&quot;json&quot;</span>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result_type = JSONOID;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result_type = TEXTOID;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* don't &quot;break&quot;, as <a href="#L176" title="commands/explain.c:176">ExplainQuery</a> will use the last value */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Need a tuple descriptor representing a single TEXT or XML column */<br/></li>
<li></span>&nbsp; &nbsp; tupdesc = <a href="../access/common/tupdesc.c.html#L67" title="access/common/tupdesc.c:67">CreateTemplateTupleDesc</a>(<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <a href="../access/common/tupdesc.c.html#L651" title="access/common/tupdesc.c:651">TupleDescInitEntry</a>(tupdesc, (AttrNumber) <span class="Constant">1</span>, <span class="Constant">&quot;QUERY PLAN&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; result_type, -<span class="Constant">1</span>, <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> tupdesc;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L421" title="commands/explain.c:421">ExplainOneQuery</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> out the execution plan for one Query<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * &quot;into&quot; is NULL unless we are explaining the contents of a CreateTableAsStmt.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L421">&#x200c;</a></span><span class="linkable">ExplainOneQuery</span>(Query *query, <span class="Type">int</span> cursorOptions,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IntoClause *into, ExplainState *es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *queryString, ParamListInfo params,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/misc/queryenvironment.c.html#L32" title="utils/misc/queryenvironment.c:32">QueryEnvironment</a> *queryEnv)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* <a href="../optimizer/plan/planner.c.html#L274" title="optimizer/plan/planner.c:274">planner</a> will not cope with utility statements */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (query-&gt;commandType == CMD_UTILITY)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L520" title="commands/explain.c:520">ExplainOneUtility</a>(query-&gt;utilityStmt, into, es, queryString, params,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queryEnv);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* if an advisor plugin is present, let it manage things */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L45" title="commands/explain.c:45">ExplainOneQuery_hook</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (*<a href="#L45" title="commands/explain.c:45">ExplainOneQuery_hook</a>) (query, cursorOptions, into, es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; queryString, params, queryEnv);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L448" title="commands/explain.c:448">standard_ExplainOneQuery</a>(query, cursorOptions, into, es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; queryString, params, queryEnv);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L448" title="commands/explain.c:448">standard_ExplainOneQuery</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> out the execution plan for one Query, without calling a hook.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L448">&#x200c;</a></span><span class="linkable">standard_ExplainOneQuery</span>(Query *query, <span class="Type">int</span> cursorOptions,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; IntoClause *into, ExplainState *es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">const</span> <span class="Type">char</span> *queryString, ParamListInfo params,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/misc/queryenvironment.c.html#L32" title="utils/misc/queryenvironment.c:32">QueryEnvironment</a> *queryEnv)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; PlannedStmt *plan;<br/></li>
<li>&nbsp; &nbsp; instr_time&nbsp; &nbsp; planstart,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; planduration;<br/></li>
<li>&nbsp; &nbsp; BufferUsage bufusage_start,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bufusage;<br/></li>
<li>&nbsp; &nbsp; MemoryContextCounters mem_counters;<br/></li>
<li>&nbsp; &nbsp; MemoryContext planner_ctx = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; MemoryContext saved_ctx = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;memory)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Create a new memory context to measure <a href="../optimizer/plan/planner.c.html#L274" title="optimizer/plan/planner.c:274">planner</a>'s memory consumption<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * accurately.&nbsp; Note that if the <a href="../optimizer/plan/planner.c.html#L274" title="optimizer/plan/planner.c:274">planner</a> were to be modified to use a<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * different memory context type, here we would be changing that to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * <a href="../utils/mmgr/aset.c.html#L167" title="utils/mmgr/aset.c:167">AllocSet</a>, which might be undesirable.&nbsp; However, we don't have a way<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * to create a context of the same type as another, so we pray and<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * hope that this is OK.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; planner_ctx = AllocSetContextCreate(<a href="../utils/mmgr/mcxt.c.html#L143" title="utils/mmgr/mcxt.c:143">CurrentMemoryContext</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;explain <a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> <a href="../optimizer/plan/planner.c.html#L274" title="optimizer/plan/planner.c:274">planner</a> context&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ALLOCSET_DEFAULT_SIZES);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; saved_ctx = MemoryContextSwitchTo(planner_ctx);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;buffers)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; bufusage_start = <a href="../executor/instrument.c.html#L20" title="executor/instrument.c:20">pgBufferUsage</a>;<br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_SET_CURRENT(planstart);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* plan the query */<br/></li>
<li></span>&nbsp; &nbsp; plan = <a href="../tcop/postgres.c.html#L886" title="tcop/postgres.c:886">pg_plan_query</a>(query, queryString, cursorOptions, params);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_SET_CURRENT(planduration);<br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_SUBTRACT(planduration, planstart);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;memory)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; MemoryContextSwitchTo(saved_ctx);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L786" title="utils/mmgr/mcxt.c:786">MemoryContextMemConsumed</a>(planner_ctx, &amp;mem_counters);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* calc differences of buffer counters. */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;buffers)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; memset(&amp;bufusage, <span class="Constant">0</span>, <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(BufferUsage));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/instrument.c.html#L248" title="executor/instrument.c:248">BufferUsageAccumDiff</a>(&amp;bufusage, &amp;<a href="../executor/instrument.c.html#L20" title="executor/instrument.c:20">pgBufferUsage</a>, &amp;bufusage_start);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* run it (if needed) and produce output */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L610" title="commands/explain.c:610">ExplainOnePlan</a>(plan, into, es, queryString, params, queryEnv,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &amp;planduration, (es-&gt;buffers ? &amp;bufusage : <span class="Constant">NULL</span>),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es-&gt;memory ? &amp;mem_counters : <span class="Constant">NULL</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L520" title="commands/explain.c:520">ExplainOneUtility</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> out the execution plan for one utility statement<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; (In general, utility statements don't have plans, but there are some<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; we treat as special cases)<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * &quot;into&quot; is NULL unless we are explaining the contents of a CreateTableAsStmt.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This is exported because it's called back from prepare.c in the<br/></li>
<li></span><span class="Comment"> * EXPLAIN EXECUTE case.&nbsp; In that case, we'll be dealing with a statement<br/></li>
<li></span><span class="Comment"> * that's in the plan cache, so we have to ensure we don't modify it.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L520">&#x200c;</a></span><span class="linkable">ExplainOneUtility</span>(Node *utilityStmt, IntoClause *into, ExplainState *es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *queryString, ParamListInfo params,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/misc/queryenvironment.c.html#L32" title="utils/misc/queryenvironment.c:32">QueryEnvironment</a> *queryEnv)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (utilityStmt == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (IsA(utilityStmt, CreateTableAsStmt))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * We have to rewrite the contained SELECT and then pass it back to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * <a href="#L421" title="commands/explain.c:421">ExplainOneQuery</a>.&nbsp; Copy to be safe in the EXPLAIN EXECUTE case.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; CreateTableAsStmt *ctas = (CreateTableAsStmt *) utilityStmt;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *rewritten;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Check if the relation exists or not.&nbsp; This is done at this stage to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * avoid query planning or execution.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="createas.c.html#L388" title="commands/createas.c:388">CreateTableAsRelExists</a>(ctas))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (ctas-&gt;objtype == OBJECT_TABLE)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5070" title="commands/explain.c:5070">ExplainDummyGroup</a>(<span class="Constant">&quot;CREATE TABLE AS&quot;</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (ctas-&gt;objtype == OBJECT_MATVIEW)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5070" title="commands/explain.c:5070">ExplainDummyGroup</a>(<span class="Constant">&quot;CREATE MATERIALIZED VIEW&quot;</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elog(ERROR, <span class="Constant">&quot;unexpected object type: </span><span class="Special">%d</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">int</span>) ctas-&gt;objtype);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rewritten = <a href="../rewrite/rewriteHandler.c.html#L4371" title="rewrite/rewriteHandler.c:4371">QueryRewrite</a>(castNode(Query, copyObject(ctas-&gt;query)));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Assert(list_length(rewritten) == <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L421" title="commands/explain.c:421">ExplainOneQuery</a>(linitial_node(Query, rewritten),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CURSOR_OPT_PARALLEL_OK, ctas-&gt;into, es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queryString, params, queryEnv);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (IsA(utilityStmt, DeclareCursorStmt))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Likewise for DECLARE CURSOR.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Notice that if you say EXPLAIN ANALYZE DECLARE CURSOR then we'll<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * actually run the query.&nbsp; This is different from pre-8.3 behavior<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * but seems more useful than not running the query.&nbsp; No cursor will<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * be created, however.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; DeclareCursorStmt *dcs = (DeclareCursorStmt *) utilityStmt;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *rewritten;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rewritten = <a href="../rewrite/rewriteHandler.c.html#L4371" title="rewrite/rewriteHandler.c:4371">QueryRewrite</a>(castNode(Query, copyObject(dcs-&gt;query)));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Assert(list_length(rewritten) == <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L421" title="commands/explain.c:421">ExplainOneQuery</a>(linitial_node(Query, rewritten),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dcs-&gt;options, <span class="Constant">NULL</span>, es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queryString, params, queryEnv);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (IsA(utilityStmt, ExecuteStmt))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="prepare.c.html#L568" title="commands/prepare.c:568">ExplainExecuteQuery</a>((ExecuteStmt *) utilityStmt, into, es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queryString, params, queryEnv);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (IsA(utilityStmt, NotifyStmt))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;NOTIFY</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5070" title="commands/explain.c:5070">ExplainDummyGroup</a>(<span class="Constant">&quot;Notify&quot;</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Utility statements have no plan structure</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5070" title="commands/explain.c:5070">ExplainDummyGroup</a>(<span class="Constant">&quot;Utility Statement&quot;</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L610" title="commands/explain.c:610">ExplainOnePlan</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; given a planned query, execute it if needed, and then <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a><br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; EXPLAIN output<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * &quot;into&quot; is NULL unless we are explaining the contents of a CreateTableAsStmt,<br/></li>
<li></span><span class="Comment"> * in which case executing the query should result in creating that table.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This is exported because it's called back from prepare.c in the<br/></li>
<li></span><span class="Comment"> * EXPLAIN EXECUTE case, and because an index advisor plugin would need<br/></li>
<li></span><span class="Comment"> * to call it.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L610">&#x200c;</a></span><span class="linkable">ExplainOnePlan</span>(PlannedStmt *plannedstmt, IntoClause *into, ExplainState *es,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">const</span> <span class="Type">char</span> *queryString, ParamListInfo params,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/misc/queryenvironment.c.html#L32" title="utils/misc/queryenvironment.c:32">QueryEnvironment</a> *queryEnv, <span class="Type">const</span> instr_time *planduration,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">const</span> BufferUsage *bufusage,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">const</span> MemoryContextCounters *mem_counters)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; DestReceiver *dest;<br/></li>
<li>&nbsp; &nbsp; QueryDesc&nbsp; *queryDesc;<br/></li>
<li>&nbsp; &nbsp; instr_time&nbsp; &nbsp; starttime;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; totaltime = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eflags;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; instrument_option = <span class="Constant">0</span>;<br/></li>
<li>&nbsp; &nbsp; <a href="#L52" title="commands/explain.c:52">SerializeMetrics</a> serializeMetrics = {<span class="Constant">0</span>};<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; Assert(plannedstmt-&gt;commandType != CMD_UTILITY);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; instrument_option |= INSTRUMENT_TIMER;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; instrument_option |= INSTRUMENT_ROWS;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;buffers)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; instrument_option |= INSTRUMENT_BUFFERS;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;wal)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; instrument_option |= INSTRUMENT_WAL;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * We always collect timing for the entire statement, even when node-level<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * timing is off, so we don't look at es-&gt;timing here.&nbsp; (We could <a href="../regex/regc_lex.c.html#L982" title="regex/regc_lex.c:982">skip</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * this if !es-&gt;summary, but it's hardly worth the complication.)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; INSTR_TIME_SET_CURRENT(starttime);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Use a snapshot with an updated command ID to ensure this query sees<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * results of <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> previously executed queries.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <a href="../utils/time/snapmgr.c.html#L700" title="utils/time/snapmgr.c:700">PushCopiedSnapshot</a>(<a href="../utils/time/snapmgr.c.html#L770" title="utils/time/snapmgr.c:770">GetActiveSnapshot</a>());<br/></li>
<li>&nbsp; &nbsp; <a href="../utils/time/snapmgr.c.html#L712" title="utils/time/snapmgr.c:712">UpdateActiveSnapshotCommandId</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * We discard the output if we have no use for it.&nbsp; If we're explaining<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * CREATE TABLE AS, we'd better use the appropriate tuple receiver, while<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * the SERIALIZE option requires its own tuple receiver.&nbsp; (If you specify<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * SERIALIZE while explaining CREATE TABLE AS, you'll see zeroes for the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * results, which is appropriate since no data would have gone to the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * client.)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (into)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; dest = <a href="createas.c.html#L435" title="commands/createas.c:435">CreateIntoRelDestReceiver</a>(into);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (es-&gt;serialize != EXPLAIN_SERIALIZE_NONE)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; dest = <a href="#L5549" title="commands/explain.c:5549">CreateExplainSerializeDestReceiver</a>(es);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; dest = <a href="../tcop/dest.c.html#L96" title="tcop/dest.c:96">None_Receiver</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Create a QueryDesc for the query */<br/></li>
<li></span>&nbsp; &nbsp; queryDesc = <a href="../tcop/pquery.c.html#L67" title="tcop/pquery.c:67">CreateQueryDesc</a>(plannedstmt, queryString,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/time/snapmgr.c.html#L770" title="utils/time/snapmgr.c:770">GetActiveSnapshot</a>(), InvalidSnapshot,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dest, params, queryEnv, instrument_option);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Select execution options */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; eflags = <span class="Constant">0</span>;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* default run-to-completion flags */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; eflags = EXEC_FLAG_EXPLAIN_ONLY;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;generic)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; eflags |= EXEC_FLAG_EXPLAIN_GENERIC;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (into)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; eflags |= <a href="createas.c.html#L370" title="commands/createas.c:370">GetIntoRelEFlags</a>(into);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* call <a href="../executor/execMain.c.html#L124" title="executor/execMain.c:124">ExecutorStart</a> to prepare the plan for execution */<br/></li>
<li></span>&nbsp; &nbsp; <a href="../executor/execMain.c.html#L124" title="executor/execMain.c:124">ExecutorStart</a>(queryDesc, eflags);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Execute the plan for statistics if asked for */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ScanDirection dir;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* EXPLAIN ANALYZE CREATE TABLE AS WITH NO DATA is weird */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (into &amp;&amp; into-&gt;skipData)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dir = NoMovementScanDirection;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dir = ForwardScanDirection;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* run the plan */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/execMain.c.html#L297" title="executor/execMain.c:297">ExecutorRun</a>(queryDesc, dir, <span class="Constant">0</span>, <span class="Constant">true</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* run <a href="../regex/regc_nfa.c.html#L2929" title="regex/regc_nfa.c:2929">cleanup</a> too */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/execMain.c.html#L407" title="executor/execMain.c:407">ExecutorFinish</a>(queryDesc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* We can't run <a href="../executor/execMain.c.html#L467" title="executor/execMain.c:467">ExecutorEnd</a> 'till we're done printing the stats... */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; totaltime += <a href="#L1266" title="commands/explain.c:1266">elapsed_time</a>(&amp;starttime);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* grab serialization metrics <a href="../regex/regc_locale.c.html#L488" title="regex/regc_locale.c:488">before</a> we destroy the DestReceiver */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;serialize != EXPLAIN_SERIALIZE_NONE)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; serializeMetrics = <a href="#L5574" title="commands/explain.c:5574">GetSerializationMetrics</a>(dest);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* call the DestReceiver's destroy method even during explain */<br/></li>
<li></span>&nbsp; &nbsp; dest-&gt;rDestroy(dest);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Query&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Create textual <a href="../regex/regcomp.c.html#L2491" title="regex/regcomp.c:2491">dump</a> of plan tree */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L870" title="commands/explain.c:870">ExplainPrintPlan</a>(es, queryDesc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Show buffer and/or memory usage in planning */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L3696" title="commands/explain.c:3696">peek_buffer_usage</a>(es, bufusage) || mem_counters)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Planning&quot;</span>, <span class="Constant">&quot;Planning&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;Planning:</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (bufusage)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3736" title="commands/explain.c:3736">show_buffer_usage</a>(es, bufusage);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (mem_counters)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3943" title="commands/explain.c:3943">show_memory_counters</a>(es, mem_counters);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Planning&quot;</span>, <span class="Constant">&quot;Planning&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;summary &amp;&amp; planduration)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; plantime = INSTR_TIME_GET_DOUBLE(*planduration);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Planning Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>, <span class="Constant">1000.0</span> * plantime, <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Print info about runtime of triggers */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L935" title="commands/explain.c:935">ExplainPrintTriggers</a>(es, queryDesc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Print info about JITing. Tied to es-&gt;costs because we don't want to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * display this in regression tests, as it'd cause output differences<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * depending on build options.&nbsp; Might want to separate that out from COSTS<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * at a later stage.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;costs)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L978" title="commands/explain.c:978">ExplainPrintJITSummary</a>(es, queryDesc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Print info about serialization of output */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;serialize != EXPLAIN_SERIALIZE_NONE)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1102" title="commands/explain.c:1102">ExplainPrintSerialize</a>(es, &amp;serializeMetrics);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Close down the query and free resources.&nbsp; Include time for this in the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * total execution time (although it should be pretty minimal).<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; INSTR_TIME_SET_CURRENT(starttime);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../executor/execMain.c.html#L467" title="executor/execMain.c:467">ExecutorEnd</a>(queryDesc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../tcop/pquery.c.html#L105" title="tcop/pquery.c:105">FreeQueryDesc</a>(queryDesc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../utils/time/snapmgr.c.html#L743" title="utils/time/snapmgr.c:743">PopActiveSnapshot</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* We need a CCI just in case query expanded to multiple plans */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../access/transam/xact.c.html#L1097" title="access/transam/xact.c:1097">CommandCounterIncrement</a>();<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; totaltime += <a href="#L1266" title="commands/explain.c:1266">elapsed_time</a>(&amp;starttime);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * We only report execution time if we actually ran the query (that is,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * the user specified ANALYZE), and if summary reporting is enabled (the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * user can set SUMMARY <a href="../regex/regexec.c.html#L131" title="regex/regexec.c:131">OFF</a> to not have the timing information included in<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * the output).&nbsp; By default, ANALYZE sets SUMMARY to true.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;summary &amp;&amp; es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Execution Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>, <span class="Constant">1000.0</span> * totaltime, <span class="Constant">3</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Query&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L800" title="commands/explain.c:800">ExplainPrintSettings</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; Print summary of modified settings affecting query planning.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L800">&#x200c;</a></span><span class="linkable">ExplainPrintSettings</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; num;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">struct</span> config_generic **gucs;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* bail out if information about settings not requested */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (!es-&gt;settings)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* request an array of relevant settings */<br/></li>
<li></span>&nbsp; &nbsp; gucs = <a href="../utils/misc/guc.c.html#L5284" title="utils/misc/guc.c:5284">get_explain_guc_options</a>(&amp;num);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Settings&quot;</span>, <span class="Constant">&quot;Settings&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; num; i++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *setting;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">struct</span> config_generic *conf = gucs[i];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setting = <a href="../utils/misc/guc.c.html#L5385" title="utils/misc/guc.c:5385">GetConfigOptionByName</a>(conf-&gt;name, <span class="Constant">NULL</span>, <span class="Constant">true</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(conf-&gt;name, setting, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Settings&quot;</span>, <span class="Constant">&quot;Settings&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; StringInfoData str;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* In TEXT mode, <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> nothing if there are no options */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (num &lt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; initStringInfo(&amp;str);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; num; i++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *setting;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">struct</span> config_generic *conf = gucs[i];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (i &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(&amp;str, <span class="Constant">&quot;, &quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setting = <a href="../utils/misc/guc.c.html#L5385" title="utils/misc/guc.c:5385">GetConfigOptionByName</a>(conf-&gt;name, <span class="Constant">NULL</span>, <span class="Constant">true</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (setting)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(&amp;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> = '</span><span class="Special">%s</span><span class="Constant">'&quot;</span>, conf-&gt;name, setting);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(&amp;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> = NULL&quot;</span>, conf-&gt;name);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Settings&quot;</span>, str.data, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L870" title="commands/explain.c:870">ExplainPrintPlan</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; convert a QueryDesc's plan tree to text and append it to es-&gt;str<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The caller should have set up the options fields of *es, as well as<br/></li>
<li></span><span class="Comment"> * initializing the output buffer es-&gt;str.&nbsp; Also, output formatting state<br/></li>
<li></span><span class="Comment"> * such as the indent level is assumed valid.&nbsp; Plan-tree-specific fields<br/></li>
<li></span><span class="Comment"> * in *es are initialized here.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * NB: will not work on utility statements<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L870">&#x200c;</a></span><span class="linkable">ExplainPrintPlan</span>(ExplainState *es, QueryDesc *queryDesc)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Bitmapset&nbsp; *rels_used = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; PlanState&nbsp; *ps;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set up ExplainState fields associated with this plan tree */<br/></li>
<li></span>&nbsp; &nbsp; Assert(queryDesc-&gt;plannedstmt != <span class="Constant">NULL</span>);<br/></li>
<li>&nbsp; &nbsp; es-&gt;pstmt = queryDesc-&gt;plannedstmt;<br/></li>
<li>&nbsp; &nbsp; es-&gt;rtable = queryDesc-&gt;plannedstmt-&gt;rtable;<br/></li>
<li>&nbsp; &nbsp; <a href="#L1285" title="commands/explain.c:1285">ExplainPreScanNode</a>(queryDesc-&gt;planstate, &amp;rels_used);<br/></li>
<li>&nbsp; &nbsp; es-&gt;rtable_names = <a href="../utils/adt/ruleutils.c.html#L3822" title="utils/adt/ruleutils.c:3822">select_rtable_names_for_explain</a>(es-&gt;rtable, rels_used);<br/></li>
<li>&nbsp; &nbsp; es-&gt;deparse_cxt = <a href="../utils/adt/ruleutils.c.html#L3730" title="utils/adt/ruleutils.c:3730">deparse_context_for_plan_tree</a>(queryDesc-&gt;plannedstmt,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;rtable_names);<br/></li>
<li>&nbsp; &nbsp; es-&gt;printed_subplans = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Sometimes we mark a Gather node as &quot;invisible&quot;, which means that it's<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * not to be displayed in EXPLAIN output.&nbsp; The purpose of this is to allow<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * running regression tests with <a href="../optimizer/plan/planner.c.html#L67" title="optimizer/plan/planner.c:67">debug_parallel_query</a>=regress to get the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * same results as running the same tests with <a href="../optimizer/plan/planner.c.html#L67" title="optimizer/plan/planner.c:67">debug_parallel_query</a>=off.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Such marking is currently only supported on a Gather at the top of the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * plan.&nbsp; We <a href="../regex/regc_lex.c.html#L982" title="regex/regc_lex.c:982">skip</a> that node, and we must also hide per-worker detail data<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * further down in the plan tree.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; ps = queryDesc-&gt;planstate;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (IsA(ps, GatherState) &amp;&amp; ((Gather *) ps-&gt;plan)-&gt;invisible)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ps = outerPlanState(ps);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;hide_workers = <span class="Constant">true</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a>(ps, NIL, <span class="Constant">NULL</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * If requested, include information about GUC parameters with <a href="../bootstrap/bootstrap.c.html#L152" title="bootstrap/bootstrap.c:152">values</a> that<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * don't match the built-in defaults.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L800" title="commands/explain.c:800">ExplainPrintSettings</a>(es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * COMPUTE_QUERY_ID_REGRESS means COMPUTE_QUERY_ID_AUTO, but we don't show<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * the queryid in <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> of the EXPLAIN plans to keep stable the results<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * generated by regression test suites.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;verbose &amp;&amp; queryDesc-&gt;plannedstmt-&gt;queryId != UINT64CONST(<span class="Constant">0</span>) &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../nodes/queryjumblefuncs.c.html#L43" title="nodes/queryjumblefuncs.c:43">compute_query_id</a> != COMPUTE_QUERY_ID_REGRESS)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Output the queryid as an int64 rather than a uint64 so we match<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * what would be seen in the BIGINT pg_stat_statements.queryid column.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Query Identifier&quot;</span>, <span class="Constant">NULL</span>, (int64)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; queryDesc-&gt;plannedstmt-&gt;queryId, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L935" title="commands/explain.c:935">ExplainPrintTriggers</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; convert a QueryDesc's <a href="../utils/adt/pseudotypes.c.html#L366" title="utils/adt/pseudotypes.c:366">trigger</a> statistics to text and append it to<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; es-&gt;str<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The caller should have set up the options fields of *es, as well as<br/></li>
<li></span><span class="Comment"> * initializing the output buffer es-&gt;str.&nbsp; Other fields in *es are<br/></li>
<li></span><span class="Comment"> * initialized here.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L935">&#x200c;</a></span><span class="linkable">ExplainPrintTriggers</span>(ExplainState *es, QueryDesc *queryDesc)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ResultRelInfo *rInfo;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; show_relname;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *resultrels;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *routerels;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *targrels;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *l;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; resultrels = queryDesc-&gt;estate-&gt;es_opened_result_relations;<br/></li>
<li>&nbsp; &nbsp; routerels = queryDesc-&gt;estate-&gt;es_tuple_routing_result_relations;<br/></li>
<li>&nbsp; &nbsp; targrels = queryDesc-&gt;estate-&gt;es_trig_target_relations;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Triggers&quot;</span>, <span class="Constant">&quot;Triggers&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; show_relname = (list_length(resultrels) &gt; <span class="Constant">1</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; routerels != NIL || targrels != NIL);<br/></li>
<li>&nbsp; &nbsp; foreach(l, resultrels)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rInfo = (ResultRelInfo *) lfirst(l);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1195" title="commands/explain.c:1195">report_triggers</a>(rInfo, show_relname, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; foreach(l, routerels)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rInfo = (ResultRelInfo *) lfirst(l);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1195" title="commands/explain.c:1195">report_triggers</a>(rInfo, show_relname, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; foreach(l, targrels)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; rInfo = (ResultRelInfo *) lfirst(l);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1195" title="commands/explain.c:1195">report_triggers</a>(rInfo, show_relname, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Triggers&quot;</span>, <span class="Constant">&quot;Triggers&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L978" title="commands/explain.c:978">ExplainPrintJITSummary</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; Print summarized JIT instrumentation from leader and workers<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L978">&#x200c;</a></span><span class="linkable">ExplainPrintJITSummary</span>(ExplainState *es, QueryDesc *queryDesc)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; JitInstrumentation ji = {<span class="Constant">0</span>};<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (!(queryDesc-&gt;estate-&gt;es_jit_flags &amp; PGJIT_PERFORM))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Work with a copy instead of modifying the leader state, since this<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * function may be called twice<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (queryDesc-&gt;estate-&gt;es_jit)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../jit/jit.c.html#L182" title="jit/jit.c:182">InstrJitAgg</a>(&amp;ji, &amp;queryDesc-&gt;estate-&gt;es_jit-&gt;instr);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* If this process has done JIT in parallel workers, <a href="../lib/pairingheap.c.html#L79" title="lib/pairingheap.c:79">merge</a> stats */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (queryDesc-&gt;estate-&gt;es_jit_worker_instr)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../jit/jit.c.html#L182" title="jit/jit.c:182">InstrJitAgg</a>(&amp;ji, queryDesc-&gt;estate-&gt;es_jit_worker_instr);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L1004" title="commands/explain.c:1004">ExplainPrintJIT</a>(es, queryDesc-&gt;estate-&gt;es_jit_flags, &amp;ji);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L1004" title="commands/explain.c:1004">ExplainPrintJIT</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; Append information about JITing to es-&gt;str.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L1004">&#x200c;</a></span><span class="linkable">ExplainPrintJIT</span>(ExplainState *es, <span class="Type">int</span> jit_flags, JitInstrumentation *ji)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; instr_time&nbsp; &nbsp; total_time;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* don't <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> information if no JITing happened */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (!ji || ji-&gt;created_functions == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* calculate total time */<br/></li>
<li></span>&nbsp; &nbsp; INSTR_TIME_SET_ZERO(total_time);<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* don't add deform_counter, it's included in generation_counter */<br/></li>
<li></span>&nbsp; &nbsp; INSTR_TIME_ADD(total_time, ji-&gt;generation_counter);<br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_ADD(total_time, ji-&gt;inlining_counter);<br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_ADD(total_time, ji-&gt;optimization_counter);<br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_ADD(total_time, ji-&gt;emission_counter);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;JIT&quot;</span>, <span class="Constant">&quot;JIT&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* for higher density, open code the text output format */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;JIT:</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Functions&quot;</span>, <span class="Constant">NULL</span>, ji-&gt;created_functions, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Options: </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%s</span><span class="Constant">, </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%s</span><span class="Constant">, </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%s</span><span class="Constant">, </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%s\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Inlining&quot;</span>, jit_flags &amp; PGJIT_INLINE ? <span class="Constant">&quot;true&quot;</span> : <span class="Constant">&quot;false&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Optimization&quot;</span>, jit_flags &amp; PGJIT_OPT3 ? <span class="Constant">&quot;true&quot;</span> : <span class="Constant">&quot;false&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Expressions&quot;</span>, jit_flags &amp; PGJIT_EXPR ? <span class="Constant">&quot;true&quot;</span> : <span class="Constant">&quot;false&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Deforming&quot;</span>, jit_flags &amp; PGJIT_DEFORM ? <span class="Constant">&quot;true&quot;</span> : <span class="Constant">&quot;false&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Timing: </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%.3f</span><span class="Constant"> ms (</span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%.3f</span><span class="Constant"> ms), </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%.3f</span><span class="Constant"> ms, </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%.3f</span><span class="Constant"> ms, </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%.3f</span><span class="Constant"> ms, </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%.3f</span><span class="Constant"> ms</span><span class="Special">\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Generation&quot;</span>, <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;generation_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Deform&quot;</span>, <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;deform_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Inlining&quot;</span>, <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;inlining_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Optimization&quot;</span>, <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;optimization_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Emission&quot;</span>, <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;emission_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Total&quot;</span>, <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(total_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Functions&quot;</span>, <span class="Constant">NULL</span>, ji-&gt;created_functions, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Options&quot;</span>, <span class="Constant">&quot;Options&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4845" title="commands/explain.c:4845">ExplainPropertyBool</a>(<span class="Constant">&quot;Inlining&quot;</span>, jit_flags &amp; PGJIT_INLINE, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4845" title="commands/explain.c:4845">ExplainPropertyBool</a>(<span class="Constant">&quot;Optimization&quot;</span>, jit_flags &amp; PGJIT_OPT3, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4845" title="commands/explain.c:4845">ExplainPropertyBool</a>(<span class="Constant">&quot;Expressions&quot;</span>, jit_flags &amp; PGJIT_EXPR, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4845" title="commands/explain.c:4845">ExplainPropertyBool</a>(<span class="Constant">&quot;Deforming&quot;</span>, jit_flags &amp; PGJIT_DEFORM, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Options&quot;</span>, <span class="Constant">&quot;Options&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Timing&quot;</span>, <span class="Constant">&quot;Timing&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Generation&quot;</span>, <span class="Constant">&quot;Generation&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Deform&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;deform_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Total&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;generation_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Generation&quot;</span>, <span class="Constant">&quot;Generation&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Inlining&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;inlining_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Optimization&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;optimization_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Emission&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(ji-&gt;emission_counter),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Total&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(total_time),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Timing&quot;</span>, <span class="Constant">&quot;Timing&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;JIT&quot;</span>, <span class="Constant">&quot;JIT&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L1102" title="commands/explain.c:1102">ExplainPrintSerialize</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; Append information about query output volume to es-&gt;str.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L1102">&#x200c;</a></span><span class="linkable">ExplainPrintSerialize</span>(ExplainState *es, <a href="#L52" title="commands/explain.c:52">SerializeMetrics</a> *metrics)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *format;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* We shouldn't get called for EXPLAIN_SERIALIZE_NONE */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;serialize == EXPLAIN_SERIALIZE_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; format = <span class="Constant">&quot;text&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Assert(es-&gt;serialize == EXPLAIN_SERIALIZE_BINARY);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; format = <span class="Constant">&quot;binary&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Serialization&quot;</span>, <span class="Constant">&quot;Serialization&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Serialization: time=</span><span class="Special">%.3f</span><span class="Constant"> ms&nbsp; output=&quot;</span> UINT64_FORMAT <span class="Constant">&quot;kB&nbsp; format=</span><span class="Special">%s\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(metrics-&gt;timeSpent),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (metrics-&gt;bytesSent + <span class="Constant">512</span>) / <span class="Constant">1024</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; format);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Serialization: output=&quot;</span> UINT64_FORMAT <span class="Constant">&quot;kB&nbsp; format=</span><span class="Special">%s\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (metrics-&gt;bytesSent + <span class="Constant">512</span>) / <span class="Constant">1024</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; format);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;buffers &amp;&amp; <a href="#L3696" title="commands/explain.c:3696">peek_buffer_usage</a>(es, &amp;metrics-&gt;bufferUsage))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3736" title="commands/explain.c:3736">show_buffer_usage</a>(es, &amp;metrics-&gt;bufferUsage);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * INSTR_TIME_GET_DOUBLE(metrics-&gt;timeSpent),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4817" title="commands/explain.c:4817">ExplainPropertyUInteger</a>(<span class="Constant">&quot;Output Volume&quot;</span>, <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (metrics-&gt;bytesSent + <span class="Constant">512</span>) / <span class="Constant">1024</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Format&quot;</span>, format, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;buffers)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3736" title="commands/explain.c:3736">show_buffer_usage</a>(es, &amp;metrics-&gt;bufferUsage);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Serialization&quot;</span>, <span class="Constant">&quot;Serialization&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L1162" title="commands/explain.c:1162">ExplainQueryText</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; add a &quot;Query Text&quot; node that contains the actual text of the query<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The caller should have set up the options fields of *es, as well as<br/></li>
<li></span><span class="Comment"> * initializing the output buffer es-&gt;str.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L1162">&#x200c;</a></span><span class="linkable">ExplainQueryText</span>(ExplainState *es, QueryDesc *queryDesc)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (queryDesc-&gt;sourceText)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Query Text&quot;</span>, queryDesc-&gt;sourceText, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L1177" title="commands/explain.c:1177">ExplainQueryParameters</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; add a &quot;Query Parameters&quot; node that describes the parameters of the query<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The caller should have set up the options fields of *es, as well as<br/></li>
<li></span><span class="Comment"> * initializing the output buffer es-&gt;str.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L1177">&#x200c;</a></span><span class="linkable">ExplainQueryParameters</span>(ExplainState *es, ParamListInfo params, <span class="Type">int</span> maxlen)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *str;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* This check is consistent with <a href="../tcop/postgres.c.html#L2475" title="tcop/postgres.c:2475">errdetail_params</a>() */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (params == <span class="Constant">NULL</span> || params-&gt;numParams &lt;= <span class="Constant">0</span> || maxlen == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; str = <a href="../nodes/params.c.html#L335" title="nodes/params.c:335">BuildParamLogString</a>(params, <span class="Constant">NULL</span>, maxlen);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (str &amp;&amp; str[<span class="Constant">0</span>] != <span class="Special">'\0'</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Query Parameters&quot;</span>, str, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L1195" title="commands/explain.c:1195">report_triggers</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; &nbsp; report execution stats for a single relation's triggers<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L1195">&#x200c;</a></span><span class="linkable">report_triggers</span>(ResultRelInfo *rInfo, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> show_relname, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nt;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (!rInfo-&gt;ri_TrigDesc || !rInfo-&gt;ri_TrigInstrument)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (nt = <span class="Constant">0</span>; nt &lt; rInfo-&gt;ri_TrigDesc-&gt;numtriggers; nt++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Trigger&nbsp; &nbsp; *trig = rInfo-&gt;ri_TrigDesc-&gt;triggers + nt;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Instrumentation *instr = rInfo-&gt;ri_TrigInstrument + nt;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *relname;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *conname = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Must clean up instrumentation state */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/instrument.c.html#L140" title="executor/instrument.c:140">InstrEndLoop</a>(instr);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * We ignore triggers that were never invoked; they likely aren't<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * relevant to the current query type.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (instr-&gt;ntuples == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Trigger&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; relname = RelationGetRelationName(rInfo-&gt;ri_RelationDesc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (OidIsValid(trig-&gt;tgconstraint))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conname = <a href="../utils/cache/lsyscache.c.html#L1081" title="utils/cache/lsyscache.c:1081">get_constraint_name</a>(trig-&gt;tgconstraint);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * In text format, we avoid printing both the <a href="../utils/adt/pseudotypes.c.html#L366" title="utils/adt/pseudotypes.c:366">trigger</a> name and the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * constraint name unless VERBOSE is specified.&nbsp; In non-text formats<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * we just <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> everything.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;verbose || conname == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Trigger </span><span class="Special">%s</span><span class="Constant">&quot;</span>, trig-&gt;tgname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;Trigger&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (conname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; for constraint </span><span class="Special">%s</span><span class="Constant">&quot;</span>, conname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (show_relname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; on </span><span class="Special">%s</span><span class="Constant">&quot;</span>, relname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;: time=</span><span class="Special">%.3f</span><span class="Constant"> calls=</span><span class="Special">%.0f\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">1000.0</span> * instr-&gt;total, instr-&gt;ntuples);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;: calls=</span><span class="Special">%.0f\n</span><span class="Constant">&quot;</span>, instr-&gt;ntuples);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Trigger Name&quot;</span>, trig-&gt;tgname, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (conname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Constraint Name&quot;</span>, conname, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Relation&quot;</span>, relname, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>, <span class="Constant">1000.0</span> * instr-&gt;total, <span class="Constant">3</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Calls&quot;</span>, <span class="Constant">NULL</span>, instr-&gt;ntuples, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (conname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(conname);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Trigger&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/* Compute elapsed time in seconds since given timestamp */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">double<br/></li>
<li><a id="L1266">&#x200c;</a></span><span class="linkable">elapsed_time</span>(instr_time *starttime)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; instr_time&nbsp; &nbsp; endtime;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_SET_CURRENT(endtime);<br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_SUBTRACT(endtime, *starttime);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> INSTR_TIME_GET_DOUBLE(endtime);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L1285" title="commands/explain.c:1285">ExplainPreScanNode</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; Prescan the planstate tree to identify which RTEs are referenced<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Adds the relid of each referenced RTE to *rels_used.&nbsp; The result controls<br/></li>
<li></span><span class="Comment"> * which RTEs are assigned aliases by <a href="../utils/adt/ruleutils.c.html#L3822" title="utils/adt/ruleutils.c:3822">select_rtable_names_for_explain</a>.<br/></li>
<li></span><span class="Comment"> * This ensures that we don't confusingly assign un-suffixed aliases to RTEs<br/></li>
<li></span><span class="Comment"> * that never appear in the EXPLAIN output (such as inheritance parents).<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a><br/></li>
<li><a id="L1285">&#x200c;</a></span><span class="linkable">ExplainPreScanNode</span>(PlanState *planstate, Bitmapset **rels_used)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Plan&nbsp; &nbsp; &nbsp;&nbsp; *plan = planstate-&gt;plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (nodeTag(plan))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SeqScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SampleScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexOnlyScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapHeapScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidRangeScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SubqueryScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_FunctionScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TableFuncScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ValuesScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CteScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_NamedTuplestoreScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_WorkTableScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *rels_used = <a href="../nodes/bitmapset.c.html#L815" title="nodes/bitmapset.c:815">bms_add_member</a>(*rels_used,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((Scan *) plan)-&gt;scanrelid);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ForeignScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *rels_used = <a href="../nodes/bitmapset.c.html#L917" title="nodes/bitmapset.c:917">bms_add_members</a>(*rels_used,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((ForeignScan *) plan)-&gt;fs_base_relids);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CustomScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *rels_used = <a href="../nodes/bitmapset.c.html#L917" title="nodes/bitmapset.c:917">bms_add_members</a>(*rels_used,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((CustomScan *) plan)-&gt;custom_relids);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ModifyTable:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *rels_used = <a href="../nodes/bitmapset.c.html#L815" title="nodes/bitmapset.c:815">bms_add_member</a>(*rels_used,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((ModifyTable *) plan)-&gt;nominalRelation);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((ModifyTable *) plan)-&gt;exclRelRTI)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *rels_used = <a href="../nodes/bitmapset.c.html#L815" title="nodes/bitmapset.c:815">bms_add_member</a>(*rels_used,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((ModifyTable *) plan)-&gt;exclRelRTI);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Append:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *rels_used = <a href="../nodes/bitmapset.c.html#L917" title="nodes/bitmapset.c:917">bms_add_members</a>(*rels_used,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((Append *) plan)-&gt;apprelids);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeAppend:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *rels_used = <a href="../nodes/bitmapset.c.html#L917" title="nodes/bitmapset.c:917">bms_add_members</a>(*rels_used,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((MergeAppend *) plan)-&gt;apprelids);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> planstate_tree_walker(planstate, <a href="#L1285" title="commands/explain.c:1285">ExplainPreScanNode</a>, rels_used);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a> -<br/></li>
<li></span><span class="Comment"> *&nbsp; &nbsp; &nbsp; Appends a description of a plan tree to es-&gt;str<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * planstate points to the executor state node for the current plan node.<br/></li>
<li></span><span class="Comment"> * We need to work from a PlanState node, not just a Plan node, in order to<br/></li>
<li></span><span class="Comment"> * get at the instrumentation data (if <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a>) as well as the list of subplans.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * ancestors is a list of parent Plan and SubPlan nodes, most-closely-nested<br/></li>
<li></span><span class="Comment"> * first.&nbsp; These are needed in order to interpret PARAM_EXEC Params.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * relationship describes the relationship of this plan node to its parent<br/></li>
<li></span><span class="Comment"> * (eg, &quot;Outer&quot;, &quot;Inner&quot;); it can be null at top level.&nbsp; plan_name is an<br/></li>
<li></span><span class="Comment"> * optional name to be attached to the node.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * In text format, es-&gt;indent is controlled in this function since we only<br/></li>
<li></span><span class="Comment"> * want it to change at plan-node boundaries (but a few subroutines will<br/></li>
<li></span><span class="Comment"> * transiently increment it).&nbsp; In non-text formats, es-&gt;indent corresponds<br/></li>
<li></span><span class="Comment"> * to the nesting depth of logical output groups, and therefore is controlled<br/></li>
<li></span><span class="Comment"> * by <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>/<a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L1360">&#x200c;</a></span><span class="linkable">ExplainNode</span>(PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *relationship, <span class="Type">const</span> <span class="Type">char</span> *plan_name,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Plan&nbsp; &nbsp; &nbsp;&nbsp; *plan = planstate-&gt;plan;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *pname;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* node type name for text output */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *sname;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* node type name for non-text output */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *strategy = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *partialmode = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *operation = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *custom_name = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; ExplainWorkersState *save_workers_state = es-&gt;workers_state;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; save_indent = es-&gt;indent;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; haschildren;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Prepare per-worker output buffers, if needed.&nbsp; We'll append the data in<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * these to the <a href="../storage/lmgr/s_lock.c.html#L257" title="storage/lmgr/s_lock.c:257">main</a> output string further down.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (planstate-&gt;worker_instrument &amp;&amp; es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; !es-&gt;hide_workers)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;workers_state = <a href="#L4474" title="commands/explain.c:4474">ExplainCreateWorkersState</a>(planstate-&gt;worker_instrument-&gt;num_workers);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;workers_state = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Identify plan node type, and <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> generic details */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">switch</span> (nodeTag(plan))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Result:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Result&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ProjectSet:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;ProjectSet&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ModifyTable:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sname = <span class="Constant">&quot;ModifyTable&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (((ModifyTable *) plan)-&gt;operation)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_INSERT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = operation = <span class="Constant">&quot;<a href="../storage/file/fd.c.html#L1313" title="storage/file/fd.c:1313">Insert</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_UPDATE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = operation = <span class="Constant">&quot;Update&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_DELETE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = operation = <span class="Constant">&quot;<a href="../storage/file/fd.c.html#L1268" title="storage/file/fd.c:1268">Delete</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_MERGE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = operation = <span class="Constant">&quot;Merge&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Append:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Append&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeAppend:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Merge Append&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_RecursiveUnion:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Recursive Union&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapAnd:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;BitmapAnd&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapOr:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;BitmapOr&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_NestLoop:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Nested Loop&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeJoin:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;Merge&quot;</span>;&nbsp; &nbsp; <span class="Comment">/* &quot;Join&quot; gets added by jointype switch */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sname = <span class="Constant">&quot;Merge Join&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_HashJoin:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;Hash&quot;</span>;&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* &quot;Join&quot; gets added by jointype switch */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sname = <span class="Constant">&quot;Hash Join&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SeqScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Seq Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SampleScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Sample Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Gather:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Gather&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_GatherMerge:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Gather Merge&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Index Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexOnlyScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Index Only Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapIndexScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Bitmap Index Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapHeapScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Bitmap Heap Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Tid Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidRangeScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Tid <a href="../utils/adt/geo_spgist.c.html#L107" title="utils/adt/geo_spgist.c:107">Range</a> Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SubqueryScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Subquery Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_FunctionScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Function Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TableFuncScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Table Function Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ValuesScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Values Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CteScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;CTE Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_NamedTuplestoreScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Named Tuplestore Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_WorkTableScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;WorkTable Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ForeignScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sname = <span class="Constant">&quot;Foreign Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (((ForeignScan *) plan)-&gt;operation)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_SELECT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;Foreign Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;Select&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_INSERT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;Foreign <a href="../storage/file/fd.c.html#L1313" title="storage/file/fd.c:1313">Insert</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;<a href="../storage/file/fd.c.html#L1313" title="storage/file/fd.c:1313">Insert</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_UPDATE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;Foreign Update&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;Update&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_DELETE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;Foreign <a href="../storage/file/fd.c.html#L1268" title="storage/file/fd.c:1268">Delete</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;<a href="../storage/file/fd.c.html#L1268" title="storage/file/fd.c:1268">Delete</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CustomScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sname = <span class="Constant">&quot;Custom Scan&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; custom_name = ((CustomScan *) plan)-&gt;methods-&gt;CustomName;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (custom_name)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = psprintf(<span class="Constant">&quot;Custom Scan (</span><span class="Special">%s</span><span class="Constant">)&quot;</span>, custom_name);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Material:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Materialize&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Memoize:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Memoize&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Sort:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Sort&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IncrementalSort:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Incremental Sort&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Group:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Group&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Agg:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Agg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *agg = (Agg *) plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sname = <span class="Constant">&quot;Aggregate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (agg-&gt;aggstrategy)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> AGG_PLAIN:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;Aggregate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strategy = <span class="Constant">&quot;Plain&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> AGG_SORTED:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;GroupAggregate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strategy = <span class="Constant">&quot;Sorted&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> AGG_HASHED:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;HashAggregate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strategy = <span class="Constant">&quot;Hashed&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> AGG_MIXED:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;MixedAggregate&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strategy = <span class="Constant">&quot;Mixed&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;Aggregate ???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strategy = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (DO_AGGSPLIT_SKIPFINAL(agg-&gt;aggsplit))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; partialmode = <span class="Constant">&quot;Partial&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = psprintf(<span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%s</span><span class="Constant">&quot;</span>, partialmode, pname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (DO_AGGSPLIT_COMBINE(agg-&gt;aggsplit))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; partialmode = <span class="Constant">&quot;Finalize&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = psprintf(<span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%s</span><span class="Constant">&quot;</span>, partialmode, pname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; partialmode = <span class="Constant">&quot;Simple&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_WindowAgg:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;WindowAgg&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Unique:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Unique&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SetOp:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sname = <span class="Constant">&quot;SetOp&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (((SetOp *) plan)-&gt;strategy)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> SETOP_SORTED:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;SetOp&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strategy = <span class="Constant">&quot;Sorted&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> SETOP_HASHED:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;HashSetOp&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strategy = <span class="Constant">&quot;Hashed&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = <span class="Constant">&quot;SetOp ???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strategy = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_LockRows:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;LockRows&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Limit:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Limit&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Hash:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;Hash&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pname = sname = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Plan&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; relationship ? <span class="Constant">NULL</span> : <span class="Constant">&quot;Plan&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan_name)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">%s\n</span><span class="Constant">&quot;</span>, plan_name);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;indent)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;-&gt;&nbsp; &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent += <span class="Constant">2</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;parallel_aware)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;Parallel &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;async_capable)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;Async &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, pname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Node Type&quot;</span>, sname, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (strategy)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Strategy&quot;</span>, strategy, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (partialmode)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Partial <a href="../utils/init/miscinit.c.html#L61" title="utils/init/miscinit.c:61">Mode</a>&quot;</span>, partialmode, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (operation)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Operation&quot;</span>, operation, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (relationship)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Parent Relationship&quot;</span>, relationship, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan_name)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Subplan Name&quot;</span>, plan_name, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (custom_name)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Custom Plan Provider&quot;</span>, custom_name, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4845" title="commands/explain.c:4845">ExplainPropertyBool</a>(<span class="Constant">&quot;Parallel Aware&quot;</span>, plan-&gt;parallel_aware, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4845" title="commands/explain.c:4845">ExplainPropertyBool</a>(<span class="Constant">&quot;Async Capable&quot;</span>, plan-&gt;async_capable, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (nodeTag(plan))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SeqScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SampleScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapHeapScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidRangeScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SubqueryScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_FunctionScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TableFuncScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ValuesScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CteScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_WorkTableScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4005" title="commands/explain.c:4005">ExplainScanTarget</a>((Scan *) plan, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ForeignScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CustomScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((Scan *) plan)-&gt;scanrelid &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4005" title="commands/explain.c:4005">ExplainScanTarget</a>((Scan *) plan, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IndexScan&nbsp; *indexscan = (IndexScan *) plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3969" title="commands/explain.c:3969">ExplainIndexScanDetails</a>(indexscan-&gt;indexid,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; indexscan-&gt;indexorderdir,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4005" title="commands/explain.c:4005">ExplainScanTarget</a>((Scan *) indexscan, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexOnlyScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IndexOnlyScan *indexonlyscan = (IndexOnlyScan *) plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3969" title="commands/explain.c:3969">ExplainIndexScanDetails</a>(indexonlyscan-&gt;indexid,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; indexonlyscan-&gt;indexorderdir,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4005" title="commands/explain.c:4005">ExplainScanTarget</a>((Scan *) indexonlyscan, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapIndexScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BitmapIndexScan *bitmapindexscan = (BitmapIndexScan *) plan;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *indexname =<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3672" title="commands/explain.c:3672">explain_get_index_name</a>(bitmapindexscan-&gt;indexid);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; on </span><span class="Special">%s</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/adt/ruleutils.c.html#L12623" title="utils/adt/ruleutils.c:12623">quote_identifier</a>(indexname));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Index Name&quot;</span>, indexname, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ModifyTable:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4018" title="commands/explain.c:4018">ExplainModifyTarget</a>((ModifyTable *) plan, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_NestLoop:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeJoin:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_HashJoin:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *jointype;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (((Join *) plan)-&gt;jointype)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> JOIN_INNER:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jointype = <span class="Constant">&quot;Inner&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> JOIN_LEFT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jointype = <span class="Constant">&quot;Left&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> JOIN_FULL:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jointype = <span class="Constant">&quot;Full&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> JOIN_RIGHT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jointype = <span class="Constant">&quot;Right&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> JOIN_SEMI:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jointype = <span class="Constant">&quot;Semi&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> JOIN_ANTI:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jointype = <span class="Constant">&quot;Anti&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> JOIN_RIGHT_ANTI:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jointype = <span class="Constant">&quot;Right Anti&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jointype = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * For historical reasons, the join type is interpolated<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * into the node type name...<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((Join *) plan)-&gt;jointype != JOIN_INNER)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant"> Join&quot;</span>, jointype);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (!IsA(plan, NestLoop))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; Join&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Join Type&quot;</span>, jointype, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SetOp:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *setopcmd;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (((SetOp *) plan)-&gt;cmd)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> SETOPCMD_INTERSECT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setopcmd = <span class="Constant">&quot;Intersect&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> SETOPCMD_INTERSECT_ALL:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setopcmd = <span class="Constant">&quot;Intersect All&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> SETOPCMD_EXCEPT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setopcmd = <span class="Constant">&quot;Except&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> SETOPCMD_EXCEPT_ALL:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setopcmd = <span class="Constant">&quot;Except All&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setopcmd = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant">&quot;</span>, setopcmd);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Command&quot;</span>, setopcmd, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;costs)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;&nbsp; (cost=</span><span class="Special">%.2f</span><span class="Constant">..</span><span class="Special">%.2f</span><span class="Constant"> rows=</span><span class="Special">%.0f</span><span class="Constant"> width=</span><span class="Special">%d</span><span class="Constant">)&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;startup_cost, plan-&gt;total_cost,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;plan_rows, plan-&gt;plan_width);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Startup Cost&quot;</span>, <span class="Constant">NULL</span>, plan-&gt;startup_cost,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">2</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Total Cost&quot;</span>, <span class="Constant">NULL</span>, plan-&gt;total_cost,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">2</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Plan Rows&quot;</span>, <span class="Constant">NULL</span>, plan-&gt;plan_rows,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Plan Width&quot;</span>, <span class="Constant">NULL</span>, plan-&gt;plan_width,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * We have to forcibly clean up the instrumentation state because we<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * haven't done <a href="../executor/execMain.c.html#L467" title="executor/execMain.c:467">ExecutorEnd</a> yet.&nbsp; This is pretty grotty ...<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Note: contrib/auto_explain could cause instrumentation to be set up<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * even though we didn't ask for it here.&nbsp; Be careful not to <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * instrumentation results the user didn't ask for.&nbsp; But we do the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * <a href="../executor/instrument.c.html#L140" title="executor/instrument.c:140">InstrEndLoop</a> call anyway, if possible, to reduce the number of cases<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * auto_explain has to contend with.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (planstate-&gt;instrument)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/instrument.c.html#L140" title="executor/instrument.c:140">InstrEndLoop</a>(planstate-&gt;instrument);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; planstate-&gt;instrument &amp;&amp; planstate-&gt;instrument-&gt;nloops &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; nloops = planstate-&gt;instrument-&gt;nloops;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; startup_ms = <span class="Constant">1000.0</span> * planstate-&gt;instrument-&gt;startup / nloops;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; total_ms = <span class="Constant">1000.0</span> * planstate-&gt;instrument-&gt;total / nloops;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; rows = planstate-&gt;instrument-&gt;ntuples / nloops;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot; (actual time=</span><span class="Special">%.3f</span><span class="Constant">..</span><span class="Special">%.3f</span><span class="Constant"> rows=</span><span class="Special">%.0f</span><span class="Constant"> loops=</span><span class="Special">%.0f</span><span class="Constant">)&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; startup_ms, total_ms, rows, nloops);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot; (actual rows=</span><span class="Special">%.0f</span><span class="Constant"> loops=</span><span class="Special">%.0f</span><span class="Constant">)&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; rows, nloops);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Startup Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>, startup_ms,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Total Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>, total_ms,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Rows&quot;</span>, <span class="Constant">NULL</span>, rows, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Loops&quot;</span>, <span class="Constant">NULL</span>, nloops, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; (never executed)&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Startup Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>, <span class="Constant">0.0</span>, <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Total Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>, <span class="Constant">0.0</span>, <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Rows&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">0.0</span>, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Loops&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">0.0</span>, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* in text format, first line ends here */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* prepare per-worker general execution details */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state &amp;&amp; es-&gt;verbose)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; WorkerInstrumentation *w = planstate-&gt;worker_instrument;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> n = <span class="Constant">0</span>; n &lt; w-&gt;num_workers; n++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Instrumentation *instrument = &amp;w-&gt;instrument[n];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; nloops = instrument-&gt;nloops;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; startup_ms;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; total_ms;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; rows;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (nloops &lt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; startup_ms = <span class="Constant">1000.0</span> * instrument-&gt;startup / nloops;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total_ms = <span class="Constant">1000.0</span> * instrument-&gt;total / nloops;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rows = instrument-&gt;ntuples / nloops;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(n, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;actual time=</span><span class="Special">%.3f</span><span class="Constant">..</span><span class="Special">%.3f</span><span class="Constant"> rows=</span><span class="Special">%.0f</span><span class="Constant"> loops=</span><span class="Special">%.0f\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; startup_ms, total_ms, rows, nloops);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;actual rows=</span><span class="Special">%.0f</span><span class="Constant"> loops=</span><span class="Special">%.0f\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; rows, nloops);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Startup Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; startup_ms, <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Total Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; total_ms, <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Rows&quot;</span>, <span class="Constant">NULL</span>, rows, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Actual Loops&quot;</span>, <span class="Constant">NULL</span>, nloops, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* target list */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;verbose)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2422" title="commands/explain.c:2422">show_plan_tlist</a>(planstate, ancestors, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* unique join */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">switch</span> (nodeTag(plan))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_NestLoop:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeJoin:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_HashJoin:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* try not to be too chatty about this in text mode */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (es-&gt;verbose &amp;&amp; ((Join *) plan)-&gt;inner_unique))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4845" title="commands/explain.c:4845">ExplainPropertyBool</a>(<span class="Constant">&quot;Inner Unique&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((Join *) plan)-&gt;inner_unique,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* quals, sort keys, etc */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">switch</span> (nodeTag(plan))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(((IndexScan *) plan)-&gt;indexqualorig,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Index Cond&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((IndexScan *) plan)-&gt;indexqualorig)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Index Recheck&quot;</span>, <span class="Constant">2</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(((IndexScan *) plan)-&gt;indexorderbyorig,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Order By&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexOnlyScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(((IndexOnlyScan *) plan)-&gt;indexqual,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Index Cond&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((IndexOnlyScan *) plan)-&gt;recheckqual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Index Recheck&quot;</span>, <span class="Constant">2</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(((IndexOnlyScan *) plan)-&gt;indexorderby,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Order By&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Heap Fetches&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate-&gt;instrument-&gt;ntuples2, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapIndexScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(((BitmapIndexScan *) plan)-&gt;indexqualorig,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Index Cond&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapHeapScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(((BitmapHeapScan *) plan)-&gt;bitmapqualorig,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Recheck Cond&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((BitmapHeapScan *) plan)-&gt;bitmapqualorig)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Index Recheck&quot;</span>, <span class="Constant">2</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3585" title="commands/explain.c:3585">show_tidbitmap_info</a>((BitmapHeapScanState *) planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SampleScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2872" title="commands/explain.c:2872">show_tablesample</a>(((SampleScan *) plan)-&gt;tablesample,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* fall through to <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> additional fields the same as SeqScan */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* FALLTHROUGH */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SeqScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ValuesScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CteScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_NamedTuplestoreScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_WorkTableScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SubqueryScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Gather:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Gather&nbsp; &nbsp; &nbsp;&nbsp; *gather = (Gather *) plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Workers Planned&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; gather-&gt;num_workers, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nworkers;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nworkers = ((GatherState *) planstate)-&gt;nworkers_launched;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Workers Launched&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; nworkers, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (gather-&gt;single_copy || es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4845" title="commands/explain.c:4845">ExplainPropertyBool</a>(<span class="Constant">&quot;Single Copy&quot;</span>, gather-&gt;single_copy, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_GatherMerge:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GatherMerge *gm = (GatherMerge *) plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Workers Planned&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; gm-&gt;num_workers, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nworkers;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nworkers = ((GatherMergeState *) planstate)-&gt;nworkers_launched;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Workers Launched&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; nworkers, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_FunctionScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;verbose)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *fexprs = NIL;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(lc, ((FunctionScan *) plan)-&gt;<a href="../regex/regcomp.c.html#L356" title="regex/regcomp.c:356">functions</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RangeTblFunction *rtfunc = (RangeTblFunction *) lfirst(lc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fexprs = <a href="../nodes/list.c.html#L339" title="nodes/list.c:339">lappend</a>(fexprs, rtfunc-&gt;funcexpr);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* We rely on <a href="#L2480" title="commands/explain.c:2480">show_expression</a> to insert commas as needed */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2480" title="commands/explain.c:2480">show_expression</a>((Node *) fexprs,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Function Call&quot;</span>, planstate, ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;verbose, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TableFuncScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;verbose)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TableFunc&nbsp; *tablefunc = ((TableFuncScan *) plan)-&gt;tablefunc;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2480" title="commands/explain.c:2480">show_expression</a>((Node *) tablefunc,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Table Function Call&quot;</span>, planstate, ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;verbose, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * The tidquals list has OR semantics, so be sure to show it<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * as an OR condition.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *tidquals = ((TidScan *) plan)-&gt;tidquals;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (list_length(tidquals) &gt; <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tidquals = list_make1(<a href="../nodes/makefuncs.c.html#L670" title="nodes/makefuncs.c:670">make_orclause</a>(tidquals));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(tidquals, <span class="Constant">&quot;TID Cond&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidRangeScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * The tidrangequals list has AND semantics, so be sure to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * show it as an AND condition.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *tidquals = ((TidRangeScan *) plan)-&gt;tidrangequals;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (list_length(tidquals) &gt; <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tidquals = list_make1(<a href="../nodes/makefuncs.c.html#L654" title="nodes/makefuncs.c:654">make_andclause</a>(tidquals));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(tidquals, <span class="Constant">&quot;TID Cond&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ForeignScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3644" title="commands/explain.c:3644">show_foreignscan_info</a>((ForeignScanState *) planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CustomScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CustomScanState *css = (CustomScanState *) planstate;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2524" title="commands/explain.c:2524">show_scan_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (css-&gt;methods-&gt;ExplainCustomScan)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; css-&gt;methods-&gt;ExplainCustomScan(css, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_NestLoop:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(((NestLoop *) plan)-&gt;join.joinqual,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Join Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((NestLoop *) plan)-&gt;join.joinqual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Join Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">2</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeJoin:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(((MergeJoin *) plan)-&gt;mergeclauses,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Merge Cond&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(((MergeJoin *) plan)-&gt;join.joinqual,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Join Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((MergeJoin *) plan)-&gt;join.joinqual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Join Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">2</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_HashJoin:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(((HashJoin *) plan)-&gt;hashclauses,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Hash Cond&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(((HashJoin *) plan)-&gt;join.joinqual,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Join Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (((HashJoin *) plan)-&gt;join.joinqual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Join Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">2</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Agg:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2600" title="commands/explain.c:2600">show_agg_keys</a>(castNode(AggState, planstate), ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3464" title="commands/explain.c:3464">show_hashagg_info</a>((AggState *) planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_WindowAgg:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(((WindowAgg *) plan)-&gt;runConditionOrig,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Run Condition&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Group:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2732" title="commands/explain.c:2732">show_group_keys</a>(castNode(GroupState, planstate), ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Sort:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2552" title="commands/explain.c:2552">show_sort_keys</a>(castNode(SortState, planstate), ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2938" title="commands/explain.c:2938">show_sort_info</a>(castNode(SortState, planstate), es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IncrementalSort:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2567" title="commands/explain.c:2567">show_incremental_sort_keys</a>(castNode(IncrementalSortState, planstate),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3143" title="commands/explain.c:3143">show_incremental_sort_info</a>(castNode(IncrementalSortState, planstate),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeAppend:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2584" title="commands/explain.c:2584">show_merge_append_keys</a>(castNode(MergeAppendState, planstate),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Result:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>((List *) ((Result *) plan)-&gt;resconstantqual,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;One-Time Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>(plan-&gt;qual, <span class="Constant">&quot;Filter&quot;</span>, planstate, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;qual)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Filter&quot;</span>, <span class="Constant">1</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ModifyTable:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4165" title="commands/explain.c:4165">show_modifytable_info</a>(castNode(ModifyTableState, planstate), ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Hash:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3229" title="commands/explain.c:3229">show_hash_info</a>(castNode(HashState, planstate), es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Memoize:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3320" title="commands/explain.c:3320">show_memoize_info</a>(castNode(MemoizeState, planstate), ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Prepare per-worker JIT instrumentation.&nbsp; As with the overall JIT<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * summary, this is printed only if printing costs is enabled.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state &amp;&amp; es-&gt;costs &amp;&amp; es-&gt;verbose)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; SharedJitInstrumentation *w = planstate-&gt;worker_jit_instrument;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (w)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> n = <span class="Constant">0</span>; n &lt; w-&gt;num_workers; n++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1004" title="commands/explain.c:1004">ExplainPrintJIT</a>(es, planstate-&gt;state-&gt;es_jit_flags,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;w-&gt;jit_instr[n]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Show buffer/WAL usage */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;buffers &amp;&amp; planstate-&gt;instrument)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3736" title="commands/explain.c:3736">show_buffer_usage</a>(es, &amp;planstate-&gt;instrument-&gt;bufusage);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;wal &amp;&amp; planstate-&gt;instrument)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3905" title="commands/explain.c:3905">show_wal_usage</a>(es, &amp;planstate-&gt;instrument-&gt;walusage);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Prepare per-worker buffer/WAL usage */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state &amp;&amp; (es-&gt;buffers || es-&gt;wal) &amp;&amp; es-&gt;verbose)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; WorkerInstrumentation *w = planstate-&gt;worker_instrument;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> n = <span class="Constant">0</span>; n &lt; w-&gt;num_workers; n++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Instrumentation *instrument = &amp;w-&gt;instrument[n];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; nloops = instrument-&gt;nloops;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (nloops &lt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;buffers)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3736" title="commands/explain.c:3736">show_buffer_usage</a>(es, &amp;instrument-&gt;bufusage);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;wal)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3905" title="commands/explain.c:3905">show_wal_usage</a>(es, &amp;instrument-&gt;walusage);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Show per-worker details for this plan node, then pop that stack */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4589" title="commands/explain.c:4589">ExplainFlushWorkersState</a>(es);<br/></li>
<li>&nbsp; &nbsp; es-&gt;workers_state = save_workers_state;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * If partition pruning was done during executor initialization, the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * number of child plans we'll display below will be less than the number<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * of subplans that was specified in the plan.&nbsp; To make this a <a href="../utils/adt/varbit.c.html#L391" title="utils/adt/varbit.c:391">bit</a> less<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * mysterious, emit an indication that this happened.&nbsp; Note that this<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * field is emitted <a href="../utils/adt/timestamp.c.html#L1618" title="utils/adt/timestamp.c:1618">now</a> because we want it to be a property of the parent<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * node; it *cannot* be emitted within the Plans sub-node we'll open <a href="../regex/regc_lex.c.html#L200" title="regex/regc_lex.c:200">next</a>.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">switch</span> (nodeTag(plan))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Append:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4395" title="commands/explain.c:4395">ExplainMissingMembers</a>(((AppendState *) planstate)-&gt;as_nplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list_length(((Append *) plan)-&gt;appendplans),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeAppend:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4395" title="commands/explain.c:4395">ExplainMissingMembers</a>(((MergeAppendState *) planstate)-&gt;ms_nplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list_length(((MergeAppend *) plan)-&gt;mergeplans),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Get ready to display the child plans */<br/></li>
<li></span>&nbsp; &nbsp; haschildren = planstate-&gt;initPlan ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; outerPlanState(planstate) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; innerPlanState(planstate) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; IsA(plan, Append) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; IsA(plan, MergeAppend) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; IsA(plan, BitmapAnd) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; IsA(plan, BitmapOr) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; IsA(plan, SubqueryScan) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (IsA(planstate, CustomScanState) &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((CustomScanState *) planstate)-&gt;custom_ps != NIL) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; planstate-&gt;subPlan;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (haschildren)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Plans&quot;</span>, <span class="Constant">&quot;Plans&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Pass current Plan as head of ancestors list for children */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; ancestors = <a href="../nodes/list.c.html#L495" title="nodes/list.c:495">lcons</a>(plan, ancestors);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* initPlan-s */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (planstate-&gt;initPlan)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4409" title="commands/explain.c:4409">ExplainSubPlans</a>(planstate-&gt;initPlan, ancestors, <span class="Constant">&quot;<a href="../executor/execMain.c.html#L833" title="executor/execMain.c:833">InitPlan</a>&quot;</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* lefttree */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (outerPlanState(planstate))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a>(outerPlanState(planstate), ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Outer&quot;</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* righttree */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (innerPlanState(planstate))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a>(innerPlanState(planstate), ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Inner&quot;</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* special child plans */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">switch</span> (nodeTag(plan))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_Append:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4377" title="commands/explain.c:4377">ExplainMemberNodes</a>(((AppendState *) planstate)-&gt;appendplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((AppendState *) planstate)-&gt;as_nplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_MergeAppend:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4377" title="commands/explain.c:4377">ExplainMemberNodes</a>(((MergeAppendState *) planstate)-&gt;mergeplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((MergeAppendState *) planstate)-&gt;ms_nplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapAnd:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4377" title="commands/explain.c:4377">ExplainMemberNodes</a>(((BitmapAndState *) planstate)-&gt;bitmapplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((BitmapAndState *) planstate)-&gt;nplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapOr:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4377" title="commands/explain.c:4377">ExplainMemberNodes</a>(((BitmapOrState *) planstate)-&gt;bitmapplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((BitmapOrState *) planstate)-&gt;nplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SubqueryScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a>(((SubqueryScanState *) planstate)-&gt;subplan, ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Subquery&quot;</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CustomScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4452" title="commands/explain.c:4452">ExplainCustomChildren</a>((CustomScanState *) planstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* subPlan-s */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (planstate-&gt;subPlan)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4409" title="commands/explain.c:4409">ExplainSubPlans</a>(planstate-&gt;subPlan, ancestors, <span class="Constant">&quot;SubPlan&quot;</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* end of child plans */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (haschildren)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ancestors = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(ancestors);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Plans&quot;</span>, <span class="Constant">&quot;Plans&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* in text format, undo whatever indentation we added */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent = save_indent;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Plan&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; relationship ? <span class="Constant">NULL</span> : <span class="Constant">&quot;Plan&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">true</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show the targetlist of a plan node<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2422">&#x200c;</a></span><span class="linkable">show_plan_tlist</span>(PlanState *planstate, List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Plan&nbsp; &nbsp; &nbsp;&nbsp; *plan = planstate-&gt;plan;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *context;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *result = NIL;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; useprefix;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* No work if empty tlist (this occurs eg in bitmap indexscans) */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;targetlist == NIL)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* The tlist of an Append isn't real helpful, so suppress it */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (IsA(plan, Append))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Likewise for MergeAppend and RecursiveUnion */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (IsA(plan, MergeAppend))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (IsA(plan, RecursiveUnion))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Likewise for ForeignScan that executes a direct INSERT/UPDATE/DELETE<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Note: the tlist for a ForeignScan that executes a direct INSERT/UPDATE<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * might contain subplan output expressions that are confusing in this<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * context.&nbsp; The tlist for a ForeignScan that executes a direct UPDATE/<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * DELETE always contains &quot;junk&quot; target columns to identify the exact row<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * to update or delete, which would be confusing in this context.&nbsp; So, we<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * suppress it in all the cases.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (IsA(plan, ForeignScan) &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ((ForeignScan *) plan)-&gt;operation != CMD_SELECT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set up deparsing context */<br/></li>
<li></span>&nbsp; &nbsp; context = <a href="../utils/adt/ruleutils.c.html#L3799" title="utils/adt/ruleutils.c:3799">set_deparse_context_plan</a>(es-&gt;deparse_cxt,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors);<br/></li>
<li>&nbsp; &nbsp; useprefix = list_length(es-&gt;rtable) &gt; <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Deparse each result column (we <a href="../utils/adt/timestamp.c.html#L1618" title="utils/adt/timestamp.c:1618">now</a> include resjunk ones) */<br/></li>
<li></span>&nbsp; &nbsp; foreach(lc, plan-&gt;targetlist)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; TargetEntry *tle = (TargetEntry *) lfirst(lc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result = <a href="../nodes/list.c.html#L339" title="nodes/list.c:339">lappend</a>(result,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/adt/ruleutils.c.html#L3625" title="utils/adt/ruleutils.c:3625">deparse_expression</a>((Node *) tle-&gt;expr, context,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; useprefix, <span class="Constant">false</span>));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Print results */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L4619" title="commands/explain.c:4619">ExplainPropertyList</a>(<span class="Constant">&quot;Output&quot;</span>, result, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show a generic expression<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2480">&#x200c;</a></span><span class="linkable">show_expression</span>(Node *node, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> useprefix, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *context;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *exprstr;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set up deparsing context */<br/></li>
<li></span>&nbsp; &nbsp; context = <a href="../utils/adt/ruleutils.c.html#L3799" title="utils/adt/ruleutils.c:3799">set_deparse_context_plan</a>(es-&gt;deparse_cxt,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate-&gt;plan,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Deparse the expression */<br/></li>
<li></span>&nbsp; &nbsp; exprstr = <a href="../utils/adt/ruleutils.c.html#L3625" title="utils/adt/ruleutils.c:3625">deparse_expression</a>(node, context, useprefix, <span class="Constant">false</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* And add to es-&gt;str */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(qlabel, exprstr, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show a qualifier expression (which is a List with implicit AND semantics)<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2503">&#x200c;</a></span><span class="linkable">show_qual</span>(List *qual, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> useprefix, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Node&nbsp; &nbsp; &nbsp;&nbsp; *node;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* No work if empty qual */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (qual == NIL)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Convert AND list to explicit AND */<br/></li>
<li></span>&nbsp; &nbsp; node = (Node *) <a href="../nodes/makefuncs.c.html#L726" title="nodes/makefuncs.c:726">make_ands_explicit</a>(qual);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* And show it */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L2480" title="commands/explain.c:2480">show_expression</a>(node, qlabel, planstate, ancestors, useprefix, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show a qualifier expression for a scan plan node<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2524">&#x200c;</a></span><span class="linkable">show_scan_qual</span>(List *qual, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; useprefix;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; useprefix = (IsA(planstate-&gt;plan, SubqueryScan) || es-&gt;verbose);<br/></li>
<li>&nbsp; &nbsp; <a href="#L2503" title="commands/explain.c:2503">show_qual</a>(qual, qlabel, planstate, ancestors, useprefix, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show a qualifier expression for an <a href="../utils/adt/oracle_compat.c.html#L80" title="utils/adt/oracle_compat.c:80">upper</a>-level plan node<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2538">&#x200c;</a></span><span class="linkable">show_upper_qual</span>(List *qual, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PlanState *planstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; useprefix;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; useprefix = (list_length(es-&gt;rtable) &gt; <span class="Constant">1</span> || es-&gt;verbose);<br/></li>
<li>&nbsp; &nbsp; <a href="#L2503" title="commands/explain.c:2503">show_qual</a>(qual, qlabel, planstate, ancestors, useprefix, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show the sort keys for a Sort node.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2552">&#x200c;</a></span><span class="linkable">show_sort_keys</span>(SortState *sortstate, List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Sort&nbsp; &nbsp; &nbsp;&nbsp; *plan = (Sort *) sortstate-&gt;ss.ps.plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L2752" title="commands/explain.c:2752">show_sort_group_keys</a>((PlanState *) sortstate, <span class="Constant">&quot;Sort Key&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;numCols, <span class="Constant">0</span>, plan-&gt;sortColIdx,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;sortOperators, plan-&gt;collations,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;nullsFirst,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show the sort keys for an IncrementalSort node.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2567">&#x200c;</a></span><span class="linkable">show_incremental_sort_keys</span>(IncrementalSortState *incrsortstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; IncrementalSort *plan = (IncrementalSort *) incrsortstate-&gt;ss.ps.plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L2752" title="commands/explain.c:2752">show_sort_group_keys</a>((PlanState *) incrsortstate, <span class="Constant">&quot;Sort Key&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;sort.numCols, plan-&gt;nPresortedCols,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;sort.sortColIdx,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;sort.sortOperators, plan-&gt;sort.collations,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;sort.nullsFirst,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Likewise, for a MergeAppend node.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2584">&#x200c;</a></span><span class="linkable">show_merge_append_keys</span>(MergeAppendState *mstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; MergeAppend *plan = (MergeAppend *) mstate-&gt;ps.plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L2752" title="commands/explain.c:2752">show_sort_group_keys</a>((PlanState *) mstate, <span class="Constant">&quot;Sort Key&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;numCols, <span class="Constant">0</span>, plan-&gt;sortColIdx,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;sortOperators, plan-&gt;collations,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;nullsFirst,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show the grouping keys for an Agg node.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2600">&#x200c;</a></span><span class="linkable">show_agg_keys</span>(AggState *astate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Agg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *plan = (Agg *) astate-&gt;ss.ps.plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;numCols &gt; <span class="Constant">0</span> || plan-&gt;groupingSets)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* The key columns refer to the tlist of the child plan */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; ancestors = <a href="../nodes/list.c.html#L495" title="nodes/list.c:495">lcons</a>(plan, ancestors);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (plan-&gt;groupingSets)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2623" title="commands/explain.c:2623">show_grouping_sets</a>(outerPlanState(astate), plan, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2752" title="commands/explain.c:2752">show_sort_group_keys</a>(outerPlanState(astate), <span class="Constant">&quot;Group Key&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;numCols, <span class="Constant">0</span>, plan-&gt;grpColIdx,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">NULL</span>, <span class="Constant">NULL</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ancestors = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(ancestors);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2623">&#x200c;</a></span><span class="linkable">show_grouping_sets</span>(PlanState *planstate, Agg *agg,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *context;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; useprefix;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set up deparsing context */<br/></li>
<li></span>&nbsp; &nbsp; context = <a href="../utils/adt/ruleutils.c.html#L3799" title="utils/adt/ruleutils.c:3799">set_deparse_context_plan</a>(es-&gt;deparse_cxt,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate-&gt;plan,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors);<br/></li>
<li>&nbsp; &nbsp; useprefix = (list_length(es-&gt;rtable) &gt; <span class="Constant">1</span> || es-&gt;verbose);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Grouping Sets&quot;</span>, <span class="Constant">&quot;Grouping Sets&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L2654" title="commands/explain.c:2654">show_grouping_set_keys</a>(planstate, agg, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; context, useprefix, ancestors, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; foreach(lc, agg-&gt;chain)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Agg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *aggnode = lfirst(lc);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Sort&nbsp; &nbsp; &nbsp;&nbsp; *sortnode = (Sort *) aggnode-&gt;plan.lefttree;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2654" title="commands/explain.c:2654">show_grouping_set_keys</a>(planstate, aggnode, sortnode,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; context, useprefix, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Grouping Sets&quot;</span>, <span class="Constant">&quot;Grouping Sets&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2654">&#x200c;</a></span><span class="linkable">show_grouping_set_keys</span>(PlanState *planstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Agg *aggnode, Sort *sortnode,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *context, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> useprefix,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Plan&nbsp; &nbsp; &nbsp;&nbsp; *plan = planstate-&gt;plan;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *exprstr;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *gsets = aggnode-&gt;groupingSets;<br/></li>
<li>&nbsp; &nbsp; AttrNumber *keycols = aggnode-&gt;grpColIdx;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *keyname;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *keysetname;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (aggnode-&gt;aggstrategy == AGG_HASHED || aggnode-&gt;aggstrategy == AGG_MIXED)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; keyname = <span class="Constant">&quot;Hash Key&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; keysetname = <span class="Constant">&quot;Hash Keys&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; keyname = <span class="Constant">&quot;Group Key&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; keysetname = <span class="Constant">&quot;Group Keys&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Grouping Set&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (sortnode)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2752" title="commands/explain.c:2752">show_sort_group_keys</a>(planstate, <span class="Constant">&quot;Sort Key&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sortnode-&gt;numCols, <span class="Constant">0</span>, sortnode-&gt;sortColIdx,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sortnode-&gt;sortOperators, sortnode-&gt;collations,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sortnode-&gt;nullsFirst,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(keysetname, keysetname, <span class="Constant">false</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; foreach(lc, gsets)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *result = NIL;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc2;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; foreach(lc2, (List *) lfirst(lc))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Index&nbsp; &nbsp; &nbsp; &nbsp; i = lfirst_int(lc2);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AttrNumber&nbsp; &nbsp; keyresno = keycols[i];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TargetEntry *target = <a href="../parser/parse_relation.c.html#L3439" title="parser/parse_relation.c:3439">get_tle_by_resno</a>(plan-&gt;targetlist,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; keyresno);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!target)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elog(ERROR, <span class="Constant">&quot;no tlist entry for key </span><span class="Special">%d</span><span class="Constant">&quot;</span>, keyresno);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Deparse the expression, showing <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> top-level cast */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exprstr = <a href="../utils/adt/ruleutils.c.html#L3625" title="utils/adt/ruleutils.c:3625">deparse_expression</a>((Node *) target-&gt;expr, context,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; useprefix, <span class="Constant">true</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result = <a href="../nodes/list.c.html#L339" title="nodes/list.c:339">lappend</a>(result, exprstr);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!result &amp;&amp; es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(keyname, <span class="Constant">&quot;()&quot;</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4689" title="commands/explain.c:4689">ExplainPropertyListNested</a>(keyname, result, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(keysetname, keysetname, <span class="Constant">false</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (sortnode &amp;&amp; es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Grouping Set&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show the grouping keys for a Group node.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2732">&#x200c;</a></span><span class="linkable">show_group_keys</span>(GroupState *gstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Group&nbsp; &nbsp; &nbsp;&nbsp; *plan = (Group *) gstate-&gt;ss.ps.plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* The key columns refer to the tlist of the child plan */<br/></li>
<li></span>&nbsp; &nbsp; ancestors = <a href="../nodes/list.c.html#L495" title="nodes/list.c:495">lcons</a>(plan, ancestors);<br/></li>
<li>&nbsp; &nbsp; <a href="#L2752" title="commands/explain.c:2752">show_sort_group_keys</a>(outerPlanState(gstate), <span class="Constant">&quot;Group Key&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan-&gt;numCols, <span class="Constant">0</span>, plan-&gt;grpColIdx,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">NULL</span>, <span class="Constant">NULL</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors, es);<br/></li>
<li>&nbsp; &nbsp; ancestors = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(ancestors);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Common code to show sort/group keys, which are represented in plan nodes<br/></li>
<li></span><span class="Comment"> * as arrays of targetlist indexes.&nbsp; If it's a sort key rather than a group<br/></li>
<li></span><span class="Comment"> * key, also pass sort operators/collations/nullsFirst arrays.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2752">&#x200c;</a></span><span class="linkable">show_sort_group_keys</span>(PlanState *planstate, <span class="Type">const</span> <span class="Type">char</span> *qlabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">int</span> nkeys, <span class="Type">int</span> nPresortedKeys, AttrNumber *keycols,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Oid *sortOperators, Oid *collations, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> *nullsFirst,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Plan&nbsp; &nbsp; &nbsp;&nbsp; *plan = planstate-&gt;plan;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *context;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *result = NIL;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *resultPresorted = NIL;<br/></li>
<li>&nbsp; &nbsp; StringInfoData sortkeybuf;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; useprefix;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; keyno;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (nkeys &lt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; initStringInfo(&amp;sortkeybuf);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set up deparsing context */<br/></li>
<li></span>&nbsp; &nbsp; context = <a href="../utils/adt/ruleutils.c.html#L3799" title="utils/adt/ruleutils.c:3799">set_deparse_context_plan</a>(es-&gt;deparse_cxt,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors);<br/></li>
<li>&nbsp; &nbsp; useprefix = (list_length(es-&gt;rtable) &gt; <span class="Constant">1</span> || es-&gt;verbose);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (keyno = <span class="Constant">0</span>; keyno &lt; nkeys; keyno++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* <a href="../regex/regexec.c.html#L419" title="regex/regexec.c:419">find</a> key expression in tlist */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; AttrNumber&nbsp; &nbsp; keyresno = keycols[keyno];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; TargetEntry *target = <a href="../parser/parse_relation.c.html#L3439" title="parser/parse_relation.c:3439">get_tle_by_resno</a>(plan-&gt;targetlist,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; keyresno);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *exprstr;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!target)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elog(ERROR, <span class="Constant">&quot;no tlist entry for key </span><span class="Special">%d</span><span class="Constant">&quot;</span>, keyresno);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Deparse the expression, showing <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> top-level cast */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; exprstr = <a href="../utils/adt/ruleutils.c.html#L3625" title="utils/adt/ruleutils.c:3625">deparse_expression</a>((Node *) target-&gt;expr, context,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; useprefix, <span class="Constant">true</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; resetStringInfo(&amp;sortkeybuf);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(&amp;sortkeybuf, exprstr);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Append sort order information, if relevant */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (sortOperators != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2814" title="commands/explain.c:2814">show_sortorder_options</a>(&amp;sortkeybuf,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (Node *) target-&gt;expr,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sortOperators[keyno],<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; collations[keyno],<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; nullsFirst[keyno]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Emit one property-list item per sort key */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; result = <a href="../nodes/list.c.html#L339" title="nodes/list.c:339">lappend</a>(result, <a href="../utils/mmgr/mcxt.c.html#L1695" title="utils/mmgr/mcxt.c:1695">pstrdup</a>(sortkeybuf.data));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (keyno &lt; nPresortedKeys)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resultPresorted = <a href="../nodes/list.c.html#L339" title="nodes/list.c:339">lappend</a>(resultPresorted, exprstr);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4619" title="commands/explain.c:4619">ExplainPropertyList</a>(qlabel, result, es);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (nPresortedKeys &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4619" title="commands/explain.c:4619">ExplainPropertyList</a>(<span class="Constant">&quot;Presorted Key&quot;</span>, resultPresorted, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Append nondefault characteristics of the sort ordering of a column to buf<br/></li>
<li></span><span class="Comment"> * (collation, direction, NULLS FIRST/LAST)<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2814">&#x200c;</a></span><span class="linkable">show_sortorder_options</span>(StringInfo buf, Node *sortexpr,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Oid sortOperator, Oid collation, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> nullsFirst)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Oid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sortcoltype = <a href="../nodes/nodeFuncs.c.html#L42" title="nodes/nodeFuncs.c:42">exprType</a>(sortexpr);<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; reverse = <span class="Constant">false</span>;<br/></li>
<li>&nbsp; &nbsp; TypeCacheEntry *typentry;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; typentry = <a href="../utils/cache/typcache.c.html#L346" title="utils/cache/typcache.c:346">lookup_type_cache</a>(sortcoltype,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; TYPECACHE_LT_OPR | TYPECACHE_GT_OPR);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Print COLLATE if it's not default for the column's type.&nbsp; There are<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * some cases where this is redundant, eg if expression is a column whose<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * declared collation is that collation, but it's hard to distinguish that<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * here (and arguably, printing COLLATE explicitly is a good idea anyway<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * in such cases).<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (OidIsValid(collation) &amp;&amp; collation != <a href="../utils/cache/lsyscache.c.html#L3056" title="utils/cache/lsyscache.c:3056">get_typcollation</a>(sortcoltype))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *collname = <a href="../utils/cache/lsyscache.c.html#L1035" title="utils/cache/lsyscache.c:1035">get_collation_name</a>(collation);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (collname == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elog(ERROR, <span class="Constant">&quot;cache lookup failed for collation </span><span class="Special">%u</span><span class="Constant">&quot;</span>, collation);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(buf, <span class="Constant">&quot; COLLATE </span><span class="Special">%s</span><span class="Constant">&quot;</span>, <a href="../utils/adt/ruleutils.c.html#L12623" title="utils/adt/ruleutils.c:12623">quote_identifier</a>(collname));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Print direction if not ASC, or USING if non-default sort operator */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (sortOperator == typentry-&gt;gt_opr)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(buf, <span class="Constant">&quot; DESC&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; reverse = <span class="Constant">true</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (sortOperator != typentry-&gt;lt_opr)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *opname = <a href="../utils/cache/lsyscache.c.html#L1310" title="utils/cache/lsyscache.c:1310">get_opname</a>(sortOperator);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (opname == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elog(ERROR, <span class="Constant">&quot;cache lookup failed for operator </span><span class="Special">%u</span><span class="Constant">&quot;</span>, sortOperator);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(buf, <span class="Constant">&quot; USING </span><span class="Special">%s</span><span class="Constant">&quot;</span>, opname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Determine whether operator would be considered ASC or DESC */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; (<span class="Type">void</span>) <a href="../utils/cache/lsyscache.c.html#L267" title="utils/cache/lsyscache.c:267">get_equality_op_for_ordering_op</a>(sortOperator, &amp;reverse);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Add NULLS FIRST/LAST only if it wouldn't be default */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (nullsFirst &amp;&amp; !reverse)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(buf, <span class="Constant">&quot; NULLS FIRST&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (!nullsFirst &amp;&amp; reverse)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(buf, <span class="Constant">&quot; NULLS LAST&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show TABLESAMPLE properties<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2872">&#x200c;</a></span><span class="linkable">show_tablesample</span>(TableSampleClause *tsc, PlanState *planstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *context;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; useprefix;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *method_name;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *params = NIL;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *repeatable;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set up deparsing context */<br/></li>
<li></span>&nbsp; &nbsp; context = <a href="../utils/adt/ruleutils.c.html#L3799" title="utils/adt/ruleutils.c:3799">set_deparse_context_plan</a>(es-&gt;deparse_cxt,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate-&gt;plan,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors);<br/></li>
<li>&nbsp; &nbsp; useprefix = list_length(es-&gt;rtable) &gt; <span class="Constant">1</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Get the tablesample method name */<br/></li>
<li></span>&nbsp; &nbsp; method_name = <a href="../utils/cache/lsyscache.c.html#L1608" title="utils/cache/lsyscache.c:1608">get_func_name</a>(tsc-&gt;tsmhandler);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Deparse parameter expressions */<br/></li>
<li></span>&nbsp; &nbsp; foreach(lc, tsc-&gt;args)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Node&nbsp; &nbsp; &nbsp;&nbsp; *arg = (Node *) lfirst(lc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; params = <a href="../nodes/list.c.html#L339" title="nodes/list.c:339">lappend</a>(params,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/adt/ruleutils.c.html#L3625" title="utils/adt/ruleutils.c:3625">deparse_expression</a>(arg, context,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; useprefix, <span class="Constant">false</span>));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (tsc-&gt;repeatable)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; repeatable = <a href="../utils/adt/ruleutils.c.html#L3625" title="utils/adt/ruleutils.c:3625">deparse_expression</a>((Node *) tsc-&gt;repeatable, context,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; useprefix, <span class="Constant">false</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; repeatable = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Print results */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; first = <span class="Constant">true</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Sampling: </span><span class="Special">%s</span><span class="Constant"> (&quot;</span>, method_name);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; foreach(lc, params)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!first)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;, &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, (<span class="Type">const</span> <span class="Type">char</span> *) lfirst(lc));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first = <span class="Constant">false</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">')'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (repeatable)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; REPEATABLE (</span><span class="Special">%s</span><span class="Constant">)&quot;</span>, repeatable);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Sampling Method&quot;</span>, method_name, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4619" title="commands/explain.c:4619">ExplainPropertyList</a>(<span class="Constant">&quot;Sampling Parameters&quot;</span>, params, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (repeatable)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Repeatable Seed&quot;</span>, repeatable, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * If it's EXPLAIN ANALYZE, show tuplesort stats for a sort node<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L2938">&#x200c;</a></span><span class="linkable">show_sort_info</span>(SortState *sortstate, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (!es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (sortstate-&gt;sort_Done &amp;&amp; sortstate-&gt;tuplesortstate != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/sort/tuplesort.c.html#L186" title="utils/sort/tuplesort.c:186">Tuplesortstate</a> *state = (<a href="../utils/sort/tuplesort.c.html#L186" title="utils/sort/tuplesort.c:186">Tuplesortstate</a> *) sortstate-&gt;tuplesortstate;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; TuplesortInstrumentation stats;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *sortMethod;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *spaceType;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; spaceUsed;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/sort/tuplesort.c.html#L2537" title="utils/sort/tuplesort.c:2537">tuplesort_get_stats</a>(state, &amp;stats);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; sortMethod = <a href="../utils/sort/tuplesort.c.html#L2581" title="utils/sort/tuplesort.c:2581">tuplesort_method_name</a>(stats.sortMethod);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; spaceType = <a href="../utils/sort/tuplesort.c.html#L2604" title="utils/sort/tuplesort.c:2604">tuplesort_space_type_name</a>(stats.spaceType);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; spaceUsed = stats.spaceUsed;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Sort Method: </span><span class="Special">%s</span><span class="Constant">&nbsp; </span><span class="Special">%s</span><span class="Constant">: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB</span><span class="Special">\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sortMethod, spaceType, spaceUsed);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Sort Method&quot;</span>, sortMethod, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Sort Space Used&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, spaceUsed, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Sort Space Type&quot;</span>, spaceType, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * You might think we should just <a href="../regex/regc_lex.c.html#L982" title="regex/regc_lex.c:982">skip</a> this stanza entirely when<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * es-&gt;hide_workers is true, but then we'd get no sort-method output at<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * all.&nbsp; We have to make it look like worker 0's data is top-level data.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * This is easily done by just skipping the OpenWorker/CloseWorker calls.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Currently, we don't worry about the possibility that there are multiple<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * workers in such a case; if there are, duplicate output fields will be<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * emitted.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (sortstate-&gt;shared_info != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (n = <span class="Constant">0</span>; n &lt; sortstate-&gt;shared_info-&gt;num_workers; n++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TuplesortInstrumentation *sinstrument;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *sortMethod;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *spaceType;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; spaceUsed;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sinstrument = &amp;sortstate-&gt;shared_info-&gt;sinstrument[n];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (sinstrument-&gt;sortMethod == SORT_TYPE_STILL_IN_PROGRESS)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* ignore <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> unfilled slots */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sortMethod = <a href="../utils/sort/tuplesort.c.html#L2581" title="utils/sort/tuplesort.c:2581">tuplesort_method_name</a>(sinstrument-&gt;sortMethod);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spaceType = <a href="../utils/sort/tuplesort.c.html#L2604" title="utils/sort/tuplesort.c:2604">tuplesort_space_type_name</a>(sinstrument-&gt;spaceType);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spaceUsed = sinstrument-&gt;spaceUsed;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(n, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Sort Method: </span><span class="Special">%s</span><span class="Constant">&nbsp; </span><span class="Special">%s</span><span class="Constant">: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB</span><span class="Special">\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; sortMethod, spaceType, spaceUsed);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Sort Method&quot;</span>, sortMethod, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Sort Space Used&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, spaceUsed, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Sort Space Type&quot;</span>, spaceType, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Incremental sort nodes sort in (a potentially very large number of) batches,<br/></li>
<li></span><span class="Comment"> * so EXPLAIN ANALYZE needs to roll up the tuplesort stats from each batch into<br/></li>
<li></span><span class="Comment"> * an intelligible summary.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This function is used for both a non-parallel node and each worker in a<br/></li>
<li></span><span class="Comment"> * parallel incremental sort node.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3029">&#x200c;</a></span><span class="linkable">show_incremental_sort_group_info</span>(IncrementalSortGroupInfo *groupInfo,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">const</span> <span class="Type">char</span> *groupLabel, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> indent, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *methodCell;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *methodNames = NIL;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Generate a list of sort methods used across all groups. */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> <a href="../utils/adt/varbit.c.html#L391" title="utils/adt/varbit.c:391">bit</a> = <span class="Constant">0</span>; <a href="../utils/adt/varbit.c.html#L391" title="utils/adt/varbit.c:391">bit</a> &lt; NUM_TUPLESORTMETHODS; <a href="../utils/adt/varbit.c.html#L391" title="utils/adt/varbit.c:391">bit</a>++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; TuplesortMethod sortMethod = (<span class="Constant">1</span> &lt;&lt; <a href="../utils/adt/varbit.c.html#L391" title="utils/adt/varbit.c:391">bit</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (groupInfo-&gt;sortMethods &amp; sortMethod)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *methodName = <a href="../utils/sort/tuplesort.c.html#L2581" title="utils/sort/tuplesort.c:2581">tuplesort_method_name</a>(sortMethod);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; methodNames = <a href="../nodes/list.c.html#L339" title="nodes/list.c:339">lappend</a>(methodNames, unconstify(<span class="Type">char</span> *, methodName));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (indent)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> Groups: &quot;</span> INT64_FORMAT <span class="Constant">&quot;&nbsp; Sort Method&quot;</span>, groupLabel,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; groupInfo-&gt;groupCount);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* plural/singular based on methodNames size */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (list_length(methodNames) &gt; <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;s: &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;: &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; foreach(methodCell, methodNames)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, (<span class="Type">char</span> *) methodCell-&gt;ptr_value);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (foreach_current_index(methodCell) &lt; list_length(methodNames) - <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;, &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (groupInfo-&gt;maxMemorySpaceUsed &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; avgSpace = groupInfo-&gt;totalMemorySpaceUsed / groupInfo-&gt;groupCount;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *spaceTypeName;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spaceTypeName = <a href="../utils/sort/tuplesort.c.html#L2604" title="utils/sort/tuplesort.c:2604">tuplesort_space_type_name</a>(SORT_SPACE_TYPE_MEMORY);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;&nbsp; Average </span><span class="Special">%s</span><span class="Constant">: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB&nbsp; Peak </span><span class="Special">%s</span><span class="Constant">: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spaceTypeName, avgSpace,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spaceTypeName, groupInfo-&gt;maxMemorySpaceUsed);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (groupInfo-&gt;maxDiskSpaceUsed &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; avgSpace = groupInfo-&gt;totalDiskSpaceUsed / groupInfo-&gt;groupCount;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *spaceTypeName;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spaceTypeName = <a href="../utils/sort/tuplesort.c.html#L2604" title="utils/sort/tuplesort.c:2604">tuplesort_space_type_name</a>(SORT_SPACE_TYPE_DISK);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;&nbsp; Average </span><span class="Special">%s</span><span class="Constant">: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB&nbsp; Peak </span><span class="Special">%s</span><span class="Constant">: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spaceTypeName, avgSpace,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spaceTypeName, groupInfo-&gt;maxDiskSpaceUsed);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; StringInfoData groupName;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; initStringInfo(&amp;groupName);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(&amp;groupName, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant"> Groups&quot;</span>, groupLabel);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Incremental Sort Groups&quot;</span>, groupName.data, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Group Count&quot;</span>, <span class="Constant">NULL</span>, groupInfo-&gt;groupCount, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4619" title="commands/explain.c:4619">ExplainPropertyList</a>(<span class="Constant">&quot;Sort Methods Used&quot;</span>, methodNames, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (groupInfo-&gt;maxMemorySpaceUsed &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; avgSpace = groupInfo-&gt;totalMemorySpaceUsed / groupInfo-&gt;groupCount;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *spaceTypeName;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; StringInfoData memoryName;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spaceTypeName = <a href="../utils/sort/tuplesort.c.html#L2604" title="utils/sort/tuplesort.c:2604">tuplesort_space_type_name</a>(SORT_SPACE_TYPE_MEMORY);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; initStringInfo(&amp;memoryName);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(&amp;memoryName, <span class="Constant">&quot;Sort Space </span><span class="Special">%s</span><span class="Constant">&quot;</span>, spaceTypeName);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Sort Space&quot;</span>, memoryName.data, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Average Sort Space Used&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, avgSpace, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Peak Sort Space Used&quot;</span>, <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; groupInfo-&gt;maxMemorySpaceUsed, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Sort Space&quot;</span>, memoryName.data, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (groupInfo-&gt;maxDiskSpaceUsed &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; avgSpace = groupInfo-&gt;totalDiskSpaceUsed / groupInfo-&gt;groupCount;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *spaceTypeName;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; StringInfoData diskName;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spaceTypeName = <a href="../utils/sort/tuplesort.c.html#L2604" title="utils/sort/tuplesort.c:2604">tuplesort_space_type_name</a>(SORT_SPACE_TYPE_DISK);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; initStringInfo(&amp;diskName);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(&amp;diskName, <span class="Constant">&quot;Sort Space </span><span class="Special">%s</span><span class="Constant">&quot;</span>, spaceTypeName);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Sort Space&quot;</span>, diskName.data, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Average Sort Space Used&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, avgSpace, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Peak Sort Space Used&quot;</span>, <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; groupInfo-&gt;maxDiskSpaceUsed, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Sort Space&quot;</span>, diskName.data, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Incremental Sort Groups&quot;</span>, groupName.data, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * If it's EXPLAIN ANALYZE, show tuplesort stats for an incremental sort node<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3143">&#x200c;</a></span><span class="linkable">show_incremental_sort_info</span>(IncrementalSortState *incrsortstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; IncrementalSortGroupInfo *fullsortGroupInfo;<br/></li>
<li>&nbsp; &nbsp; IncrementalSortGroupInfo *prefixsortGroupInfo;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; fullsortGroupInfo = &amp;incrsortstate-&gt;incsort_info.fullsortGroupInfo;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (!es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Since we never have <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> prefix groups unless we've first sorted a full<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * groups and transitioned modes (copying the tuples into a prefix group),<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * we don't need to do anything if there were 0 full groups.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * We still have to continue after this block if there are no full groups,<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * though, since it's possible that we have workers that did real work<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * even if the leader didn't participate.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (fullsortGroupInfo-&gt;groupCount &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3029" title="commands/explain.c:3029">show_incremental_sort_group_info</a>(fullsortGroupInfo, <span class="Constant">&quot;Full-sort&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; prefixsortGroupInfo = &amp;incrsortstate-&gt;incsort_info.prefixsortGroupInfo;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (prefixsortGroupInfo-&gt;groupCount &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3029" title="commands/explain.c:3029">show_incremental_sort_group_info</a>(prefixsortGroupInfo, <span class="Constant">&quot;Pre-sorted&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (incrsortstate-&gt;shared_info != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; indent_first_line;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (n = <span class="Constant">0</span>; n &lt; incrsortstate-&gt;shared_info-&gt;num_workers; n++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IncrementalSortInfo *incsort_info =<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;incrsortstate-&gt;shared_info-&gt;sinfo[n];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * If a worker hasn't processed <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> sort groups at all, then<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * exclude it from output since it either didn't launch or didn't<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * contribute anything meaningful.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fullsortGroupInfo = &amp;incsort_info-&gt;fullsortGroupInfo;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Since we never have <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> prefix groups unless we've first sorted<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * a full groups and transitioned modes (copying the tuples into a<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * prefix group), we don't need to do anything if there were 0<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * full groups.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (fullsortGroupInfo-&gt;groupCount == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(n, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; indent_first_line = es-&gt;workers_state == <span class="Constant">NULL</span> || es-&gt;verbose;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3029" title="commands/explain.c:3029">show_incremental_sort_group_info</a>(fullsortGroupInfo, <span class="Constant">&quot;Full-sort&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; indent_first_line, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prefixsortGroupInfo = &amp;incsort_info-&gt;prefixsortGroupInfo;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (prefixsortGroupInfo-&gt;groupCount &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3029" title="commands/explain.c:3029">show_incremental_sort_group_info</a>(prefixsortGroupInfo, <span class="Constant">&quot;Pre-sorted&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show information on <a href="../regex/rege_dfa.c.html#L715" title="regex/rege_dfa.c:715">hash</a> buckets/batches.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3229">&#x200c;</a></span><span class="linkable">show_hash_info</span>(HashState *hashstate, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; HashInstrumentation hinstrument = {<span class="Constant">0</span>};<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Collect stats from the local process, even when it's a parallel query.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * In a parallel query, the leader process may or may not have run the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * <a href="../regex/rege_dfa.c.html#L715" title="regex/rege_dfa.c:715">hash</a> join, and even if it did it may not have built a <a href="../regex/rege_dfa.c.html#L715" title="regex/rege_dfa.c:715">hash</a> table due to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * timing (if it started late it might have seen no tuples in the outer<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * relation and skipped building the <a href="../regex/rege_dfa.c.html#L715" title="regex/rege_dfa.c:715">hash</a> table).&nbsp; Therefore we have to be<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * prepared to get instrumentation data from all participants.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (hashstate-&gt;hinstrument)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; memcpy(&amp;hinstrument, hashstate-&gt;hinstrument,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(HashInstrumentation));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Merge results from workers.&nbsp; In the parallel-oblivious case, the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * results from all participants should be identical, except where<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * participants didn't run the join at all so have no data.&nbsp; In the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * parallel-aware case, we need to consider all the results.&nbsp; Each worker<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * may have seen a different <a href="../regex/regexec.c.html#L702" title="regex/regexec.c:702">subset</a> of batches and we want to report the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * highest memory usage across all batches.&nbsp; We take the maxima of other<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * <a href="../bootstrap/bootstrap.c.html#L152" title="bootstrap/bootstrap.c:152">values</a> too, for the same reasons as in <a href="../executor/nodeHash.c.html#L2850" title="executor/nodeHash.c:2850">ExecHashAccumInstrumentation</a>.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (hashstate-&gt;shared_info)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; SharedHashInfo *shared_info = hashstate-&gt;shared_info;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (i = <span class="Constant">0</span>; i &lt; shared_info-&gt;num_workers; ++i)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HashInstrumentation *worker_hi = &amp;shared_info-&gt;hinstrument[i];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hinstrument.nbuckets = Max(hinstrument.nbuckets,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; worker_hi-&gt;nbuckets);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hinstrument.nbuckets_original = Max(hinstrument.nbuckets_original,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; worker_hi-&gt;nbuckets_original);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hinstrument.nbatch = Max(hinstrument.nbatch,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; worker_hi-&gt;nbatch);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hinstrument.nbatch_original = Max(hinstrument.nbatch_original,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; worker_hi-&gt;nbatch_original);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hinstrument.space_peak = Max(hinstrument.space_peak,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; worker_hi-&gt;space_peak);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (hinstrument.nbatch &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">long</span>&nbsp; &nbsp; &nbsp; &nbsp; spacePeakKb = (hinstrument.space_peak + <span class="Constant">1023</span>) / <span class="Constant">1024</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Hash Buckets&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbuckets, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Original Hash Buckets&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbuckets_original, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Hash Batches&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbatch, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Original Hash Batches&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbatch_original, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Peak Memory Usage&quot;</span>, <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spacePeakKb, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (hinstrument.nbatch_original != hinstrument.nbatch ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbuckets_original != hinstrument.nbuckets)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Buckets: </span><span class="Special">%d</span><span class="Constant"> (originally </span><span class="Special">%d</span><span class="Constant">)&nbsp; Batches: </span><span class="Special">%d</span><span class="Constant"> (originally </span><span class="Special">%d</span><span class="Constant">)&nbsp; Memory Usage: </span><span class="Special">%ld</span><span class="Constant">kB</span><span class="Special">\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbuckets,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbuckets_original,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbatch,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbatch_original,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spacePeakKb);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Buckets: </span><span class="Special">%d</span><span class="Constant">&nbsp; Batches: </span><span class="Special">%d</span><span class="Constant">&nbsp; Memory Usage: </span><span class="Special">%ld</span><span class="Constant">kB</span><span class="Special">\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hinstrument.nbuckets, hinstrument.nbatch,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spacePeakKb);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show information on memoize hits/misses/evictions and memory usage.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3320">&#x200c;</a></span><span class="linkable">show_memoize_info</span>(MemoizeState *mstate, List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Plan&nbsp; &nbsp; &nbsp;&nbsp; *plan = ((PlanState *) mstate)-&gt;plan;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *context;<br/></li>
<li>&nbsp; &nbsp; StringInfoData keystr;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *separator = <span class="Constant">&quot;&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; useprefix;<br/></li>
<li>&nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; memPeakKb;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; initStringInfo(&amp;keystr);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * It's hard to imagine having a memoize node with fewer than 2 RTEs, but<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * let's just keep the same useprefix logic as elsewhere in this file.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; useprefix = list_length(es-&gt;rtable) &gt; <span class="Constant">1</span> || es-&gt;verbose;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set up deparsing context */<br/></li>
<li></span>&nbsp; &nbsp; context = <a href="../utils/adt/ruleutils.c.html#L3799" title="utils/adt/ruleutils.c:3799">set_deparse_context_plan</a>(es-&gt;deparse_cxt,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; plan,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ancestors);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; foreach(lc, ((Memoize *) plan)-&gt;param_exprs)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Node&nbsp; &nbsp; &nbsp;&nbsp; *expr = (Node *) lfirst(lc);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(&amp;keystr, separator);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(&amp;keystr, <a href="../utils/adt/ruleutils.c.html#L3625" title="utils/adt/ruleutils.c:3625">deparse_expression</a>(expr, context,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; useprefix, <span class="Constant">false</span>));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; separator = <span class="Constant">&quot;, &quot;</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Cache Key&quot;</span>, keystr.data, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Cache <a href="../utils/init/miscinit.c.html#L61" title="utils/init/miscinit.c:61">Mode</a>&quot;</span>, mstate-&gt;binary_mode ? <span class="Constant">&quot;binary&quot;</span> : <span class="Constant">&quot;logical&quot;</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Cache Key: </span><span class="Special">%s\n</span><span class="Constant">&quot;</span>, keystr.data);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Cache <a href="../utils/init/miscinit.c.html#L61" title="utils/init/miscinit.c:61">Mode</a>: </span><span class="Special">%s\n</span><span class="Constant">&quot;</span>, mstate-&gt;binary_mode ? <span class="Constant">&quot;binary&quot;</span> : <span class="Constant">&quot;logical&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(keystr.data);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (!es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (mstate-&gt;stats.cache_misses &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * mem_peak is only set when we freed memory, so we must use mem_used<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * when mem_peak is 0.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (mstate-&gt;stats.mem_peak &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memPeakKb = (mstate-&gt;stats.mem_peak + <span class="Constant">1023</span>) / <span class="Constant">1024</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memPeakKb = (mstate-&gt;mem_used + <span class="Constant">1023</span>) / <span class="Constant">1024</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Cache Hits&quot;</span>, <span class="Constant">NULL</span>, mstate-&gt;stats.cache_hits, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Cache Misses&quot;</span>, <span class="Constant">NULL</span>, mstate-&gt;stats.cache_misses, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Cache Evictions&quot;</span>, <span class="Constant">NULL</span>, mstate-&gt;stats.cache_evictions, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Cache Overflows&quot;</span>, <span class="Constant">NULL</span>, mstate-&gt;stats.cache_overflows, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Peak Memory Usage&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, memPeakKb, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Hits: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;&nbsp; Misses: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;&nbsp; Evictions: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;&nbsp; Overflows: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;&nbsp; Memory Usage: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB</span><span class="Special">\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mstate-&gt;stats.cache_hits,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mstate-&gt;stats.cache_misses,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mstate-&gt;stats.cache_evictions,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mstate-&gt;stats.cache_overflows,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; memPeakKb);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (mstate-&gt;shared_info == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Show details from parallel workers */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> n = <span class="Constant">0</span>; n &lt; mstate-&gt;shared_info-&gt;num_workers; n++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; MemoizeInstrumentation *si;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; si = &amp;mstate-&gt;shared_info-&gt;sinstrument[n];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Skip workers that didn't do <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> work.&nbsp; We needn't bother checking<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * for cache hits as a <a href="../regex/rege_dfa.c.html#L777" title="regex/rege_dfa.c:777">miss</a> will always occur <a href="../regex/regc_locale.c.html#L488" title="regex/regc_locale.c:488">before</a> a cache hit.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (si-&gt;cache_misses == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(n, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Since the worker's MemoizeState.mem_used field is unavailable to<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * us, <a href="../executor/nodeMemoize.c.html#L1080" title="executor/nodeMemoize.c:1080">ExecEndMemoize</a> will have set the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * MemoizeInstrumentation.mem_peak field for us.&nbsp; No need to do the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * zero checks like we did for the serial case above.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; memPeakKb = (si-&gt;mem_peak + <span class="Constant">1023</span>) / <span class="Constant">1024</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Hits: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;&nbsp; Misses: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;&nbsp; Evictions: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;&nbsp; Overflows: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;&nbsp; Memory Usage: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB</span><span class="Special">\n</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; si-&gt;cache_hits, si-&gt;cache_misses,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; si-&gt;cache_evictions, si-&gt;cache_overflows,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; memPeakKb);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Cache Hits&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; si-&gt;cache_hits, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Cache Misses&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; si-&gt;cache_misses, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Cache Evictions&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; si-&gt;cache_evictions, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Cache Overflows&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; si-&gt;cache_overflows, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Peak Memory Usage&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, memPeakKb,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show information on <a href="../regex/rege_dfa.c.html#L715" title="regex/rege_dfa.c:715">hash</a> aggregate memory usage and batches.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3464">&#x200c;</a></span><span class="linkable">show_hashagg_info</span>(AggState *aggstate, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Agg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *agg = (Agg *) aggstate-&gt;ss.ps.plan;<br/></li>
<li>&nbsp; &nbsp; int64&nbsp; &nbsp; &nbsp; &nbsp; memPeakKb = (aggstate-&gt;hash_mem_peak + <span class="Constant">1023</span>) / <span class="Constant">1024</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (agg-&gt;aggstrategy != AGG_HASHED &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; agg-&gt;aggstrategy != AGG_MIXED)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;costs)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Planned Partitions&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; aggstate-&gt;hash_planned_partitions, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * During parallel query the leader may have not helped out.&nbsp; We<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * detect this by checking how much memory it used.&nbsp; If we <a href="../regex/regexec.c.html#L419" title="regex/regexec.c:419">find</a> it<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * didn't do <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> work then we don't show its properties.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; aggstate-&gt;hash_mem_peak &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;HashAgg Batches&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; aggstate-&gt;hash_batches_used, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Peak Memory Usage&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, memPeakKb, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Disk Usage&quot;</span>, <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; aggstate-&gt;hash_disk_used, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; gotone = <span class="Constant">false</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;costs &amp;&amp; aggstate-&gt;hash_planned_partitions &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Planned Partitions: </span><span class="Special">%d</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; aggstate-&gt;hash_planned_partitions);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gotone = <span class="Constant">true</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * During parallel query the leader may have not helped out.&nbsp; We<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * detect this by checking how much memory it used.&nbsp; If we <a href="../regex/regexec.c.html#L419" title="regex/regexec.c:419">find</a> it<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * didn't do <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> work then we don't show its properties.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; aggstate-&gt;hash_mem_peak &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!gotone)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, <span class="Constant">2</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Batches: </span><span class="Special">%d</span><span class="Constant">&nbsp; Memory Usage: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; aggstate-&gt;hash_batches_used, memPeakKb);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gotone = <span class="Constant">true</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Only display disk usage if we spilled to disk */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (aggstate-&gt;hash_batches_used &gt; <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;&nbsp; Disk Usage: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; aggstate-&gt;hash_disk_used);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (gotone)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Display stats for each parallel worker */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; aggstate-&gt;shared_info != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> n = <span class="Constant">0</span>; n &lt; aggstate-&gt;shared_info-&gt;num_workers; n++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AggregateInstrumentation *sinstrument;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uint64&nbsp; &nbsp; &nbsp; &nbsp; hash_disk_used;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hash_batches_used;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sinstrument = &amp;aggstate-&gt;shared_info-&gt;sinstrument[n];<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Skip workers that didn't do anything */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (sinstrument-&gt;hash_mem_peak == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hash_disk_used = sinstrument-&gt;hash_disk_used;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hash_batches_used = sinstrument-&gt;hash_batches_used;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; memPeakKb = (sinstrument-&gt;hash_mem_peak + <span class="Constant">1023</span>) / <span class="Constant">1024</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(n, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Batches: </span><span class="Special">%d</span><span class="Constant">&nbsp; Memory Usage: &quot;</span> INT64_FORMAT <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hash_batches_used, memPeakKb);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Only display disk usage if we spilled to disk */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (hash_batches_used &gt; <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;&nbsp; Disk Usage: &quot;</span> UINT64_FORMAT <span class="Constant">&quot;kB&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hash_disk_used);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;HashAgg Batches&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; hash_batches_used, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Peak Memory Usage&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, memPeakKb,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Disk Usage&quot;</span>, <span class="Constant">&quot;kB&quot;</span>, hash_disk_used, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;workers_state)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>(n, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * If it's EXPLAIN ANALYZE, show exact/lossy pages for a BitmapHeapScan node<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3585">&#x200c;</a></span><span class="linkable">show_tidbitmap_info</span>(BitmapHeapScanState *planstate, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Exact Heap Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate-&gt;exact_pages, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Lossy Heap Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; planstate-&gt;lossy_pages, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (planstate-&gt;exact_pages &gt; <span class="Constant">0</span> || planstate-&gt;lossy_pages &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;Heap Blocks:&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (planstate-&gt;exact_pages &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; exact=</span><span class="Special">%ld</span><span class="Constant">&quot;</span>, planstate-&gt;exact_pages);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (planstate-&gt;lossy_pages &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; lossy=</span><span class="Special">%ld</span><span class="Constant">&quot;</span>, planstate-&gt;lossy_pages);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * If it's EXPLAIN ANALYZE, show instrumentation information for a plan node<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * &quot;which&quot; identifies which instrumentation counter to <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a><br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3615">&#x200c;</a></span><span class="linkable">show_instrumentation_count</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type">int</span> which,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; PlanState *planstate, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; nfiltered;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; nloops;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (!es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> || !planstate-&gt;instrument)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (which == <span class="Constant">2</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; nfiltered = planstate-&gt;instrument-&gt;nfiltered2;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; nfiltered = planstate-&gt;instrument-&gt;nfiltered1;<br/></li>
<li>&nbsp; &nbsp; nloops = planstate-&gt;instrument-&gt;nloops;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* In text mode, suppress zero counts; they're not interesting enough */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (nfiltered &gt; <span class="Constant">0</span> || es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (nloops &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(qlabel, <span class="Constant">NULL</span>, nfiltered / nloops, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(qlabel, <span class="Constant">NULL</span>, <span class="Constant">0.0</span>, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show extra information for a ForeignScan node.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3644">&#x200c;</a></span><span class="linkable">show_foreignscan_info</span>(ForeignScanState *fsstate, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; FdwRoutine *fdwroutine = fsstate-&gt;fdwroutine;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Let the FDW emit whatever fields it wants */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (((ForeignScan *) fsstate-&gt;ss.ps.plan)-&gt;operation != CMD_SELECT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (fdwroutine-&gt;ExplainDirectModify != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fdwroutine-&gt;ExplainDirectModify(fsstate, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (fdwroutine-&gt;ExplainForeignScan != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fdwroutine-&gt;ExplainForeignScan(fsstate, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Fetch the name of an index in an EXPLAIN<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * We allow plugins to get control here so that plans involving hypothetical<br/></li>
<li></span><span class="Comment"> * indexes can be explained.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Note: names returned by this function should be &quot;raw&quot;; the caller will<br/></li>
<li></span><span class="Comment"> * apply quoting if needed.&nbsp; Formerly the convention was to do quoting here,<br/></li>
<li></span><span class="Comment"> * but we don't want that in non-text output formats.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">const</span> <span class="Type">char</span> *<br/></li>
<li><a id="L3672">&#x200c;</a><span class="linkable">explain_get_index_name</span>(Oid indexId)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *result;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (<a href="#L48" title="commands/explain.c:48">explain_get_index_name_hook</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; result = (*<a href="#L48" title="commands/explain.c:48">explain_get_index_name_hook</a>) (indexId);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; result = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (result == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* default behavior: look it up in the catalogs */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; result = <a href="../utils/cache/lsyscache.c.html#L1928" title="utils/cache/lsyscache.c:1928">get_rel_name</a>(indexId);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (result == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elog(ERROR, <span class="Constant">&quot;cache lookup failed for index </span><span class="Special">%u</span><span class="Constant">&quot;</span>, indexId);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> result;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Return whether <a href="#L3736" title="commands/explain.c:3736">show_buffer_usage</a> would have anything to <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a>, if given<br/></li>
<li></span><span class="Comment"> * the same 'usage' data.&nbsp; Note that when the format is anything other than<br/></li>
<li></span><span class="Comment"> * text, we <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> even if the counters are all zeroes.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a><br/></li>
<li><a id="L3696">&#x200c;</a></span><span class="linkable">peek_buffer_usage</span>(ExplainState *es, <span class="Type">const</span> BufferUsage *usage)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_shared;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_local;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_temp;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_shared_timing;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_local_timing;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_temp_timing;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (usage == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">false</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">true</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; has_shared = (usage-&gt;shared_blks_hit &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;shared_blks_read &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;shared_blks_dirtied &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;shared_blks_written &gt; <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; has_local = (usage-&gt;local_blks_hit &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_read &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_dirtied &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_written &gt; <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; has_temp = (usage-&gt;temp_blks_read &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;temp_blks_written &gt; <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; has_shared_timing = (!INSTR_TIME_IS_ZERO(usage-&gt;shared_blk_read_time) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; !INSTR_TIME_IS_ZERO(usage-&gt;shared_blk_write_time));<br/></li>
<li>&nbsp; &nbsp; has_local_timing = (!INSTR_TIME_IS_ZERO(usage-&gt;local_blk_read_time) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; !INSTR_TIME_IS_ZERO(usage-&gt;local_blk_write_time));<br/></li>
<li>&nbsp; &nbsp; has_temp_timing = (!INSTR_TIME_IS_ZERO(usage-&gt;temp_blk_read_time) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; !INSTR_TIME_IS_ZERO(usage-&gt;temp_blk_write_time));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> has_shared || has_local || has_temp || has_shared_timing ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; has_local_timing || has_temp_timing;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show buffer usage details.&nbsp; This better be sync with <a href="#L3696" title="commands/explain.c:3696">peek_buffer_usage</a>.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3736">&#x200c;</a></span><span class="linkable">show_buffer_usage</span>(ExplainState *es, <span class="Type">const</span> BufferUsage *usage)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_shared = (usage-&gt;shared_blks_hit &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;shared_blks_read &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;shared_blks_dirtied &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;shared_blks_written &gt; <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_local = (usage-&gt;local_blks_hit &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_read &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_dirtied &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_written &gt; <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_temp = (usage-&gt;temp_blks_read &gt; <span class="Constant">0</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;temp_blks_written &gt; <span class="Constant">0</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_shared_timing = (!INSTR_TIME_IS_ZERO(usage-&gt;shared_blk_read_time) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; !INSTR_TIME_IS_ZERO(usage-&gt;shared_blk_write_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_local_timing = (!INSTR_TIME_IS_ZERO(usage-&gt;local_blk_read_time) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; !INSTR_TIME_IS_ZERO(usage-&gt;local_blk_write_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; has_temp_timing = (!INSTR_TIME_IS_ZERO(usage-&gt;temp_blk_read_time) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; !INSTR_TIME_IS_ZERO(usage-&gt;temp_blk_write_time));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Show only positive counter <a href="../bootstrap/bootstrap.c.html#L152" title="bootstrap/bootstrap.c:152">values</a>. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_shared || has_local || has_temp)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;Buffers:&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_shared)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; shared&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;shared_blks_hit &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; hit=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;shared_blks_hit);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;shared_blks_read &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; read=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;shared_blks_read);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;shared_blks_dirtied &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; dirtied=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;shared_blks_dirtied);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;shared_blks_written &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; written=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;shared_blks_written);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_local || has_temp)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">','</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_local)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; local&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;local_blks_hit &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; hit=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;local_blks_hit);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;local_blks_read &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; read=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;local_blks_read);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;local_blks_dirtied &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; dirtied=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;local_blks_dirtied);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;local_blks_written &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; written=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;local_blks_written);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_temp)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">','</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_temp)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; temp&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;temp_blks_read &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; read=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;temp_blks_read);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;temp_blks_written &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; written=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;temp_blks_written);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* As above, show only positive counter <a href="../bootstrap/bootstrap.c.html#L152" title="bootstrap/bootstrap.c:152">values</a>. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_shared_timing || has_local_timing || has_temp_timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;I/O Timings:&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_shared_timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; shared&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!INSTR_TIME_IS_ZERO(usage-&gt;shared_blk_read_time))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; read=</span><span class="Special">%0.3f</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;shared_blk_read_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!INSTR_TIME_IS_ZERO(usage-&gt;shared_blk_write_time))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; write=</span><span class="Special">%0.3f</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;shared_blk_write_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_local_timing || has_temp_timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">','</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_local_timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; local&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!INSTR_TIME_IS_ZERO(usage-&gt;local_blk_read_time))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; read=</span><span class="Special">%0.3f</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;local_blk_read_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!INSTR_TIME_IS_ZERO(usage-&gt;local_blk_write_time))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; write=</span><span class="Special">%0.3f</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;local_blk_write_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_temp_timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">','</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (has_temp_timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; temp&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!INSTR_TIME_IS_ZERO(usage-&gt;temp_blk_read_time))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; read=</span><span class="Special">%0.3f</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;temp_blk_read_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!INSTR_TIME_IS_ZERO(usage-&gt;temp_blk_write_time))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; write=</span><span class="Special">%0.3f</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;temp_blk_write_time));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Shared Hit Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;shared_blks_hit, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Shared Read Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;shared_blks_read, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Shared Dirtied Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;shared_blks_dirtied, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Shared Written Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;shared_blks_written, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Local Hit Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_hit, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Local Read Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_read, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Local Dirtied Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_dirtied, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Local Written Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;local_blks_written, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Temp Read Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;temp_blks_read, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Temp Written Blocks&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;temp_blks_written, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../storage/buffer/bufmgr.c.html#L142" title="storage/buffer/bufmgr.c:142">track_io_timing</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Shared I/O Read Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;shared_blk_read_time),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Shared I/O Write Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;shared_blk_write_time),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Local I/O Read Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;local_blk_read_time),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Local I/O Write Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;local_blk_write_time),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Temp I/O Read Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;temp_blk_read_time),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Temp I/O Write Time&quot;</span>, <span class="Constant">&quot;ms&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INSTR_TIME_GET_MILLISEC(usage-&gt;temp_blk_write_time),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">3</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show WAL usage details.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3905">&#x200c;</a></span><span class="linkable">show_wal_usage</span>(ExplainState *es, <span class="Type">const</span> WalUsage *usage)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Show only positive counter <a href="../bootstrap/bootstrap.c.html#L152" title="bootstrap/bootstrap.c:152">values</a>. */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> ((usage-&gt;wal_records &gt; <span class="Constant">0</span>) || (usage-&gt;wal_fpi &gt; <span class="Constant">0</span>) ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (usage-&gt;wal_bytes &gt; <span class="Constant">0</span>))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;WAL:&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;wal_records &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; <a href="../access/transam/twophase.c.html#L1025" title="access/transam/twophase.c:1025">records</a>=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;wal_records);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;wal_fpi &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; fpi=</span><span class="Special">%lld</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) usage-&gt;wal_fpi);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (usage-&gt;wal_bytes &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; bytes=&quot;</span> UINT64_FORMAT,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;wal_bytes);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;WAL Records&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;wal_records, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;WAL FPI&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; usage-&gt;wal_fpi, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4817" title="commands/explain.c:4817">ExplainPropertyUInteger</a>(<span class="Constant">&quot;WAL Bytes&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; usage-&gt;wal_bytes, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show memory usage details.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3943">&#x200c;</a></span><span class="linkable">show_memory_counters</span>(ExplainState *es, <span class="Type">const</span> MemoryContextCounters *mem_counters)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;Memory: used=</span><span class="Special">%lld</span><span class="Constant"> bytes&nbsp; allocated=</span><span class="Special">%lld</span><span class="Constant"> bytes&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) (mem_counters-&gt;totalspace - mem_counters-&gt;freespace),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">long</span> <span class="Type">long</span>) mem_counters-&gt;totalspace);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Memory Used&quot;</span>, <span class="Constant">&quot;bytes&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mem_counters-&gt;totalspace - mem_counters-&gt;freespace,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Memory Allocated&quot;</span>, <span class="Constant">&quot;bytes&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mem_counters-&gt;totalspace, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Add some additional details about an IndexScan or IndexOnlyScan<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L3969">&#x200c;</a></span><span class="linkable">ExplainIndexScanDetails</span>(Oid indexid, ScanDirection indexorderdir,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *indexname = <a href="#L3672" title="commands/explain.c:3672">explain_get_index_name</a>(indexid);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (ScanDirectionIsBackward(indexorderdir))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; Backward&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; using </span><span class="Special">%s</span><span class="Constant">&quot;</span>, <a href="../utils/adt/ruleutils.c.html#L12623" title="utils/adt/ruleutils.c:12623">quote_identifier</a>(indexname));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *scandir;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (indexorderdir)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> BackwardScanDirection:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scandir = <span class="Constant">&quot;Backward&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> ForwardScanDirection:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scandir = <span class="Constant">&quot;Forward&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scandir = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Scan Direction&quot;</span>, scandir, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Index Name&quot;</span>, indexname, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show the target of a Scan node<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4005">&#x200c;</a></span><span class="linkable">ExplainScanTarget</span>(Scan *plan, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L4027" title="commands/explain.c:4027">ExplainTargetRel</a>((Plan *) plan, plan-&gt;scanrelid, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show the target of a ModifyTable node<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Here we show the nominal target (ie, the relation that was named in the<br/></li>
<li></span><span class="Comment"> * original query).&nbsp; If the actual target(s) is/are different, we'll show them<br/></li>
<li></span><span class="Comment"> * in <a href="#L4165" title="commands/explain.c:4165">show_modifytable_info</a>().<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4018">&#x200c;</a></span><span class="linkable">ExplainModifyTarget</span>(ModifyTable *plan, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L4027" title="commands/explain.c:4027">ExplainTargetRel</a>((Plan *) plan, plan-&gt;nominalRelation, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show the target relation of a scan or modify node<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4027">&#x200c;</a></span><span class="linkable">ExplainTargetRel</span>(Plan *plan, Index rti, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *objectname = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *namespace = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *objecttag = <span class="Constant">NULL</span>;<br/></li>
<li>&nbsp; &nbsp; RangeTblEntry *rte;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *refname;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; rte = rt_fetch(rti, es-&gt;rtable);<br/></li>
<li>&nbsp; &nbsp; refname = (<span class="Type">char</span> *) list_nth(es-&gt;rtable_names, rti - <span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (refname == <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; refname = rte-&gt;eref-&gt;aliasname;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (nodeTag(plan))<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SeqScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_SampleScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_IndexOnlyScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_BitmapHeapScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TidRangeScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ForeignScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CustomScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ModifyTable:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Assert it's on a real relation */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(rte-&gt;rtekind == RTE_RELATION);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objectname = <a href="../utils/cache/lsyscache.c.html#L1928" title="utils/cache/lsyscache.c:1928">get_rel_name</a>(rte-&gt;relid);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;verbose)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; namespace = <a href="../utils/cache/lsyscache.c.html#L3390" title="utils/cache/lsyscache.c:3390">get_namespace_name_or_temp</a>(<a href="../utils/cache/lsyscache.c.html#L1952" title="utils/cache/lsyscache.c:1952">get_rel_namespace</a>(rte-&gt;relid));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objecttag = <span class="Constant">&quot;Relation Name&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_FunctionScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FunctionScan *fscan = (FunctionScan *) plan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Assert it's on a RangeFunction */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(rte-&gt;rtekind == RTE_FUNCTION);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * If the expression is still a function call of a single<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * function, we can get the real name of the function.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Otherwise, punt.&nbsp; (Even if it was a single function call<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * originally, the optimizer could have simplified it away.)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (list_length(fscan-&gt;<a href="../regex/regcomp.c.html#L356" title="regex/regcomp.c:356">functions</a>) == <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RangeTblFunction *rtfunc = (RangeTblFunction *) linitial(fscan-&gt;<a href="../regex/regcomp.c.html#L356" title="regex/regcomp.c:356">functions</a>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (IsA(rtfunc-&gt;funcexpr, FuncExpr))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FuncExpr&nbsp;&nbsp; *funcexpr = (FuncExpr *) rtfunc-&gt;funcexpr;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Oid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; funcid = funcexpr-&gt;funcid;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objectname = <a href="../utils/cache/lsyscache.c.html#L1608" title="utils/cache/lsyscache.c:1608">get_func_name</a>(funcid);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;verbose)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; namespace = <a href="../utils/cache/lsyscache.c.html#L3390" title="utils/cache/lsyscache.c:3390">get_namespace_name_or_temp</a>(<a href="../utils/cache/lsyscache.c.html#L1632" title="utils/cache/lsyscache.c:1632">get_func_namespace</a>(funcid));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objecttag = <span class="Constant">&quot;Function Name&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_TableFuncScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TableFunc&nbsp; *tablefunc = ((TableFuncScan *) plan)-&gt;tablefunc;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(rte-&gt;rtekind == RTE_TABLEFUNC);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">switch</span> (tablefunc-&gt;functype)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> TFT_XMLTABLE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objectname = <span class="Constant">&quot;xmltable&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> TFT_JSON_TABLE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objectname = <span class="Constant">&quot;json_table&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elog(ERROR, <span class="Constant">&quot;invalid TableFunc type </span><span class="Special">%d</span><span class="Constant">&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<span class="Type">int</span>) tablefunc-&gt;functype);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objecttag = <span class="Constant">&quot;Table Function Name&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_ValuesScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(rte-&gt;rtekind == RTE_VALUES);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_CteScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Assert it's on a non-self-reference CTE */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(rte-&gt;rtekind == RTE_CTE);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(!rte-&gt;self_reference);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objectname = rte-&gt;ctename;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objecttag = <span class="Constant">&quot;CTE Name&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_NamedTuplestoreScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(rte-&gt;rtekind == RTE_NAMEDTUPLESTORE);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objectname = rte-&gt;enrname;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objecttag = <span class="Constant">&quot;Tuplestore Name&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> T_WorkTableScan:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Assert it's on a self-reference CTE */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(rte-&gt;rtekind == RTE_CTE);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(rte-&gt;self_reference);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objectname = rte-&gt;ctename;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objecttag = <span class="Constant">&quot;CTE Name&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; on&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (namespace != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant">.</span><span class="Special">%s</span><span class="Constant">&quot;</span>, <a href="../utils/adt/ruleutils.c.html#L12623" title="utils/adt/ruleutils.c:12623">quote_identifier</a>(namespace),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/adt/ruleutils.c.html#L12623" title="utils/adt/ruleutils.c:12623">quote_identifier</a>(objectname));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (objectname != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant">&quot;</span>, <a href="../utils/adt/ruleutils.c.html#L12623" title="utils/adt/ruleutils.c:12623">quote_identifier</a>(objectname));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (objectname == <span class="Constant">NULL</span> || strcmp(refname, objectname) != <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; </span><span class="Special">%s</span><span class="Constant">&quot;</span>, <a href="../utils/adt/ruleutils.c.html#L12623" title="utils/adt/ruleutils.c:12623">quote_identifier</a>(refname));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (objecttag != <span class="Constant">NULL</span> &amp;&amp; objectname != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(objecttag, objectname, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (namespace != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Schema&quot;</span>, namespace, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Alias&quot;</span>, refname, es);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Show extra information for a ModifyTable node<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * We have three objectives here.&nbsp; First, if there's more than one target<br/></li>
<li></span><span class="Comment"> * table or it's different from the nominal target, identify the actual<br/></li>
<li></span><span class="Comment"> * target(s).&nbsp; Second, give FDWs a chance to display extra info about foreign<br/></li>
<li></span><span class="Comment"> * targets.&nbsp; Third, show information about ON CONFLICT.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4165">&#x200c;</a></span><span class="linkable">show_modifytable_info</span>(ModifyTableState *mtstate, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ModifyTable *node = (ModifyTable *) mtstate-&gt;ps.plan;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *operation;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *foperation;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; labeltargets;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; j;<br/></li>
<li>&nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *idxNames = NIL;<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lst;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (node-&gt;operation)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_INSERT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;<a href="../storage/file/fd.c.html#L1313" title="storage/file/fd.c:1313">Insert</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foperation = <span class="Constant">&quot;Foreign <a href="../storage/file/fd.c.html#L1313" title="storage/file/fd.c:1313">Insert</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_UPDATE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;Update&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foperation = <span class="Constant">&quot;Foreign Update&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_DELETE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;<a href="../storage/file/fd.c.html#L1268" title="storage/file/fd.c:1268">Delete</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foperation = <span class="Constant">&quot;Foreign <a href="../storage/file/fd.c.html#L1268" title="storage/file/fd.c:1268">Delete</a>&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> CMD_MERGE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;Merge&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* </span><span class="Todo">XXX</span><span class="Comment"> unsupported for <a href="../utils/adt/timestamp.c.html#L1618" title="utils/adt/timestamp.c:1618">now</a>, but avoid compiler noise */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foperation = <span class="Constant">&quot;Foreign Merge&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">default</span>:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; operation = <span class="Constant">&quot;???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foperation = <span class="Constant">&quot;Foreign ???&quot;</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Should we explicitly label target relations? */<br/></li>
<li></span>&nbsp; &nbsp; labeltargets = (mtstate-&gt;mt_nrels &gt; <span class="Constant">1</span> ||<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (mtstate-&gt;mt_nrels == <span class="Constant">1</span> &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mtstate-&gt;resultRelInfo[<span class="Constant">0</span>].ri_RangeTableIndex != node-&gt;nominalRelation));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (labeltargets)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Target Tables&quot;</span>, <span class="Constant">&quot;Target Tables&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (j = <span class="Constant">0</span>; j &lt; mtstate-&gt;mt_nrels; j++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ResultRelInfo *resultRelInfo = mtstate-&gt;resultRelInfo + j;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; FdwRoutine *fdwroutine = resultRelInfo-&gt;ri_FdwRoutine;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (labeltargets)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Open a group for this target */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Target Table&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * In text mode, decorate each target with operation type, so that<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * <a href="#L4027" title="commands/explain.c:4027">ExplainTargetRel</a>'s output of &quot; on foo&quot; will read nicely.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; fdwroutine ? foperation : operation);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Identify target */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4027" title="commands/explain.c:4027">ExplainTargetRel</a>((Plan *) node,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; resultRelInfo-&gt;ri_RangeTableIndex,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Give FDW a chance if needed */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!resultRelInfo-&gt;ri_usesFdwDirectModify &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fdwroutine != <span class="Constant">NULL</span> &amp;&amp;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fdwroutine-&gt;ExplainForeignModify != <span class="Constant">NULL</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; List&nbsp; &nbsp; &nbsp;&nbsp; *fdw_private = (List *) list_nth(node-&gt;fdwPrivLists, j);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fdwroutine-&gt;ExplainForeignModify(mtstate,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; resultRelInfo,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; fdw_private,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; j,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (labeltargets)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Undo the indentation we added in text format */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Close the group */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Target Table&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Gather names of ON CONFLICT arbiter indexes */<br/></li>
<li></span>&nbsp; &nbsp; foreach(lst, node-&gt;arbiterIndexes)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *indexname = <a href="../utils/cache/lsyscache.c.html#L1928" title="utils/cache/lsyscache.c:1928">get_rel_name</a>(lfirst_oid(lst));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; idxNames = <a href="../nodes/list.c.html#L339" title="nodes/list.c:339">lappend</a>(idxNames, indexname);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (node-&gt;onConflictAction != ONCONFLICT_NONE)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>(<span class="Constant">&quot;Conflict Resolution&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node-&gt;onConflictAction == ONCONFLICT_NOTHING ?<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;NOTHING&quot;</span> : <span class="Constant">&quot;UPDATE&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Don't display arbiter indexes at all when DO NOTHING variant<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * implicitly ignores all conflicts<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (idxNames)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4619" title="commands/explain.c:4619">ExplainPropertyList</a>(<span class="Constant">&quot;Conflict Arbiter Indexes&quot;</span>, idxNames, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* ON CONFLICT DO UPDATE WHERE qual is specially displayed */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (node-&gt;onConflictWhere)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L2538" title="commands/explain.c:2538">show_upper_qual</a>((List *) node-&gt;onConflictWhere, <span class="Constant">&quot;Conflict Filter&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;mtstate-&gt;ps, ancestors, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L3615" title="commands/explain.c:3615">show_instrumentation_count</a>(<span class="Constant">&quot;Rows Removed by Conflict Filter&quot;</span>, <span class="Constant">1</span>, &amp;mtstate-&gt;ps, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* EXPLAIN ANALYZE display of actual outcome for each tuple proposed */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; mtstate-&gt;ps.instrument)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; total;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; insert_path;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; other_path;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/instrument.c.html#L140" title="executor/instrument.c:140">InstrEndLoop</a>(outerPlanState(mtstate)-&gt;instrument);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* count the number of source rows */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total = outerPlanState(mtstate)-&gt;instrument-&gt;ntuples;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; other_path = mtstate-&gt;ps.instrument-&gt;ntuples2;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; insert_path = total - other_path;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Tuples Inserted&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; insert_path, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Conflicting Tuples&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; other_path, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (node-&gt;operation == CMD_MERGE)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* EXPLAIN ANALYZE display of tuples processed */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;<a href="../regex/regc_nfa.c.html#L3016" title="regex/regc_nfa.c:3016">analyze</a> &amp;&amp; mtstate-&gt;ps.instrument)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; total;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; insert_path;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; update_path;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; delete_path;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">double</span>&nbsp; &nbsp; &nbsp; &nbsp; skipped_path;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/instrument.c.html#L140" title="executor/instrument.c:140">InstrEndLoop</a>(outerPlanState(mtstate)-&gt;instrument);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* count the number of source rows */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total = outerPlanState(mtstate)-&gt;instrument-&gt;ntuples;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; insert_path = mtstate-&gt;mt_merge_inserted;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; update_path = mtstate-&gt;mt_merge_updated;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; delete_path = mtstate-&gt;mt_merge_deleted;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skipped_path = total - insert_path - update_path - delete_path;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(skipped_path &gt;= <span class="Constant">0</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (total &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;Tuples:&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (insert_path &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; inserted=</span><span class="Special">%.0f</span><span class="Constant">&quot;</span>, insert_path);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (update_path &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; updated=</span><span class="Special">%.0f</span><span class="Constant">&quot;</span>, update_path);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (delete_path &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; deleted=</span><span class="Special">%.0f</span><span class="Constant">&quot;</span>, delete_path);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (skipped_path &gt; <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot; skipped=</span><span class="Special">%.0f</span><span class="Constant">&quot;</span>, skipped_path);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Tuples Inserted&quot;</span>, <span class="Constant">NULL</span>, insert_path, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Tuples Updated&quot;</span>, <span class="Constant">NULL</span>, update_path, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Tuples Deleted&quot;</span>, <span class="Constant">NULL</span>, delete_path, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4831" title="commands/explain.c:4831">ExplainPropertyFloat</a>(<span class="Constant">&quot;Tuples Skipped&quot;</span>, <span class="Constant">NULL</span>, skipped_path, <span class="Constant">0</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (labeltargets)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Target Tables&quot;</span>, <span class="Constant">&quot;Target Tables&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain the constituent plans of an Append, MergeAppend,<br/></li>
<li></span><span class="Comment"> * BitmapAnd, or BitmapOr node.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The ancestors list should already contain the immediate parent of these<br/></li>
<li></span><span class="Comment"> * plans.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4377">&#x200c;</a></span><span class="linkable">ExplainMemberNodes</span>(PlanState **planstates, <span class="Type">int</span> nplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; j;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (j = <span class="Constant">0</span>; j &lt; nplans; j++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a>(planstates[j], ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Constant">&quot;Member&quot;</span>, <span class="Constant">NULL</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Report about <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> pruned subnodes of an Append or MergeAppend node.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * nplans indicates the number of live subplans.<br/></li>
<li></span><span class="Comment"> * nchildren indicates the original number of subnodes in the Plan;<br/></li>
<li></span><span class="Comment"> * some of these may have been pruned by the run-time pruning code.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4395">&#x200c;</a></span><span class="linkable">ExplainMissingMembers</span>(<span class="Type">int</span> nplans, <span class="Type">int</span> nchildren, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (nplans &lt; nchildren || es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Subplans Removed&quot;</span>, <span class="Constant">NULL</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; nchildren - nplans, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain a list of SubPlans (or initPlans, which also use SubPlan nodes).<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The ancestors list should already contain the immediate parent of these<br/></li>
<li></span><span class="Comment"> * SubPlans.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4409">&#x200c;</a></span><span class="linkable">ExplainSubPlans</span>(List *plans, List *ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *relationship, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lst;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; foreach(lst, plans)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; SubPlanState *sps = (SubPlanState *) lfirst(lst);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; SubPlan&nbsp; &nbsp; *sp = sps-&gt;subplan;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * There can be multiple SubPlan nodes referencing the same physical<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * subplan (same plan_id, which is its index in PlannedStmt.subplans).<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * We should <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a> a subplan only once, so track which ones we already<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * printed.&nbsp; This state must be global across the plan tree, since the<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * duplicate nodes could be in different plan nodes, eg both a bitmap<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * indexscan's indexqual and its parent heapscan's recheck qual.&nbsp; (We<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * do not worry too much about which plan node we show the subplan as<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * attached to in such cases.)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../nodes/bitmapset.c.html#L510" title="nodes/bitmapset.c:510">bms_is_member</a>(sp-&gt;plan_id, es-&gt;printed_subplans))<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;printed_subplans = <a href="../nodes/bitmapset.c.html#L815" title="nodes/bitmapset.c:815">bms_add_member</a>(es-&gt;printed_subplans,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp-&gt;plan_id);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Treat the SubPlan node as an ancestor of the plan node(s) within<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * it, so that ruleutils.c can <a href="../regex/regexec.c.html#L419" title="regex/regexec.c:419">find</a> the referents of subplan<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * parameters.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; ancestors = <a href="../nodes/list.c.html#L495" title="nodes/list.c:495">lcons</a>(sp, ancestors);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a>(sps-&gt;planstate, ancestors,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; relationship, sp-&gt;plan_name, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; ancestors = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(ancestors);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain a list of children of a CustomScan.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4452">&#x200c;</a></span><span class="linkable">ExplainCustomChildren</span>(CustomScanState *css, List *ancestors, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *cell;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *label =<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; (list_length(css-&gt;custom_ps) != <span class="Constant">1</span> ? <span class="Constant">&quot;children&quot;</span> : <span class="Constant">&quot;child&quot;</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; foreach(cell, css-&gt;custom_ps)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L1360" title="commands/explain.c:1360">ExplainNode</a>((PlanState *) lfirst(cell), ancestors, label, <span class="Constant">NULL</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Create a per-plan-node workspace for collecting per-worker data.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Output related to each worker will be temporarily &quot;set aside&quot; into a<br/></li>
<li></span><span class="Comment"> * separate buffer, which we'll <a href="../lib/pairingheap.c.html#L79" title="lib/pairingheap.c:79">merge</a> into the <a href="../storage/lmgr/s_lock.c.html#L257" title="storage/lmgr/s_lock.c:257">main</a> output stream once<br/></li>
<li></span><span class="Comment"> * we've processed all data for the plan node.&nbsp; This makes it feasible to<br/></li>
<li></span><span class="Comment"> * generate a coherent sub-group of fields for each worker, even though the<br/></li>
<li></span><span class="Comment"> * code that produces the fields is in several different places in this file.<br/></li>
<li></span><span class="Comment"> * Formatting of such a set-aside field group is managed by<br/></li>
<li></span><span class="Comment"> * <a href="#L4970" title="commands/explain.c:4970">ExplainOpenSetAsideGroup</a> and <a href="#L5009" title="commands/explain.c:5009">ExplainSaveGroup</a>/<a href="#L5039" title="commands/explain.c:5039">ExplainRestoreGroup</a>.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> ExplainWorkersState *<br/></li>
<li><a id="L4474">&#x200c;</a><span class="linkable">ExplainCreateWorkersState</span>(<span class="Type">int</span> num_workers)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ExplainWorkersState *wstate;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; wstate = (ExplainWorkersState *) <a href="../utils/mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>(<span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(ExplainWorkersState));<br/></li>
<li>&nbsp; &nbsp; wstate-&gt;num_workers = num_workers;<br/></li>
<li>&nbsp; &nbsp; wstate-&gt;worker_inited = (<span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> *) <a href="../utils/mmgr/mcxt.c.html#L1346" title="utils/mmgr/mcxt.c:1346">palloc0</a>(num_workers * <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(<span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>));<br/></li>
<li>&nbsp; &nbsp; wstate-&gt;worker_str = (StringInfoData *)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1346" title="utils/mmgr/mcxt.c:1346">palloc0</a>(num_workers * <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(StringInfoData));<br/></li>
<li>&nbsp; &nbsp; wstate-&gt;worker_state_save = (<span class="Type">int</span> *) <a href="../utils/mmgr/mcxt.c.html#L1316" title="utils/mmgr/mcxt.c:1316">palloc</a>(num_workers * <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(<span class="Type">int</span>));<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> wstate;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Begin or resume output into the set-aside group for worker N.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4491">&#x200c;</a></span><span class="linkable">ExplainOpenWorker</span>(<span class="Type">int</span> n, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ExplainWorkersState *wstate = es-&gt;workers_state;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; Assert(wstate);<br/></li>
<li>&nbsp; &nbsp; Assert(n &gt;= <span class="Constant">0</span> &amp;&amp; n &lt; wstate-&gt;num_workers);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Save prior output buffer pointer */<br/></li>
<li></span>&nbsp; &nbsp; wstate-&gt;prev_str = es-&gt;str;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (!wstate-&gt;worker_inited[n])<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* First time through, so create the buffer for this worker */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; initStringInfo(&amp;wstate-&gt;worker_str[n]);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;str = &amp;wstate-&gt;worker_str[n];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Push suitable initial formatting state for this worker's field<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * group.&nbsp; We allow one extra logical nesting level, since this group<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * will eventually be wrapped in an outer &quot;Workers&quot; group.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4970" title="commands/explain.c:4970">ExplainOpenSetAsideGroup</a>(<span class="Constant">&quot;Worker&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, <span class="Constant">2</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * In non-TEXT formats we always emit a &quot;Worker Number&quot; field, even if<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * there's no other data for this worker.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format != EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>(<span class="Constant">&quot;Worker Number&quot;</span>, <span class="Constant">NULL</span>, n, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; wstate-&gt;worker_inited[n] = <span class="Constant">true</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Resuming output for a worker we've already emitted some data for */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;str = &amp;wstate-&gt;worker_str[n];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Restore formatting state saved by last <a href="#L4553" title="commands/explain.c:4553">ExplainCloseWorker</a>() */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5039" title="commands/explain.c:5039">ExplainRestoreGroup</a>(es, <span class="Constant">2</span>, &amp;wstate-&gt;worker_state_save[n]);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * In TEXT format, prefix the first output line for this worker with<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * &quot;Worker N:&quot;.&nbsp; Then, <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> additional lines should be indented one more<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * stop than the &quot;Worker N&quot; line is.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;str-&gt;len == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;Worker </span><span class="Special">%d</span><span class="Constant">:&nbsp; &quot;</span>, n);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * End output for worker N --- must pair with previous <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a> call<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4553">&#x200c;</a></span><span class="linkable">ExplainCloseWorker</span>(<span class="Type">int</span> n, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ExplainWorkersState *wstate = es-&gt;workers_state;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; Assert(wstate);<br/></li>
<li>&nbsp; &nbsp; Assert(n &gt;= <span class="Constant">0</span> &amp;&amp; n &lt; wstate-&gt;num_workers);<br/></li>
<li>&nbsp; &nbsp; Assert(wstate-&gt;worker_inited[n]);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Save formatting state in case we do another <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>(), then<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * pop the formatting stack.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L5009" title="commands/explain.c:5009">ExplainSaveGroup</a>(es, <span class="Constant">2</span>, &amp;wstate-&gt;worker_state_save[n]);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * In TEXT format, if we didn't actually produce <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> output line(s) then<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * truncate off the partial line emitted by <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>.&nbsp; (This is<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * to avoid bogus output if, say, <a href="#L3736" title="commands/explain.c:3736">show_buffer_usage</a> chooses not to <a href="../nodes/print.c.html#L36" title="nodes/print.c:36">print</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * anything for the worker.)&nbsp; Also fix up the indent level.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;format == EXPLAIN_FORMAT_TEXT)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">while</span> (es-&gt;str-&gt;len &gt; <span class="Constant">0</span> &amp;&amp; es-&gt;str-&gt;data[es-&gt;str-&gt;len - <span class="Constant">1</span>] != <span class="Special">'\n'</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;str-&gt;data[--(es-&gt;str-&gt;len)] = <span class="Special">'\0'</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Restore prior output buffer pointer */<br/></li>
<li></span>&nbsp; &nbsp; es-&gt;str = wstate-&gt;prev_str;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Print per-worker info for current node, then free the ExplainWorkersState.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4589">&#x200c;</a></span><span class="linkable">ExplainFlushWorkersState</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ExplainWorkersState *wstate = es-&gt;workers_state;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Workers&quot;</span>, <span class="Constant">&quot;Workers&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; wstate-&gt;num_workers; i++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (wstate-&gt;worker_inited[i])<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* This must match previous <a href="#L4970" title="commands/explain.c:4970">ExplainOpenSetAsideGroup</a> call */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a>(<span class="Constant">&quot;Worker&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, wstate-&gt;worker_str[i].data);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Worker&quot;</span>, <span class="Constant">NULL</span>, <span class="Constant">true</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(wstate-&gt;worker_str[i].data);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <a href="#L4923" title="commands/explain.c:4923">ExplainCloseGroup</a>(<span class="Constant">&quot;Workers&quot;</span>, <span class="Constant">&quot;Workers&quot;</span>, <span class="Constant">false</span>, es);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(wstate-&gt;worker_inited);<br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(wstate-&gt;worker_str);<br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(wstate-&gt;worker_state_save);<br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(wstate);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain a property, such as sort keys or targets, that takes the form of<br/></li>
<li></span><span class="Comment"> * a list of unlabeled items.&nbsp; &quot;data&quot; is a list of C strings.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4619">&#x200c;</a></span><span class="linkable">ExplainPropertyList</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, List *data, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; first = <span class="Constant">true</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant">: &quot;</span>, qlabel);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(lc, data)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!first)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;, &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, (<span class="Type">const</span> <span class="Type">char</span> *) lfirst(lc));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first = <span class="Constant">false</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>(qlabel, <a href="#L60" title="commands/explain.c:60">X_OPENING</a>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(lc, data)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *str;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span> + <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;&lt;Item&gt;&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; str = <a href="../utils/adt/xml.c.html#L2632" title="utils/adt/xml.c:2632">escape_xml</a>((<span class="Type">const</span> <span class="Type">char</span> *) lfirst(lc));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, str);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(str);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;&lt;/Item&gt;</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>(qlabel, <a href="#L61" title="commands/explain.c:61">X_CLOSING</a>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5247" title="commands/explain.c:5247">ExplainJSONLineEnding</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(es-&gt;str, qlabel);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;: [&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(lc, data)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!first)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;, &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(es-&gt;str, (<span class="Type">const</span> <span class="Type">char</span> *) lfirst(lc));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first = <span class="Constant">false</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">']'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5267" title="commands/explain.c:5267">ExplainYAMLLineStarting</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant">: &quot;</span>, qlabel);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(lc, data)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span> + <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;- &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5292" title="commands/explain.c:5292">escape_yaml</a>(es-&gt;str, (<span class="Type">const</span> <span class="Type">char</span> *) lfirst(lc));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain a property that takes the form of a list of unlabeled items within<br/></li>
<li></span><span class="Comment"> * another list.&nbsp; &quot;data&quot; is a list of C strings.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4689">&#x200c;</a></span><span class="linkable">ExplainPropertyListNested</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, List *data, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; ListCell&nbsp;&nbsp; *lc;<br/></li>
<li>&nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; first = <span class="Constant">true</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L4619" title="commands/explain.c:4619">ExplainPropertyList</a>(qlabel, data, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5247" title="commands/explain.c:5247">ExplainJSONLineEnding</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">'['</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(lc, data)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!first)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;, &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(es-&gt;str, (<span class="Type">const</span> <span class="Type">char</span> *) lfirst(lc));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first = <span class="Constant">false</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">']'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5267" title="commands/explain.c:5267">ExplainYAMLLineStarting</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;- [&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(lc, data)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (!first)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;, &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5292" title="commands/explain.c:5292">escape_yaml</a>(es-&gt;str, (<span class="Type">const</span> <span class="Type">char</span> *) lfirst(lc));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first = <span class="Constant">false</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">']'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain a simple property.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * If &quot;<a href="../utils/adt/numeric.c.html#L1237" title="utils/adt/numeric.c:1237">numeric</a>&quot; is true, the value is a number (or other value that<br/></li>
<li></span><span class="Comment"> * doesn't need quoting in JSON).<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * If unit is non-NULL the text format will display it after the value.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This usually should not be invoked directly, but via one of the datatype<br/></li>
<li></span><span class="Comment"> * specific routines <a href="#L4795" title="commands/explain.c:4795">ExplainPropertyText</a>, <a href="#L4804" title="commands/explain.c:4804">ExplainPropertyInteger</a>, etc.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4742">&#x200c;</a></span><span class="linkable">ExplainProperty</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type">const</span> <span class="Type">char</span> *unit, <span class="Type">const</span> <span class="Type">char</span> *value,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> <a href="../utils/adt/numeric.c.html#L1237" title="utils/adt/numeric.c:1237">numeric</a>, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5232" title="commands/explain.c:5232">ExplainIndentText</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (unit)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant">: </span><span class="Special">%s</span><span class="Constant"> </span><span class="Special">%s\n</span><span class="Constant">&quot;</span>, qlabel, value, unit);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant">: </span><span class="Special">%s\n</span><span class="Constant">&quot;</span>, qlabel, value);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *str;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>(qlabel, <a href="#L60" title="commands/explain.c:60">X_OPENING</a> | <a href="#L63" title="commands/explain.c:63">X_NOWHITESPACE</a>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; str = <a href="../utils/adt/xml.c.html#L2632" title="utils/adt/xml.c:2632">escape_xml</a>(value);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, str);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(str);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>(qlabel, <a href="#L61" title="commands/explain.c:61">X_CLOSING</a> | <a href="#L63" title="commands/explain.c:63">X_NOWHITESPACE</a>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5247" title="commands/explain.c:5247">ExplainJSONLineEnding</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(es-&gt;str, qlabel);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;: &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../utils/adt/numeric.c.html#L1237" title="utils/adt/numeric.c:1237">numeric</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, value);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(es-&gt;str, value);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5267" title="commands/explain.c:5267">ExplainYAMLLineStarting</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant">: &quot;</span>, qlabel);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (<a href="../utils/adt/numeric.c.html#L1237" title="utils/adt/numeric.c:1237">numeric</a>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, value);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5292" title="commands/explain.c:5292">escape_yaml</a>(es-&gt;str, value);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain a string-valued property.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4795">&#x200c;</a></span><span class="linkable">ExplainPropertyText</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type">const</span> <span class="Type">char</span> *value, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L4742" title="commands/explain.c:4742">ExplainProperty</a>(qlabel, <span class="Constant">NULL</span>, value, <span class="Constant">false</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain an integer-valued property.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4804">&#x200c;</a></span><span class="linkable">ExplainPropertyInteger</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type">const</span> <span class="Type">char</span> *unit, int64 value,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; buf[<span class="Constant">32</span>];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; snprintf(buf, <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(buf), INT64_FORMAT, value);<br/></li>
<li>&nbsp; &nbsp; <a href="#L4742" title="commands/explain.c:4742">ExplainProperty</a>(qlabel, unit, buf, <span class="Constant">true</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain an unsigned integer-valued property.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4817">&#x200c;</a></span><span class="linkable">ExplainPropertyUInteger</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type">const</span> <span class="Type">char</span> *unit, uint64 value,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp; &nbsp; buf[<span class="Constant">32</span>];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; snprintf(buf, <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(buf), UINT64_FORMAT, value);<br/></li>
<li>&nbsp; &nbsp; <a href="#L4742" title="commands/explain.c:4742">ExplainProperty</a>(qlabel, unit, buf, <span class="Constant">true</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain a float-valued property, using the specified number of<br/></li>
<li></span><span class="Comment"> * fractional digits.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4831">&#x200c;</a></span><span class="linkable">ExplainPropertyFloat</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type">const</span> <span class="Type">char</span> *unit, <span class="Type">double</span> value,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type">int</span> ndigits, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *buf;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; buf = psprintf(<span class="Constant">&quot;</span><span class="Special">%.*f</span><span class="Constant">&quot;</span>, ndigits, value);<br/></li>
<li>&nbsp; &nbsp; <a href="#L4742" title="commands/explain.c:4742">ExplainProperty</a>(qlabel, unit, buf, <span class="Constant">true</span>, es);<br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(buf);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Explain a <a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a>-valued property.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4845">&#x200c;</a></span><span class="linkable">ExplainPropertyBool</span>(<span class="Type">const</span> <span class="Type">char</span> *qlabel, <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> value, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L4742" title="commands/explain.c:4742">ExplainProperty</a>(qlabel, <span class="Constant">NULL</span>, value ? <span class="Constant">&quot;true&quot;</span> : <span class="Constant">&quot;false&quot;</span>, <span class="Constant">true</span>, es);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Open a group of related objects.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * objtype is the type of the group object, labelname is its label within<br/></li>
<li></span><span class="Comment"> * a containing object (if <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a>).<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * If labeled is true, the group members will be labeled properties,<br/></li>
<li></span><span class="Comment"> * while if it's false, they'll be unlabeled objects.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4860">&#x200c;</a></span><span class="linkable">ExplainOpenGroup</span>(<span class="Type">const</span> <span class="Type">char</span> *objtype, <span class="Type">const</span> <span class="Type">char</span> *labelname,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> labeled, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>(objtype, <a href="#L60" title="commands/explain.c:60">X_OPENING</a>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5247" title="commands/explain.c:5247">ExplainJSONLineEnding</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, <span class="Constant">2</span> * es-&gt;indent);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (labelname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(es-&gt;str, labelname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;: &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, labeled ? <span class="Constant">'{'</span> : <span class="Constant">'['</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * In JSON format, the grouping_stack is an integer list.&nbsp; 0 means<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * we've emitted nothing at this grouping level, 1 means we've<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * emitted something (and so the <a href="../regex/regc_lex.c.html#L200" title="regex/regc_lex.c:200">next</a> item needs a comma). See<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * <a href="#L5247" title="commands/explain.c:5247">ExplainJSONLineEnding</a>().<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(<span class="Constant">0</span>, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * In YAML format, the grouping stack is an integer list.&nbsp; 0 means<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * we've emitted nothing at this grouping level AND this grouping<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * level is unlabeled and must be marked with &quot;- &quot;.&nbsp; See<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * <a href="#L5267" title="commands/explain.c:5267">ExplainYAMLLineStarting</a>().<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5267" title="commands/explain.c:5267">ExplainYAMLLineStarting</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (labelname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfo(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">%s</span><span class="Constant">: &quot;</span>, labelname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(<span class="Constant">1</span>, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;- &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(<span class="Constant">0</span>, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Close a group of related objects.<br/></li>
<li></span><span class="Comment"> * Parameters must match the corresponding <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a> call.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L4923">&#x200c;</a></span><span class="linkable">ExplainCloseGroup</span>(<span class="Type">const</span> <span class="Type">char</span> *objtype, <span class="Type">const</span> <span class="Type">char</span> *labelname,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> labeled, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>(objtype, <a href="#L61" title="commands/explain.c:61">X_CLOSING</a>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, <span class="Constant">2</span> * es-&gt;indent);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, labeled ? <span class="Constant">'}'</span> : <span class="Constant">']'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Open a group of related objects, without emitting actual data.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * Prepare the formatting state as though we were beginning a group with<br/></li>
<li></span><span class="Comment"> * the identified properties, but don't actually emit anything.&nbsp; Output<br/></li>
<li></span><span class="Comment"> * subsequent to this call can be redirected into a separate output buffer,<br/></li>
<li></span><span class="Comment"> * and then eventually appended to the <a href="../storage/lmgr/s_lock.c.html#L257" title="storage/lmgr/s_lock.c:257">main</a> output buffer after doing a<br/></li>
<li></span><span class="Comment"> * regular <a href="#L4860" title="commands/explain.c:4860">ExplainOpenGroup</a> call (with the same parameters).<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * The extra &quot;depth&quot; parameter is the new group's depth compared to current.<br/></li>
<li></span><span class="Comment"> * It could be more than one, in case the eventual output will be enclosed<br/></li>
<li></span><span class="Comment"> * in additional nesting group levels.&nbsp; We assume we don't need to track<br/></li>
<li></span><span class="Comment"> * formatting state for those levels while preparing this group's output.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * There is no ExplainCloseSetAsideGroup --- in current usage, we always<br/></li>
<li></span><span class="Comment"> * pop this state with <a href="#L5009" title="commands/explain.c:5009">ExplainSaveGroup</a>.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L4970">&#x200c;</a></span><span class="linkable">ExplainOpenSetAsideGroup</span>(<span class="Type">const</span> <span class="Type">char</span> *objtype, <span class="Type">const</span> <span class="Type">char</span> *labelname,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span> labeled, <span class="Type">int</span> depth, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent += depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(<span class="Constant">0</span>, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent += depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (labelname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(<span class="Constant">1</span>, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(<span class="Constant">0</span>, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent += depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Pop one level of grouping state, allowing for a re-<a href="../regex/regc_nfa.c.html#L1884" title="regex/regc_nfa.c:1884">push</a> later.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This is typically used after <a href="#L4970" title="commands/explain.c:4970">ExplainOpenSetAsideGroup</a>; pass the<br/></li>
<li></span><span class="Comment"> * same &quot;depth&quot; used for that.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This should not emit <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> output.&nbsp; If state needs to be saved,<br/></li>
<li></span><span class="Comment"> * save it at *state_save.&nbsp; Currently, an integer save area is sufficient<br/></li>
<li></span><span class="Comment"> * for all formats, but we might need to revisit that someday.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5009">&#x200c;</a></span><span class="linkable">ExplainSaveGroup</span>(ExplainState *es, <span class="Type">int</span> depth, <span class="Type">int</span> *state_save)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent -= depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent -= depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *state_save = linitial_int(es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent -= depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *state_save = linitial_int(es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Re-<a href="../regex/regc_nfa.c.html#L1884" title="regex/regc_nfa.c:1884">push</a> one level of grouping state, undoing the effects of <a href="#L5009" title="commands/explain.c:5009">ExplainSaveGroup</a>.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5039">&#x200c;</a></span><span class="linkable">ExplainRestoreGroup</span>(ExplainState *es, <span class="Type">int</span> depth, <span class="Type">int</span> *state_save)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent += depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(*state_save, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent += depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(*state_save, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent += depth;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Emit a &quot;dummy&quot; group that never has <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> members.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * objtype is the type of the group object, labelname is its label within<br/></li>
<li></span><span class="Comment"> * a containing object (if <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a>).<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5070">&#x200c;</a></span><span class="linkable">ExplainDummyGroup</span>(<span class="Type">const</span> <span class="Type">char</span> *objtype, <span class="Type">const</span> <span class="Type">char</span> *labelname, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5205" title="commands/explain.c:5205">ExplainXMLTag</a>(objtype, <a href="#L62" title="commands/explain.c:62">X_CLOSE_IMMEDIATE</a>, es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5247" title="commands/explain.c:5247">ExplainJSONLineEnding</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, <span class="Constant">2</span> * es-&gt;indent);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (labelname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(es-&gt;str, labelname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;: &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(es-&gt;str, objtype);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5267" title="commands/explain.c:5267">ExplainYAMLLineStarting</a>(es);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (labelname)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5292" title="commands/explain.c:5292">escape_yaml</a>(es-&gt;str, labelname);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;: &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;- &quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5292" title="commands/explain.c:5292">escape_yaml</a>(es-&gt;str, objtype);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Emit the start-of-output boilerplate.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This is just enough different from processing a subgroup that we need<br/></li>
<li></span><span class="Comment"> * a separate pair of subroutines.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L5116">&#x200c;</a></span><span class="linkable">ExplainBeginOutput</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;&lt;explain xmlns=</span><span class="Special">\&quot;</span><span class="Constant">http://www.postgresql.org/2009/explain</span><span class="Special">\&quot;</span><span class="Constant">&gt;</span><span class="Special">\n</span><span class="Constant">&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* top-level structure is an array of plans */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">'['</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(<span class="Constant">0</span>, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent++;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L513" title="nodes/list.c:513">lcons_int</a>(<span class="Constant">0</span>, es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Emit the end-of-output boilerplate.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L5147">&#x200c;</a></span><span class="linkable">ExplainEndOutput</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;&lt;/explain&gt;&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;indent--;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot;</span><span class="Special">\n</span><span class="Constant">]&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; es-&gt;grouping_stack = <a href="../nodes/list.c.html#L943" title="nodes/list.c:943">list_delete_first</a>(es-&gt;grouping_stack);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Put an appropriate separator between multiple plans<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">void<br/></li>
<li><a id="L5176">&#x200c;</a></span><span class="linkable">ExplainSeparatePlans</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (es-&gt;format)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* add a blank line */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_XML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_JSON:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_FORMAT_YAML:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* nothing to do */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Emit opening or closing XML tag.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * &quot;flags&quot; must contain <a href="#L60" title="commands/explain.c:60">X_OPENING</a>, <a href="#L61" title="commands/explain.c:61">X_CLOSING</a>, or <a href="#L62" title="commands/explain.c:62">X_CLOSE_IMMEDIATE</a>.<br/></li>
<li></span><span class="Comment"> * Optionally, OR in <a href="#L63" title="commands/explain.c:63">X_NOWHITESPACE</a> to suppress the whitespace we'd normally<br/></li>
<li></span><span class="Comment"> * add.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * XML restricts tag names more than our other output formats, eg they can't<br/></li>
<li></span><span class="Comment"> * contain white space or slashes.&nbsp; Replace invalid characters with dashes,<br/></li>
<li></span><span class="Comment"> * so that for example &quot;I/O Read Time&quot; becomes &quot;I-O-Read-Time&quot;.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5205">&#x200c;</a></span><span class="linkable">ExplainXMLTag</span>(<span class="Type">const</span> <span class="Type">char</span> *tagname, <span class="Type">int</span> flags, ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *s;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">const</span> <span class="Type">char</span> *valid = <span class="Constant">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-<a href="../utils/error/elog.c.html#L89" title="utils/error/elog.c:89">_</a>.&quot;</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> ((flags &amp; <a href="#L63" title="commands/explain.c:63">X_NOWHITESPACE</a>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, <span class="Constant">2</span> * es-&gt;indent);<br/></li>
<li>&nbsp; &nbsp; appendStringInfoCharMacro(es-&gt;str, <span class="Constant">'&lt;'</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> ((flags &amp; <a href="#L61" title="commands/explain.c:61">X_CLOSING</a>) != <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoCharMacro(es-&gt;str, <span class="Constant">'/'</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (s = tagname; *s; s++)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, strchr(valid, *s) ? *s : <span class="Constant">'-'</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> ((flags &amp; <a href="#L62" title="commands/explain.c:62">X_CLOSE_IMMEDIATE</a>) != <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoString(es-&gt;str, <span class="Constant">&quot; /&quot;</span>);<br/></li>
<li>&nbsp; &nbsp; appendStringInfoCharMacro(es-&gt;str, <span class="Constant">'&gt;'</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> ((flags &amp; <a href="#L63" title="commands/explain.c:63">X_NOWHITESPACE</a>) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoCharMacro(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Indent a text-format line.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * We indent by two spaces per indentation level.&nbsp; However, when emitting<br/></li>
<li></span><span class="Comment"> * data for a parallel worker there might already be data on the current line<br/></li>
<li></span><span class="Comment"> * (cf. <a href="#L4491" title="commands/explain.c:4491">ExplainOpenWorker</a>); in that case, don't indent <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> more.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5232">&#x200c;</a></span><span class="linkable">ExplainIndentText</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Assert(es-&gt;format == EXPLAIN_FORMAT_TEXT);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (es-&gt;str-&gt;len == <span class="Constant">0</span> || es-&gt;str-&gt;data[es-&gt;str-&gt;len - <span class="Constant">1</span>] == <span class="Special">'\n'</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Emit a JSON line ending.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * JSON requires a comma after each property but the last.&nbsp; To facilitate this,<br/></li>
<li></span><span class="Comment"> * in JSON format, the text emitted for each property begins just prior to the<br/></li>
<li></span><span class="Comment"> * preceding line-break (and comma, if applicable).<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5247">&#x200c;</a></span><span class="linkable">ExplainJSONLineEnding</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Assert(es-&gt;format == EXPLAIN_FORMAT_JSON);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (linitial_int(es-&gt;grouping_stack) != <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Constant">','</span>);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; linitial_int(es-&gt;grouping_stack) = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Indent a YAML line.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * YAML lines are ordinarily indented by two spaces per indentation level.<br/></li>
<li></span><span class="Comment"> * The text emitted for each property begins just prior to the preceding<br/></li>
<li></span><span class="Comment"> * line-break, except for the first property in an unlabeled group, for which<br/></li>
<li></span><span class="Comment"> * it begins immediately after the &quot;- &quot; that introduces the group.&nbsp; The first<br/></li>
<li></span><span class="Comment"> * property of the group appears on the same line as the opening &quot;- &quot;.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5267">&#x200c;</a></span><span class="linkable">ExplainYAMLLineStarting</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; Assert(es-&gt;format == EXPLAIN_FORMAT_YAML);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (linitial_int(es-&gt;grouping_stack) == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; linitial_int(es-&gt;grouping_stack) = <span class="Constant">1</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoChar(es-&gt;str, <span class="Special">'\n'</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; appendStringInfoSpaces(es-&gt;str, es-&gt;indent * <span class="Constant">2</span>);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * YAML is a superset of JSON; unfortunately, the YAML quoting rules are<br/></li>
<li></span><span class="Comment"> * ridiculously complicated -- as documented in sections 5.3 and 7.3.3 of<br/></li>
<li></span><span class="Comment"> * http://yaml.org/spec/1.2/spec.html -- so we chose to just quote everything.<br/></li>
<li></span><span class="Comment"> * Empty strings, strings with leading or trailing whitespace, and strings<br/></li>
<li></span><span class="Comment"> * containing a variety of special characters must certainly be quoted or the<br/></li>
<li></span><span class="Comment"> * output is invalid; and other seemingly harmless strings like &quot;0xa&quot; or<br/></li>
<li></span><span class="Comment"> * &quot;true&quot; must be quoted, lest they be interpreted as a hexadecimal or Boolean<br/></li>
<li></span><span class="Comment"> * constant rather than a string.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5292">&#x200c;</a></span><span class="linkable">escape_yaml</span>(StringInfo buf, <span class="Type">const</span> <span class="Type">char</span> *str)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="../utils/adt/json.c.html#L1549" title="utils/adt/json.c:1549">escape_json</a>(buf, str);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * DestReceiver <a href="../regex/regcomp.c.html#L356" title="regex/regcomp.c:356">functions</a> for SERIALIZE option<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * A DestReceiver for query tuples, that serializes passed rows into RowData<br/></li>
<li></span><span class="Comment"> * messages while measuring the resources expended and total serialized size,<br/></li>
<li></span><span class="Comment"> * while never sending the data to the client.&nbsp; This allows measuring the<br/></li>
<li></span><span class="Comment"> * overhead of deTOASTing and datatype out/sendfuncs, which are not otherwise<br/></li>
<li></span><span class="Comment"> * exercisable without actually hitting the network.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li><a id="L5307">&#x200c;</a></span><span class="Type">typedef</span> <span class="Type">struct</span> <span class="linkable">SerializeDestReceiver</span><br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; DestReceiver pub;<br/></li>
<li>&nbsp; &nbsp; ExplainState *es;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* this EXPLAIN statement's ExplainState */<br/></li>
<li></span>&nbsp; &nbsp; int8&nbsp; &nbsp; &nbsp; &nbsp; format;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* text or binary, like pq wire protocol */<br/></li>
<li></span>&nbsp; &nbsp; TupleDesc&nbsp; &nbsp; attrinfo;&nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* the output tuple desc */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nattrs;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* current number of columns */<br/></li>
<li></span>&nbsp; &nbsp; FmgrInfo&nbsp;&nbsp; *finfos;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* precomputed call info for output fns */<br/></li>
<li></span>&nbsp; &nbsp; MemoryContext tmpcontext;&nbsp; &nbsp; <span class="Comment">/* per-row temporary memory context */<br/></li>
<li></span>&nbsp; &nbsp; StringInfoData buf;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* buffer to hold the constructed message */<br/></li>
<li></span>&nbsp; &nbsp; <a href="#L52" title="commands/explain.c:52">SerializeMetrics</a> metrics;&nbsp; &nbsp; <span class="Comment">/* collected metrics */<br/></li>
<li><a id="L5318">&#x200c;</a></span>} <span class="linkable">SerializeDestReceiver</span>;<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Get the function lookup info that we'll need for output.<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This is a <a href="../regex/regexec.c.html#L702" title="regex/regexec.c:702">subset</a> of what <a href="../access/common/printtup.c.html#L249" title="access/common/printtup.c:249">printtup_prepare_info</a>() does.&nbsp; We don't need to<br/></li>
<li></span><span class="Comment"> * cope with format choices varying across columns, so it's slightly simpler.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5327">&#x200c;</a></span><span class="linkable">serialize_prepare_info</span>(<a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *receiver,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; TupleDesc typeinfo, <span class="Type">int</span> nattrs)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* get rid of <a href="../utils/adt/pseudotypes.c.html#L365" title="utils/adt/pseudotypes.c:365">any</a> old data */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (receiver-&gt;finfos)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(receiver-&gt;finfos);<br/></li>
<li>&nbsp; &nbsp; receiver-&gt;finfos = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; receiver-&gt;attrinfo = typeinfo;<br/></li>
<li>&nbsp; &nbsp; receiver-&gt;nattrs = nattrs;<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (nattrs &lt;= <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; receiver-&gt;finfos = (FmgrInfo *) <a href="../utils/mmgr/mcxt.c.html#L1346" title="utils/mmgr/mcxt.c:1346">palloc0</a>(nattrs * <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(FmgrInfo));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; nattrs; i++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; FmgrInfo&nbsp;&nbsp; *finfo = receiver-&gt;finfos + i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Form_pg_attribute attr = TupleDescAttr(typeinfo, i);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Oid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; typoutput;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Oid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; typsend;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a></span>&nbsp; &nbsp; &nbsp; &nbsp; typisvarlena;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (receiver-&gt;format == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* wire protocol format text */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/cache/lsyscache.c.html#L2907" title="utils/cache/lsyscache.c:2907">getTypeOutputInfo</a>(attr-&gt;atttypid,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;typoutput,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;typisvarlena);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/fmgr/fmgr.c.html#L127" title="utils/fmgr/fmgr.c:127">fmgr_info</a>(typoutput, finfo);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else</span> <span class="Statement">if</span> (receiver-&gt;format == <span class="Constant">1</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* wire protocol format binary */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/cache/lsyscache.c.html#L2973" title="utils/cache/lsyscache.c:2973">getTypeBinaryOutputInfo</a>(attr-&gt;atttypid,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;typsend,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;typisvarlena);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/fmgr/fmgr.c.html#L127" title="utils/fmgr/fmgr.c:127">fmgr_info</a>(typsend, finfo);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ereport(ERROR,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<a href="../utils/error/elog.c.html#L859" title="utils/error/elog.c:859">errcode</a>(ERRCODE_INVALID_PARAMETER_VALUE),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href="../utils/error/elog.c.html#L1072" title="utils/error/elog.c:1072">errmsg</a>(<span class="Constant">&quot;unsupported format code: </span><span class="Special">%d</span><span class="Constant">&quot;</span>, receiver-&gt;format)));<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L5380" title="commands/explain.c:5380">serializeAnalyzeReceive</a> - collect tuples for EXPLAIN (SERIALIZE)<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * This should match <a href="../access/common/printtup.c.html#L303" title="access/common/printtup.c:303">printtup</a>() in <a href="../access/common/printtup.c.html#L303" title="access/common/printtup.c:303">printtup</a>.c as closely as possible,<br/></li>
<li></span><span class="Comment"> * except for the addition of measurement code.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type"><a href="../utils/fmgr/dfmgr.c.html#L28" title="utils/fmgr/dfmgr.c:28">bool</a><br/></li>
<li><a id="L5380">&#x200c;</a></span><span class="linkable">serializeAnalyzeReceive</span>(TupleTableSlot *slot, DestReceiver *self)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; TupleDesc&nbsp; &nbsp; typeinfo = slot-&gt;tts_tupleDescriptor;<br/></li>
<li>&nbsp; &nbsp; <a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *myState = (<a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *) self;<br/></li>
<li>&nbsp; &nbsp; MemoryContext oldcontext;<br/></li>
<li>&nbsp; &nbsp; StringInfo&nbsp; &nbsp; buf = &amp;myState-&gt;buf;<br/></li>
<li>&nbsp; &nbsp; <span class="Type">int</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; natts = typeinfo-&gt;natts;<br/></li>
<li>&nbsp; &nbsp; instr_time&nbsp; &nbsp; start,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end;<br/></li>
<li>&nbsp; &nbsp; BufferUsage instr_start;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* only measure time, buffers if requested */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (myState-&gt;es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; INSTR_TIME_SET_CURRENT(start);<br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (myState-&gt;es-&gt;buffers)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; instr_start = <a href="../executor/instrument.c.html#L20" title="executor/instrument.c:20">pgBufferUsage</a>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Set or update my derived attribute info, if needed */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (myState-&gt;attrinfo != typeinfo || myState-&gt;nattrs != natts)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L5327" title="commands/explain.c:5327">serialize_prepare_info</a>(myState, typeinfo, natts);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Make sure the tuple is fully deconstructed */<br/></li>
<li></span>&nbsp; &nbsp; slot_getallattrs(slot);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Switch into per-row context so we can recover memory below */<br/></li>
<li></span>&nbsp; &nbsp; oldcontext = MemoryContextSwitchTo(myState-&gt;tmpcontext);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Prepare a DataRow message (note buffer is in per-query context)<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; *<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * Note that we fill a StringInfo buffer the same as <a href="../access/common/printtup.c.html#L303" title="access/common/printtup.c:303">printtup</a>() does, so<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * as to capture the costs of manipulating the strings accurately.<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <a href="../libpq/pqformat.c.html#L109" title="libpq/pqformat.c:109">pq_beginmessage_reuse</a>(buf, <span class="Constant">'D'</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; pq_sendint16(buf, natts);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * <a href="../port/win32/socket.c.html#L38" title="port/win32/socket.c:38">send</a> the attributes of this tuple<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">for</span> (<span class="Type">int</span> i = <span class="Constant">0</span>; i &lt; natts; i++)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; FmgrInfo&nbsp;&nbsp; *finfo = myState-&gt;finfos + i;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; Datum&nbsp; &nbsp; &nbsp; &nbsp; attr = slot-&gt;tts_values[i];<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (slot-&gt;tts_isnull[i])<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pq_sendint32(buf, -<span class="Constant">1</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">continue</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">if</span> (myState-&gt;format == <span class="Constant">0</span>)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Text output */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Type">char</span>&nbsp; &nbsp; &nbsp;&nbsp; *outputstr;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outputstr = <a href="../utils/fmgr/fmgr.c.html#L1683" title="utils/fmgr/fmgr.c:1683">OutputFunctionCall</a>(finfo, attr);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../libpq/pqformat.c.html#L142" title="libpq/pqformat.c:142">pq_sendcountedtext</a>(buf, outputstr, strlen(outputstr));<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">else<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Comment">/* Binary output */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bytea&nbsp; &nbsp; &nbsp;&nbsp; *outputbytes;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outputbytes = <a href="../utils/fmgr/fmgr.c.html#L1744" title="utils/fmgr/fmgr.c:1744">SendFunctionCall</a>(finfo, attr);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pq_sendint32(buf, VARSIZE(outputbytes) - VARHDRSZ);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../libpq/pqformat.c.html#L126" title="libpq/pqformat.c:126">pq_sendbytes</a>(buf, VARDATA(outputbytes),<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; VARSIZE(outputbytes) - VARHDRSZ);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; }<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/*<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * We mustn't call <a href="../libpq/pqformat.c.html#L314" title="libpq/pqformat.c:314">pq_endmessage_reuse</a>(), since that would actually <a href="../port/win32/socket.c.html#L38" title="port/win32/socket.c:38">send</a><br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * the data to the client.&nbsp; Just count the data, instead.&nbsp; We can leave<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * the buffer alone; it'll be reset on the <a href="../regex/regc_lex.c.html#L200" title="regex/regc_lex.c:200">next</a> iteration (as would also<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; * happen in <a href="../access/common/printtup.c.html#L303" title="access/common/printtup.c:303">printtup</a>()).<br/></li>
<li></span><span class="Comment">&nbsp; &nbsp;&nbsp; */<br/></li>
<li></span>&nbsp; &nbsp; myState-&gt;metrics.bytesSent += buf-&gt;len;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Return to caller's context, and flush row's temporary memory */<br/></li>
<li></span>&nbsp; &nbsp; MemoryContextSwitchTo(oldcontext);<br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L383" title="utils/mmgr/mcxt.c:383">MemoryContextReset</a>(myState-&gt;tmpcontext);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Update timing data */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (myState-&gt;es-&gt;timing)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; INSTR_TIME_SET_CURRENT(end);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; INSTR_TIME_ACCUM_DIFF(myState-&gt;metrics.timeSpent, end, start);<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Update buffer metrics */<br/></li>
<li></span>&nbsp; &nbsp; <span class="Statement">if</span> (myState-&gt;es-&gt;buffers)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../executor/instrument.c.html#L248" title="executor/instrument.c:248">BufferUsageAccumDiff</a>(&amp;myState-&gt;metrics.bufferUsage,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &amp;<a href="../executor/instrument.c.html#L20" title="executor/instrument.c:20">pgBufferUsage</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &amp;instr_start);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> <span class="Constant">true</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L5483" title="commands/explain.c:5483">serializeAnalyzeStartup</a> - start up the serializeAnalyze receiver<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5483">&#x200c;</a></span><span class="linkable">serializeAnalyzeStartup</span>(DestReceiver *self, <span class="Type">int</span> operation, TupleDesc typeinfo)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *receiver = (<a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *) self;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; Assert(receiver-&gt;es != <span class="Constant">NULL</span>);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">switch</span> (receiver-&gt;es-&gt;serialize)<br/></li>
<li>&nbsp; &nbsp; {<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_SERIALIZE_NONE:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Assert(<span class="Constant">false</span>);<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_SERIALIZE_TEXT:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; receiver-&gt;format = <span class="Constant">0</span>;&nbsp; &nbsp; <span class="Comment">/* wire protocol format text */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">case</span> EXPLAIN_SERIALIZE_BINARY:<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; receiver-&gt;format = <span class="Constant">1</span>;&nbsp; &nbsp; <span class="Comment">/* wire protocol format binary */<br/></li>
<li></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">break</span>;<br/></li>
<li>&nbsp; &nbsp; }<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Create per-row temporary memory context */<br/></li>
<li></span>&nbsp; &nbsp; receiver-&gt;tmpcontext = AllocSetContextCreate(<a href="../utils/mmgr/mcxt.c.html#L143" title="utils/mmgr/mcxt.c:143">CurrentMemoryContext</a>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="Constant">&quot;SerializeTupleReceive&quot;</span>,<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ALLOCSET_DEFAULT_SIZES);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* The output buffer is re-used across rows, as in <a href="../access/common/printtup.c.html#L303" title="access/common/printtup.c:303">printtup</a>.c */<br/></li>
<li></span>&nbsp; &nbsp; initStringInfo(&amp;receiver-&gt;buf);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Comment">/* Initialize results counters */<br/></li>
<li></span>&nbsp; &nbsp; memset(&amp;receiver-&gt;metrics, <span class="Constant">0</span>, <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(<a href="#L52" title="commands/explain.c:52">SerializeMetrics</a>));<br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_SET_ZERO(receiver-&gt;metrics.timeSpent);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L5519" title="commands/explain.c:5519">serializeAnalyzeShutdown</a> - shut down the serializeAnalyze receiver<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5519">&#x200c;</a></span><span class="linkable">serializeAnalyzeShutdown</span>(DestReceiver *self)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *receiver = (<a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *) self;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (receiver-&gt;finfos)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(receiver-&gt;finfos);<br/></li>
<li>&nbsp; &nbsp; receiver-&gt;finfos = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (receiver-&gt;buf.data)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(receiver-&gt;buf.data);<br/></li>
<li>&nbsp; &nbsp; receiver-&gt;buf.data = <span class="Constant">NULL</span>;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (receiver-&gt;tmpcontext)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L454" title="utils/mmgr/mcxt.c:454">MemoryContextDelete</a>(receiver-&gt;tmpcontext);<br/></li>
<li>&nbsp; &nbsp; receiver-&gt;tmpcontext = <span class="Constant">NULL</span>;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L5540" title="commands/explain.c:5540">serializeAnalyzeDestroy</a> - destroy the serializeAnalyze receiver<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <span class="Type">void<br/></li>
<li><a id="L5540">&#x200c;</a></span><span class="linkable">serializeAnalyzeDestroy</span>(DestReceiver *self)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="../utils/mmgr/mcxt.c.html#L1520" title="utils/mmgr/mcxt.c:1520">pfree</a>(self);<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * Build a DestReceiver for EXPLAIN (SERIALIZE) instrumentation.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span>DestReceiver *<br/></li>
<li><a id="L5549">&#x200c;</a><span class="linkable">CreateExplainSerializeDestReceiver</span>(ExplainState *es)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *self;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; self = (<a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *) <a href="../utils/mmgr/mcxt.c.html#L1346" title="utils/mmgr/mcxt.c:1346">palloc0</a>(<span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(<a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a>));<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; self-&gt;pub.receiveSlot = <a href="#L5380" title="commands/explain.c:5380">serializeAnalyzeReceive</a>;<br/></li>
<li>&nbsp; &nbsp; self-&gt;pub.rStartup = <a href="#L5483" title="commands/explain.c:5483">serializeAnalyzeStartup</a>;<br/></li>
<li>&nbsp; &nbsp; self-&gt;pub.rShutdown = <a href="#L5519" title="commands/explain.c:5519">serializeAnalyzeShutdown</a>;<br/></li>
<li>&nbsp; &nbsp; self-&gt;pub.rDestroy = <a href="#L5540" title="commands/explain.c:5540">serializeAnalyzeDestroy</a>;<br/></li>
<li>&nbsp; &nbsp; self-&gt;pub.mydest = DestExplainSerialize;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; self-&gt;es = es;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> (DestReceiver *) self;<br/></li>
<li>}<br/></li>
<li><br/></li>
<li><span class="Comment">/*<br/></li>
<li></span><span class="Comment"> * <a href="#L5574" title="commands/explain.c:5574">GetSerializationMetrics</a> - collect metrics<br/></li>
<li></span><span class="Comment"> *<br/></li>
<li></span><span class="Comment"> * We have to be careful here since the receiver could be an IntoRel<br/></li>
<li></span><span class="Comment"> * receiver if the subject statement is CREATE TABLE AS.&nbsp; In that<br/></li>
<li></span><span class="Comment"> * case, return all-zeroes stats.<br/></li>
<li></span><span class="Comment"> */<br/></li>
<li></span><span class="Type">static</span> <a href="#L52" title="commands/explain.c:52">SerializeMetrics</a><br/></li>
<li><a id="L5574">&#x200c;</a><span class="linkable">GetSerializationMetrics</span>(DestReceiver *dest)<br/></li>
<li>{<br/></li>
<li>&nbsp; &nbsp; <a href="#L52" title="commands/explain.c:52">SerializeMetrics</a> empty;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">if</span> (dest-&gt;mydest == DestExplainSerialize)<br/></li>
<li>&nbsp; &nbsp; &nbsp; &nbsp; <span class="Statement">return</span> ((<a href="#L5307" title="commands/explain.c:5307">SerializeDestReceiver</a> *) dest)-&gt;metrics;<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; memset(&amp;empty, <span class="Constant">0</span>, <span class="Statement"><a href="../storage/page/itemptr.c.html#L23" title="storage/page/itemptr.c:23">sizeof</a></span>(<a href="#L52" title="commands/explain.c:52">SerializeMetrics</a>));<br/></li>
<li>&nbsp; &nbsp; INSTR_TIME_SET_ZERO(empty.timeSpent);<br/></li>
<li><br/></li>
<li>&nbsp; &nbsp; <span class="Statement">return</span> empty;<br/></li>
<li>}<br/></li>
</ol></code>
 <p class="nav-bar">
  <span class="nav-link"><a href="./index.html">One Level Up</a></span>
  <span class="nav-link"><a href="../index.html">Top Level</a></span>
 </p>

 </body>
</html>
